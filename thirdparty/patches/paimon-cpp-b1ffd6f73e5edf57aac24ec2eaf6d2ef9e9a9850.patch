diff --git a/.gitignore b/.gitignore
index bbf839e..adda78d 100644
--- a/.gitignore
+++ b/.gitignore
@@ -16,6 +16,7 @@
 build
 build-release
 build-debug
+build-asan
 
 # IDE settings
 .idea
diff --git a/CMakeLists.txt b/CMakeLists.txt
index f942510..ef5b68c 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -44,11 +44,20 @@ set(CMAKE_EXPORT_COMPILE_COMMANDS ON)
 
 option(PAIMON_BUILD_STATIC "Build static library" ON)
 option(PAIMON_BUILD_SHARED "Build shared library" ON)
+option(PAIMON_USE_BSYMBOLIC "Link shared libraries with -Bsymbolic" OFF)
+option(PAIMON_LINK_SHARED_STDLIB "Link shared libraries with shared libstdc++/libgcc" ON)
 option(PAIMON_BUILD_TESTS "Build tests" OFF)
 option(PAIMON_USE_ASAN "Use Address Sanitizer" OFF)
 option(PAIMON_USE_UBSAN "Use Undefined Behavior Sanitizer" OFF)
 option(PAIMON_ENABLE_AVRO "Whether to enable avro file format" ON)
 option(PAIMON_ENABLE_ORC "Whether to enable orc file format" ON)
+option(PAIMON_USE_EXTERNAL_ORC "Use external ORC target (orc::orc) instead of bundled ORC" OFF)
+option(PAIMON_ORC_V1 "Build with ORC 1.x compatibility" OFF)
+option(PAIMON_USE_EXTERNAL_GLOG "Use external glog library instead of bundled glog" OFF)
+set(GLOG_INCLUDE_DIR "" CACHE PATH "External glog include directory")
+set(GLOG_STATIC_LIB "" CACHE FILEPATH "External glog static library")
+set(GFLAGS_INCLUDE_DIR "" CACHE PATH "External gflags include directory")
+set(GFLAGS_STATIC_LIB "" CACHE FILEPATH "External gflags static library")
 option(PAIMON_ENABLE_LANCE "Whether to enable lance file format" OFF)
 option(PAIMON_ENABLE_JINDO "Whether to enable jindo file system" OFF)
 option(PAIMON_ENABLE_LUMINA "Whether to enable lumina vector index" ON)
@@ -56,6 +65,9 @@ option(PAIMON_ENABLE_LUMINA "Whether to enable lumina vector index" ON)
 if(PAIMON_ENABLE_ORC)
     add_definitions(-DPAIMON_ENABLE_ORC)
 endif()
+if(PAIMON_ORC_V1)
+    add_definitions(-DPAIMON_ORC_V1)
+endif()
 if(PAIMON_ENABLE_AVRO)
     add_definitions(-DPAIMON_ENABLE_AVRO)
 endif()
@@ -79,7 +91,7 @@ set(CLANG_TIDY_BIN "clang-tidy")
 set(PAIMON_SOURCE_DIR ${PROJECT_SOURCE_DIR})
 set(PAIMON_BINARY_DIR ${PROJECT_BINARY_DIR})
 set(CMAKE_MODULE_PATH ${CMAKE_MODULE_PATH} "${CMAKE_CURRENT_SOURCE_DIR}/cmake_modules")
-set(BUILD_SUPPORT_DIR "${CMAKE_SOURCE_DIR}/build_support")
+set(BUILD_SUPPORT_DIR "${PAIMON_SOURCE_DIR}/build_support")
 set(PAIMON_CMAKE_INSTALL_DIR "${CMAKE_INSTALL_LIBDIR}/cmake/${PROJECT_NAME}")
 
 include(GNUInstallDirs)
@@ -101,8 +113,8 @@ endif()
 
 set(LINT_EXCLUSIONS_FILE ${BUILD_SUPPORT_DIR}/lint_exclusions.txt)
 
-set(LINT_SOURCE_DIRS ${CMAKE_SOURCE_DIR}/include ${CMAKE_SOURCE_DIR}/src
-                     ${CMAKE_SOURCE_DIR}/test ${CMAKE_SOURCE_DIR}/examples)
+set(LINT_SOURCE_DIRS ${PAIMON_SOURCE_DIR}/include ${PAIMON_SOURCE_DIR}/src
+                     ${PAIMON_SOURCE_DIR}/test ${PAIMON_SOURCE_DIR}/examples)
 
 set(CLANG_TIDY_OPTIONS
     ${PAIMON_LINT_QUIET}
@@ -121,7 +133,7 @@ if(PAIMON_LINT_GIT_DIFF_MODE)
                       COMMAND git diff-index --name-only --diff-filter=d --cached
                               ${PAIMON_LINT_GIT_TARGET_COMMIT} > ${GIT_DIFF_FILE_PATH}
                       # convert to absolute path
-                      COMMAND sed -i \"s|^|${CMAKE_SOURCE_DIR}/|\" ${GIT_DIFF_FILE_PATH}
+                      COMMAND sed -i \"s|^|${PAIMON_SOURCE_DIR}/|\" ${GIT_DIFF_FILE_PATH}
                       # filter with ${LINT_SOURCE_DIRS} dirs
                       COMMAND sed -nE -i '\\@${LINT_DIR_REGEX}@p' ${GIT_DIFF_FILE_PATH}
                       COMMENT "Generate git_diff_files.txt for git-diff lint"
@@ -280,15 +292,15 @@ set(CMAKE_CXX_VISIBILITY_PRESET hidden)
 set(CMAKE_C_VISIBILITY_PRESET hidden)
 
 include_directories(${CMAKE_CURRENT_SOURCE_DIR}/include)
-include_directories("${CMAKE_SOURCE_DIR}/third_party/roaring_bitmap")
-include_directories("${CMAKE_SOURCE_DIR}/third_party/xxhash")
+include_directories("${PAIMON_SOURCE_DIR}/third_party/roaring_bitmap")
+include_directories("${PAIMON_SOURCE_DIR}/third_party/xxhash")
 
 if(PAIMON_ENABLE_LANCE)
-    include_directories("${CMAKE_SOURCE_DIR}/third_party/lance")
+    include_directories("${PAIMON_SOURCE_DIR}/third_party/lance")
 endif()
 
 if(PAIMON_ENABLE_LUMINA)
-    include_directories("${CMAKE_SOURCE_DIR}/third_party/lumina/include")
+    include_directories("${PAIMON_SOURCE_DIR}/third_party/lumina/include")
 endif()
 
 include_directories(SYSTEM ${ARROW_INCLUDE_DIR})
@@ -300,9 +312,9 @@ add_compile_definitions("GLOG_USE_GLOG_EXPORT")
 set(THREADS_PREFER_PTHREAD_FLAG ON)
 find_package(Threads REQUIRED)
 set(PAIMON_VERSION_SCRIPT_FLAGS
-    "-Wl,--version-script=${CMAKE_SOURCE_DIR}/src/paimon/symbols.map")
+    "-Wl,--version-script=${PAIMON_SOURCE_DIR}/src/paimon/symbols.map")
 
-set(ENV{PAIMON_TEST_DATA} "${CMAKE_SOURCE_DIR}/test/test_data")
+set(ENV{PAIMON_TEST_DATA} "${PAIMON_SOURCE_DIR}/test/test_data")
 
 if(PAIMON_BUILD_TESTS)
     if(NOT PAIMON_ENABLE_ORC)
@@ -322,7 +334,7 @@ if(PAIMON_BUILD_TESTS)
     add_dependencies(unittest paimon-tests)
 
     include_directories(SYSTEM ${GTEST_INCLUDE_DIR})
-    include_directories("${CMAKE_SOURCE_DIR}/test/")
+    include_directories("${PAIMON_SOURCE_DIR}/test/")
 
     set(TEST_STATIC_LINK_LIBS
         "-Wl,--whole-archive"
diff --git a/cmake_modules/BuildUtils.cmake b/cmake_modules/BuildUtils.cmake
index c63d17f..73db743 100644
--- a/cmake_modules/BuildUtils.cmake
+++ b/cmake_modules/BuildUtils.cmake
@@ -55,7 +55,17 @@ function(add_paimon_lib LIB_NAME)
     # Necessary to make static linking into other shared libraries work properly
     set_property(TARGET ${LIB_NAME}_objlib PROPERTY POSITION_INDEPENDENT_CODE 1)
     if(ARG_DEPENDENCIES)
-        add_dependencies(${LIB_NAME}_objlib ${ARG_DEPENDENCIES})
+        set(_paimon_objlib_deps)
+        foreach(_paimon_dep IN LISTS ARG_DEPENDENCIES)
+            if(TARGET ${_paimon_dep})
+                list(APPEND _paimon_objlib_deps ${_paimon_dep})
+            endif()
+        endforeach()
+        if(_paimon_objlib_deps)
+            add_dependencies(${LIB_NAME}_objlib ${_paimon_objlib_deps})
+        endif()
+        unset(_paimon_objlib_deps)
+        unset(_paimon_dep)
     endif()
     set(LIB_DEPS $<TARGET_OBJECTS:${LIB_NAME}_objlib>)
     set(LIB_INCLUDES)
@@ -106,10 +116,17 @@ function(add_paimon_lib LIB_NAME)
         target_link_options(${LIB_NAME}_shared
                             PRIVATE
                             -Wl,--exclude-libs,ALL
-                            -Wl,-Bsymbolic
                             -Wl,-z,defs
                             -Wl,--gc-sections)
 
+        if(PAIMON_USE_BSYMBOLIC)
+            target_link_options(${LIB_NAME}_shared PRIVATE -Wl,-Bsymbolic)
+        endif()
+
+        if(PAIMON_LINK_SHARED_STDLIB AND NOT APPLE AND CMAKE_CXX_COMPILER_ID MATCHES "GNU|Clang")
+            target_link_options(${LIB_NAME}_shared PRIVATE -shared-libstdc++ -shared-libgcc)
+        endif()
+
         install(TARGETS ${LIB_NAME}_shared ${INSTALL_IS_OPTIONAL}
                 EXPORT ${LIB_NAME}_targets
                 RUNTIME DESTINATION ${RUNTIME_INSTALL_DIR}
diff --git a/cmake_modules/DefineOptions.cmake b/cmake_modules/DefineOptions.cmake
index 0211f40..c4a6b2f 100644
--- a/cmake_modules/DefineOptions.cmake
+++ b/cmake_modules/DefineOptions.cmake
@@ -95,6 +95,11 @@ if("${CMAKE_SOURCE_DIR}" STREQUAL "${CMAKE_CURRENT_SOURCE_DIR}")
     define_option(PAIMON_BUILD_STATIC "Build static libraries" OFF)
 
     define_option(PAIMON_BUILD_SHARED "Build shared libraries" ON)
+
+    define_option(PAIMON_USE_BSYMBOLIC "Link shared libraries with -Bsymbolic" OFF)
+    define_option(PAIMON_LINK_SHARED_STDLIB "Link shared libraries with shared libstdc++/libgcc"
+                  ON)
+    define_option(PAIMON_USE_EXTERNAL_RAPIDJSON "Use external RapidJSON headers" OFF)
     #----------------------------------------------------------------------
     set_option_category("Test")
 
diff --git a/cmake_modules/SetupCxxFlags.cmake b/cmake_modules/SetupCxxFlags.cmake
index e4b2710..2d705ba 100644
--- a/cmake_modules/SetupCxxFlags.cmake
+++ b/cmake_modules/SetupCxxFlags.cmake
@@ -41,6 +41,15 @@ set(CMAKE_CXX_EXTENSIONS OFF)
 # shared libraries
 set(CMAKE_POSITION_INDEPENDENT_CODE ON)
 
+# Use global-dynamic TLS model to avoid relocation issues when linking
+# with other libraries that may use different TLS models (e.g., when
+# rapidjson templates are instantiated in both this library and the
+# consuming application)
+if(NOT MSVC)
+    set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -ftls-model=global-dynamic")
+    set(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} -ftls-model=global-dynamic")
+endif()
+
 string(TOUPPER ${CMAKE_BUILD_TYPE} CMAKE_BUILD_TYPE)
 
 set(UNKNOWN_COMPILER_MESSAGE
diff --git a/cmake_modules/ThirdpartyToolchain.cmake b/cmake_modules/ThirdpartyToolchain.cmake
index 3f07104..dfe2ba3 100644
--- a/cmake_modules/ThirdpartyToolchain.cmake
+++ b/cmake_modules/ThirdpartyToolchain.cmake
@@ -1011,6 +1011,17 @@ endmacro()
 
 build_fmt()
-build_rapidjson()
+if(PAIMON_USE_EXTERNAL_RAPIDJSON)
+    if(NOT RAPIDJSON_INCLUDE_DIR)
+        message(FATAL_ERROR
+                "PAIMON_USE_EXTERNAL_RAPIDJSON=ON but RAPIDJSON_INCLUDE_DIR is not set")
+    endif()
+
+    file(MAKE_DIRECTORY "${RAPIDJSON_INCLUDE_DIR}")
+    add_library(RapidJSON INTERFACE IMPORTED)
+    target_include_directories(RapidJSON SYSTEM INTERFACE "${RAPIDJSON_INCLUDE_DIR}")
+else()
+    build_rapidjson()
+endif()
 build_snappy()
 build_zstd()
 build_zlib()
@@ -1018,14 +1018,56 @@ build_zlib()
 build_lz4()
 build_arrow()
 build_tbb()
-build_glog()
+if(PAIMON_USE_EXTERNAL_GLOG)
+    if(NOT GLOG_INCLUDE_DIR OR NOT GLOG_STATIC_LIB)
+        message(FATAL_ERROR
+                "PAIMON_USE_EXTERNAL_GLOG=ON but GLOG_INCLUDE_DIR or GLOG_STATIC_LIB is not set")
+    endif()
+    add_library(glog STATIC IMPORTED)
+    set(_glog_interface_includes "${GLOG_INCLUDE_DIR}")
+    set(_glog_interface_libs "")
+    if(GFLAGS_STATIC_LIB)
+        list(APPEND _glog_interface_libs "${GFLAGS_STATIC_LIB}")
+        if(GFLAGS_INCLUDE_DIR)
+            list(APPEND _glog_interface_includes "${GFLAGS_INCLUDE_DIR}")
+        endif()
+    endif()
+    set_target_properties(glog
+                          PROPERTIES IMPORTED_LOCATION "${GLOG_STATIC_LIB}"
+                                     INTERFACE_SYSTEM_INCLUDE_DIRECTORIES
+                                     "${_glog_interface_includes}"
+                                     INTERFACE_LINK_LIBRARIES "${_glog_interface_libs}"
+                                     INTERFACE_COMPILE_DEFINITIONS "GLOG_USE_GLOG_EXPORT")
+    unset(_glog_interface_includes)
+    unset(_glog_interface_libs)
+else()
+    build_glog()
+endif()
 
 if(PAIMON_ENABLE_AVRO)
     build_avro()
 endif()
 if(PAIMON_ENABLE_ORC)
-    build_protobuf()
-    build_orc()
+    if(PAIMON_USE_EXTERNAL_ORC)
+        if(TARGET orc::orc)
+            message(STATUS "Using external ORC target: orc::orc")
+        elseif(TARGET orc)
+            add_library(orc::orc ALIAS orc)
+            message(STATUS "Using external ORC target: orc (aliased to orc::orc)")
+        else()
+            message(FATAL_ERROR
+                    "PAIMON_USE_EXTERNAL_ORC=ON but no ORC target found. Define target orc::orc "
+                    "(or orc) before including ThirdpartyToolchain.cmake.")
+        endif()
+
+        get_target_property(_orc_include_dirs orc::orc INTERFACE_INCLUDE_DIRECTORIES)
+        if(_orc_include_dirs AND NOT _orc_include_dirs STREQUAL "NOTFOUND")
+            set(ORC_INCLUDE_DIR "${_orc_include_dirs}")
+        endif()
+    else()
+        build_protobuf()
+        build_orc()
+    endif()
 endif()
 if(PAIMON_ENABLE_JINDO)
     build_jindosdk_c()
diff --git a/cmake_modules/arrow.diff b/cmake_modules/arrow.diff
index 997cb6b..c7b1cf4 100644
--- a/cmake_modules/arrow.diff
+++ b/cmake_modules/arrow.diff
@@ -194,5 +194,22 @@ index 4d3acb491e..3906ff3c59 100644
    int64_t max_row_group_length_;
 +  int64_t max_row_group_size_;
    int64_t pagesize_;
-   ParquetDataPageVersion parquet_data_page_version_;
-   ParquetVersion::type parquet_version_;
+  ParquetDataPageVersion parquet_data_page_version_;
+  ParquetVersion::type parquet_version_;
+
+diff --git a/cpp/cmake_modules/ThirdpartyToolchain.cmake b/cpp/cmake_modules/ThirdpartyToolchain.cmake
+--- a/cpp/cmake_modules/ThirdpartyToolchain.cmake
++++ b/cpp/cmake_modules/ThirdpartyToolchain.cmake
+@@ -1789,8 +1789,11 @@ if(ARROW_WITH_THRIFT)
+                      REQUIRED_VERSION
+                      0.11.0)
+ 
+-  string(REPLACE "." ";" Thrift_VERSION_LIST ${Thrift_VERSION})
++  if(NOT Thrift_VERSION)
++    set(Thrift_VERSION "${ARROW_THRIFT_BUILD_VERSION}")
++  endif()
++  string(REPLACE "." ";" Thrift_VERSION_LIST "${Thrift_VERSION}")
+   list(GET Thrift_VERSION_LIST 0 Thrift_VERSION_MAJOR)
+   list(GET Thrift_VERSION_LIST 1 Thrift_VERSION_MINOR)
+   list(GET Thrift_VERSION_LIST 2 Thrift_VERSION_PATCH)
+ endif()
diff --git a/cmake_modules/san-config.cmake b/cmake_modules/san-config.cmake
index 13399f6..6a8b6db 100644
--- a/cmake_modules/san-config.cmake
+++ b/cmake_modules/san-config.cmake
@@ -17,6 +17,9 @@ if(PAIMON_USE_ASAN)
         target_compile_options(paimon_sanitizer_flags INTERFACE -fsanitize=address
                                                                 -fno-omit-frame-pointer)
         target_link_options(paimon_sanitizer_flags INTERFACE -fsanitize=address)
+        if(PAIMON_LINK_SHARED_STDLIB AND NOT APPLE)
+            target_link_options(paimon_sanitizer_flags INTERFACE -shared-libasan)
+        endif()
         message(STATUS "Address Sanitizer enabled")
     else()
         message(WARNING "Address Sanitizer is only supported for GCC and Clang compilers")
diff --git a/scripts/check_paimon_deps.sh b/scripts/check_paimon_deps.sh
new file mode 100755
index 0000000..4b54e5b
--- /dev/null
+++ b/scripts/check_paimon_deps.sh
@@ -0,0 +1,82 @@
+#!/bin/bash
+# Paimon-cpp 依赖库检查脚本
+
+# 默认 PAIMON_HOME
+PAIMON_HOME="${PAIMON_HOME:-/mnt/disk1/chenjunwei/paimon-install-asan}"
+
+echo "=============================================="
+echo "  Paimon-cpp 依赖库检查工具"
+echo "=============================================="
+echo "PAIMON_HOME: $PAIMON_HOME"
+echo ""
+
+MISSING_COUNT=0
+FOUND_COUNT=0
+
+check_file() {
+    local file_path="$1"
+    local description="$2"
+    
+    if [ -f "$file_path" ]; then
+        echo "[OK] $description"
+        FOUND_COUNT=$((FOUND_COUNT + 1))
+    else
+        echo "[MISSING] $description"
+        echo "         -> $file_path"
+        MISSING_COUNT=$((MISSING_COUNT + 1))
+    fi
+}
+
+echo "=== Paimon 核心库 ==="
+check_file "$PAIMON_HOME/lib64/libpaimon.a" "libpaimon.a"
+check_file "$PAIMON_HOME/lib64/libpaimon_parquet_file_format.a" "libpaimon_parquet_file_format.a"
+check_file "$PAIMON_HOME/lib64/libpaimon_file_index.a" "libpaimon_file_index.a"
+check_file "$PAIMON_HOME/lib64/libpaimon_global_index.a" "libpaimon_global_index.a"
+check_file "$PAIMON_HOME/lib64/libpaimon_local_file_system.a" "libpaimon_local_file_system.a"
+
+echo ""
+echo "=== Paimon 可选模块 ==="
+check_file "$PAIMON_HOME/lib64/libpaimon_orc_file_format.a" "libpaimon_orc_file_format.a (ORC)"
+check_file "$PAIMON_HOME/lib64/libpaimon_avro_file_format.a" "libpaimon_avro_file_format.a (Avro)"
+
+echo ""
+echo "=== paimon_deps 依赖库 ==="
+check_file "$PAIMON_HOME/lib64/paimon_deps/libfmtd.a" "libfmtd.a"
+check_file "$PAIMON_HOME/lib64/paimon_deps/libtbb_debug.a" "libtbb_debug.a"
+check_file "$PAIMON_HOME/lib64/paimon_deps/libroaring_bitmap.a" "libroaring_bitmap.a"
+check_file "$PAIMON_HOME/lib64/paimon_deps/libarrow_dataset.a" "libarrow_dataset.a"
+check_file "$PAIMON_HOME/lib64/paimon_deps/libarrow_acero.a" "libarrow_acero.a"
+check_file "$PAIMON_HOME/lib64/paimon_deps/libarrow.a" "libarrow.a"
+check_file "$PAIMON_HOME/lib64/paimon_deps/libarrow_bundled_dependencies.a" "libarrow_bundled_dependencies.a"
+check_file "$PAIMON_HOME/lib64/paimon_deps/liborc.a" "liborc.a"
+check_file "$PAIMON_HOME/lib64/paimon_deps/libglog.a" "libglog.a (Paimon版)"
+
+echo ""
+echo "=== CMake 配置 ==="
+check_file "$PAIMON_HOME/lib/cmake/Paimon/PaimonConfig.cmake" "PaimonConfig.cmake"
+
+echo ""
+echo "=== 符号检查 ==="
+if [ -f "$PAIMON_HOME/lib64/paimon_deps/libglog.a" ]; then
+    if nm "$PAIMON_HOME/lib64/paimon_deps/libglog.a" 2>/dev/null | grep -q "RawLog__"; then
+        echo "[OK] glog 包含 RawLog__ 符号"
+    else
+        echo "[MISSING] glog 缺少 RawLog__ 符号"
+        MISSING_COUNT=$((MISSING_COUNT + 1))
+    fi
+else
+    echo "[SKIP] glog 库不存在，无法检查符号"
+fi
+
+echo ""
+echo "=============================================="
+echo "结果: 找到 $FOUND_COUNT 个, 缺失 $MISSING_COUNT 个"
+echo "=============================================="
+
+if [ $MISSING_COUNT -gt 0 ]; then
+    echo "警告: 有依赖缺失，请修复后再编译 Doris BE"
+    exit 1
+else
+    echo "所有依赖检查通过!"
+    exit 0
+fi
diff --git a/src/paimon/common/logging/logging.cpp b/src/paimon/common/logging/logging.cpp
index 5892436..ce599f1 100644
--- a/src/paimon/common/logging/logging.cpp
+++ b/src/paimon/common/logging/logging.cpp
@@ -22,8 +22,8 @@
 #include <optional>
 #include <shared_mutex>
 
-#include "glog/log_severity.h"
 #include "glog/logging.h"
+#include "glog/log_severity.h"
 #include "glog/raw_logging.h"
 
 namespace paimon {
diff --git a/src/paimon/common/memory/bytes.cpp b/src/paimon/common/memory/bytes.cpp
index 6b2b6c9..8a5f6d7 100644
--- a/src/paimon/common/memory/bytes.cpp
+++ b/src/paimon/common/memory/bytes.cpp
@@ -59,9 +59,16 @@ Bytes& Bytes::operator=(Bytes&& other) noexcept {
     if (&other == this) {
         return *this;
     }
-    this->~Bytes();
-    std::memcpy(this, &other, sizeof(*this));
-    new (&other) Bytes();
+    if (data_ != nullptr) {
+        assert(pool_);
+        pool_->Free(data_, size_);
+    }
+    pool_ = other.pool_;
+    data_ = other.data_;
+    size_ = other.size_;
+    other.pool_ = nullptr;
+    other.data_ = nullptr;
+    other.size_ = 0;
     return *this;
 }
 
diff --git a/src/paimon/core/schema/schema_manager.cpp b/src/paimon/core/schema/schema_manager.cpp
index 94ed36a..bb33572 100644
--- a/src/paimon/core/schema/schema_manager.cpp
+++ b/src/paimon/core/schema/schema_manager.cpp
@@ -66,17 +66,23 @@ Result<std::optional<std::shared_ptr<TableSchema>>> SchemaManager::Latest() cons
 }
 
 Result<std::shared_ptr<TableSchema>> SchemaManager::ReadSchema(int64_t schema_id) const {
-    auto iter = schema_cache_.find(schema_id);
-    if (iter != schema_cache_.end()) {
-        return iter->second;
+    {
+        std::lock_guard lock(schema_cache_lock_);
+        auto iter = schema_cache_.find(schema_id);
+        if (iter != schema_cache_.end()) {
+            return iter->second;
+        }
     }
     auto path = ToSchemaPath(schema_id);
     std::string content;
     PAIMON_RETURN_NOT_OK(file_system_->ReadFile(path, &content));
     PAIMON_ASSIGN_OR_RAISE(std::shared_ptr<TableSchema> schema,
                            TableSchema::CreateFromJson(content));
-    schema_cache_[schema_id] = schema;
-    return schema;
+    {
+        std::lock_guard lock(schema_cache_lock_);
+        auto [iter, _] = schema_cache_.emplace(schema_id, schema);
+        return iter->second;
+    }
 }
 
 std::string SchemaManager::SchemaDirectory() const {
diff --git a/src/paimon/core/schema/schema_manager.h b/src/paimon/core/schema/schema_manager.h
index c70bc45..2a2a9b2 100644
--- a/src/paimon/core/schema/schema_manager.h
+++ b/src/paimon/core/schema/schema_manager.h
@@ -19,6 +19,7 @@
 #include <cstdint>
 #include <map>
 #include <memory>
+#include <mutex>
 #include <optional>
 #include <string>
 #include <vector>
@@ -67,6 +68,7 @@ class SchemaManager {
     std::string table_root_;
     const std::string branch_;
     mutable std::map<int64_t, std::shared_ptr<TableSchema>> schema_cache_;
+    mutable std::mutex schema_cache_lock_;
 };
 
 }  // namespace paimon
diff --git a/src/paimon/format/orc/CMakeLists.txt b/src/paimon/format/orc/CMakeLists.txt
index 91319a1..69478be 100644
--- a/src/paimon/format/orc/CMakeLists.txt
+++ b/src/paimon/format/orc/CMakeLists.txt
@@ -24,6 +24,22 @@ if(PAIMON_ENABLE_ORC)
         orc_stats_extractor.cpp
         orc_format_writer.cpp)
 
+    set(PAIMON_ORC_DEFLATE_LIBS)
+    if(TARGET deflate)
+        list(APPEND PAIMON_ORC_DEFLATE_LIBS deflate)
+    elseif(TARGET libdeflate)
+        list(APPEND PAIMON_ORC_DEFLATE_LIBS libdeflate)
+    else()
+        find_library(PAIMON_LIBDEFLATE_LIBRARY
+                     NAMES deflate libdeflate
+                     HINTS
+                     "$ENV{DORIS_THIRDPARTY}/installed/lib"
+                     "$ENV{DORIS_THIRDPARTY}/installed/lib64")
+        if(PAIMON_LIBDEFLATE_LIBRARY)
+            list(APPEND PAIMON_ORC_DEFLATE_LIBS ${PAIMON_LIBDEFLATE_LIBRARY})
+        endif()
+    endif()
+
     add_paimon_lib(paimon_orc_file_format
                    SOURCES
                    ${PAIMON_ORC_FILE_FORMAT}
@@ -40,8 +56,10 @@ if(PAIMON_ENABLE_ORC)
                    tbb
                    dl
                    Threads::Threads
+                   ${PAIMON_ORC_DEFLATE_LIBS}
                    SHARED_LINK_LIBS
                    paimon_shared
+                   ${PAIMON_ORC_DEFLATE_LIBS}
                    SHARED_LINK_FLAGS
                    ${PAIMON_VERSION_SCRIPT_FLAGS})
 
diff --git a/src/paimon/format/orc/orc_adapter.cpp b/src/paimon/format/orc/orc_adapter.cpp
index e986c79..20b9015 100644
--- a/src/paimon/format/orc/orc_adapter.cpp
+++ b/src/paimon/format/orc/orc_adapter.cpp
@@ -64,6 +64,41 @@
 namespace paimon::orc {
 namespace {
 template <typename T>
+uint64_t OrcBufferSize(const ::orc::DataBuffer<T>& buffer) {
+#if defined(PAIMON_ORC_V1)
+    return const_cast<::orc::DataBuffer<T>&>(buffer).size();
+#else
+    return buffer.size();
+#endif
+}
+
+template <typename T>
+void OrcBufferSetData(::orc::DataBuffer<T>* buffer, T* data, uint64_t size_bytes) {
+#if defined(PAIMON_ORC_V1)
+    uint64_t length = size_bytes / sizeof(T);
+    buffer->resize(length);
+    std::memcpy(buffer->data(), data, size_bytes);
+#else
+    buffer->setData(data, size_bytes);
+#endif
+}
+
+int64_t OrcInt128HighBits(const ::orc::Int128& value) {
+#if defined(PAIMON_ORC_V1)
+    return const_cast<::orc::Int128&>(value).getHighBits();
+#else
+    return value.getHighBits();
+#endif
+}
+
+uint64_t OrcInt128LowBits(const ::orc::Int128& value) {
+#if defined(PAIMON_ORC_V1)
+    return const_cast<::orc::Int128&>(value).getLowBits();
+#else
+    return value.getLowBits();
+#endif
+}
+template <typename T>
 class OrcBackedArrowBuffer : public arrow::ResizableBuffer {
  public:
     explicit OrcBackedArrowBuffer(::orc::DataBuffer<T>&& buffer)
@@ -473,12 +508,12 @@ class UnPooledStringDictionaryBuilder : public EmptyBuilder {
         const auto& dict_data = orc_dictionary->dictionaryBlob;
         auto offsets =
             std::make_shared<arrow::Buffer>(reinterpret_cast<const uint8_t*>(dict_offset.data()),
-                                            dict_offset.size() * sizeof(int64_t));
+                                            OrcBufferSize(dict_offset) * sizeof(int64_t));
         auto data = std::make_shared<arrow::Buffer>(
-            reinterpret_cast<const uint8_t*>(dict_data.data()), dict_data.size());
+            reinterpret_cast<const uint8_t*>(dict_data.data()), OrcBufferSize(dict_data));
         dict_builder->SetData(data);
         dict_builder->SetOffsets(offsets);
-        dict_builder->IncreaseLength(dict_offset.size() - 1);
+        dict_builder->IncreaseLength(OrcBufferSize(dict_offset) - 1);
         std::shared_ptr<arrow::Array> dictionary;
         ARROW_RETURN_NOT_OK(dict_builder->Finish(&dictionary));
         dictionary_.reset(new OrcStringDictionary(dictionary->data(), orc_dictionary));
@@ -700,8 +735,8 @@ Result<std::shared_ptr<arrow::ArrayBuilder>> MakeOrcBackedDecimal128Builder(
             arrow::internal::checked_cast<const ::orc::Decimal128VectorBatch*>(column_vector_batch);
         for (size_t i = 0; i < typed_batch->numElements; i++) {
             if (!has_nulls || typed_batch->notNull[i]) {
-                int64_t high_bits = typed_batch->values[i].getHighBits();
-                uint64_t low_bits = typed_batch->values[i].getLowBits();
+                int64_t high_bits = OrcInt128HighBits(typed_batch->values[i]);
+                uint64_t low_bits = OrcInt128LowBits(typed_batch->values[i]);
                 PAIMON_RETURN_NOT_OK_FROM_ARROW(
                     builder->Append(arrow::Decimal128(high_bits, low_bits)));
             } else {
@@ -1150,7 +1185,7 @@ arrow::Status ShallowCopyGenericBatch(const arrow::Array& array,
         batch->notNull[i] = array_.IsValid(i) ? static_cast<char>(1) : static_cast<char>(0);
     }
     auto* raw_values = const_cast<value_type*>(array_.raw_values());
-    batch->data.setData(raw_values, sizeof(value_type) * length);
+    OrcBufferSetData(&batch->data, raw_values, sizeof(value_type) * length);
     batch->numElements = length;
     return arrow::Status::OK();
 }
diff --git a/src/paimon/format/orc/orc_input_stream_impl.cpp b/src/paimon/format/orc/orc_input_stream_impl.cpp
index 72cb83a..65060de 100644
--- a/src/paimon/format/orc/orc_input_stream_impl.cpp
+++ b/src/paimon/format/orc/orc_input_stream_impl.cpp
@@ -71,10 +71,12 @@ void OrcInputStreamImpl::read(void* buf, uint64_t length, uint64_t offset) {
     }
 }
 
+#if !defined(PAIMON_ORC_V1)
 std::future<void> OrcInputStreamImpl::readAsync(void* buf, uint64_t length, uint64_t offset) {
     // TODO(liancheng.lsz)
     throw ::orc::NotImplementedYet("do not support read async for now");
 }
+#endif
 
 const std::string& OrcInputStreamImpl::getName() const {
     return uri_name_;
diff --git a/src/paimon/format/orc/orc_input_stream_impl.h b/src/paimon/format/orc/orc_input_stream_impl.h
index e32e861..e16d962 100644
--- a/src/paimon/format/orc/orc_input_stream_impl.h
+++ b/src/paimon/format/orc/orc_input_stream_impl.h
@@ -50,7 +50,9 @@ class OrcInputStreamImpl : public ::orc::InputStream {
     uint64_t getLength() const override;
     uint64_t getNaturalReadSize() const override;
     void read(void* buf, uint64_t length, uint64_t offset) override;
+#if !defined(PAIMON_ORC_V1)
     std::future<void> readAsync(void* buf, uint64_t length, uint64_t offset) override;
+#endif
     const std::string& getName() const override;
 
  private:
