diff --git a/CMakeLists.txt b/CMakeLists.txt
index f942510..ef5b68c 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -48,7 +48,14 @@ set(CMAKE_EXPORT_COMPILE_COMMANDS ON)
 option(PAIMON_USE_ASAN "Use Address Sanitizer" OFF)
 option(PAIMON_USE_UBSAN "Use Undefined Behavior Sanitizer" OFF)
 option(PAIMON_ENABLE_AVRO "Whether to enable avro file format" ON)
-option(PAIMON_ENABLE_ORC "Whether to enable orc file format" ON)
+option(PAIMON_ENABLE_ORC "Whether to enable orc file format" ON)
+option(PAIMON_USE_EXTERNAL_ORC "Use external ORC target (orc::orc) instead of bundled ORC" OFF)
+option(PAIMON_ORC_V1 "Build with ORC 1.x compatibility" OFF)
+option(PAIMON_USE_EXTERNAL_GLOG "Use external glog library instead of bundled glog" OFF)
+set(GLOG_INCLUDE_DIR "" CACHE PATH "External glog include directory")
+set(GLOG_STATIC_LIB "" CACHE FILEPATH "External glog static library")
+set(GFLAGS_INCLUDE_DIR "" CACHE PATH "External gflags include directory")
+set(GFLAGS_STATIC_LIB "" CACHE FILEPATH "External gflags static library")
 option(PAIMON_ENABLE_LANCE "Whether to enable lance file format" OFF)
 option(PAIMON_ENABLE_JINDO "Whether to enable jindo file system" OFF)
 option(PAIMON_ENABLE_LUMINA "Whether to enable lumina vector index" ON)
@@ -56,6 +65,9 @@ option(PAIMON_ENABLE_LUMINA "Whether to enable lumina vector index" ON)
 if(PAIMON_ENABLE_ORC)
     add_definitions(-DPAIMON_ENABLE_ORC)
 endif()
+if(PAIMON_ORC_V1)
+    add_definitions(-DPAIMON_ORC_V1)
+endif()
 if(PAIMON_ENABLE_AVRO)
     add_definitions(-DPAIMON_ENABLE_AVRO)
 endif()
diff --git a/cmake_modules/BuildUtils.cmake b/cmake_modules/BuildUtils.cmake
index c63d17f..73db743 100644
--- a/cmake_modules/BuildUtils.cmake
+++ b/cmake_modules/BuildUtils.cmake
@@ -55,7 +55,18 @@ function(add_paimon_lib LIB_NAME)
     # Necessary to make static linking into other shared libraries work properly
     set_property(TARGET ${LIB_NAME}_objlib PROPERTY POSITION_INDEPENDENT_CODE 1)
     if(ARG_DEPENDENCIES)
-        add_dependencies(${LIB_NAME}_objlib ${ARG_DEPENDENCIES})
+        # Avoid add_dependencies on non-existent targets (e.g. when building static only).
+        set(_paimon_objlib_deps)
+        foreach(_paimon_dep IN LISTS ARG_DEPENDENCIES)
+            if(TARGET ${_paimon_dep})
+                list(APPEND _paimon_objlib_deps ${_paimon_dep})
+            endif()
+        endforeach()
+        if(_paimon_objlib_deps)
+            add_dependencies(${LIB_NAME}_objlib ${_paimon_objlib_deps})
+        endif()
+        unset(_paimon_objlib_deps)
+        unset(_paimon_dep)
     endif()
     set(LIB_DEPS $<TARGET_OBJECTS:${LIB_NAME}_objlib>)
     set(LIB_INCLUDES)
diff --git a/cmake_modules/DefineOptions.cmake b/cmake_modules/DefineOptions.cmake
index 0211f40..c4a6b2f 100644
--- a/cmake_modules/DefineOptions.cmake
+++ b/cmake_modules/DefineOptions.cmake
@@ -95,6 +95,7 @@ if("${CMAKE_SOURCE_DIR}" STREQUAL "${CMAKE_CURRENT_SOURCE_DIR}")
     define_option(PAIMON_BUILD_STATIC "Build static libraries" OFF)
 
     define_option(PAIMON_BUILD_SHARED "Build shared libraries" ON)
+    define_option(PAIMON_USE_EXTERNAL_RAPIDJSON "Use external RapidJSON headers" OFF)
     #----------------------------------------------------------------------
     set_option_category("Test")
 
diff --git a/cmake_modules/SetupCxxFlags.cmake b/cmake_modules/SetupCxxFlags.cmake
index e4b2710..2d705ba 100644
--- a/cmake_modules/SetupCxxFlags.cmake
+++ b/cmake_modules/SetupCxxFlags.cmake
@@ -41,6 +41,15 @@ set(CMAKE_CXX_EXTENSIONS OFF)
 # shared libraries
 set(CMAKE_POSITION_INDEPENDENT_CODE ON)
 
+# Use global-dynamic TLS model to avoid relocation issues when linking
+# with other libraries that may use different TLS models (e.g., when
+# rapidjson templates are instantiated in both this library and the
+# consuming application)
+if(NOT MSVC)
+    set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -ftls-model=global-dynamic")
+    set(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} -ftls-model=global-dynamic")
+endif()
+
 string(TOUPPER ${CMAKE_BUILD_TYPE} CMAKE_BUILD_TYPE)
 
 set(UNKNOWN_COMPILER_MESSAGE
diff --git a/cmake_modules/ThirdpartyToolchain.cmake b/cmake_modules/ThirdpartyToolchain.cmake
index 3f07104..dfe2ba3 100644
--- a/cmake_modules/ThirdpartyToolchain.cmake
+++ b/cmake_modules/ThirdpartyToolchain.cmake
@@ -1011,6 +1011,17 @@ endmacro()
 
 build_fmt()
-build_rapidjson()
+if(PAIMON_USE_EXTERNAL_RAPIDJSON)
+    if(NOT RAPIDJSON_INCLUDE_DIR)
+        message(FATAL_ERROR
+                "PAIMON_USE_EXTERNAL_RAPIDJSON=ON but RAPIDJSON_INCLUDE_DIR is not set")
+    endif()
+
+    file(MAKE_DIRECTORY "${RAPIDJSON_INCLUDE_DIR}")
+    add_library(RapidJSON INTERFACE IMPORTED)
+    target_include_directories(RapidJSON SYSTEM INTERFACE "${RAPIDJSON_INCLUDE_DIR}")
+else()
+    build_rapidjson()
+endif()
 build_snappy()
 build_zstd()
 build_zlib()
@@ -1018,14 +1018,56 @@ build_zlib()
 build_lz4()
 build_arrow()
 build_tbb()
-build_glog()
+if(PAIMON_USE_EXTERNAL_GLOG)
+    if(NOT GLOG_INCLUDE_DIR OR NOT GLOG_STATIC_LIB)
+        message(FATAL_ERROR
+                "PAIMON_USE_EXTERNAL_GLOG=ON but GLOG_INCLUDE_DIR or GLOG_STATIC_LIB is not set")
+    endif()
+    add_library(glog STATIC IMPORTED)
+    set(_glog_interface_includes "${GLOG_INCLUDE_DIR}")
+    set(_glog_interface_libs "")
+    if(GFLAGS_STATIC_LIB)
+        list(APPEND _glog_interface_libs "${GFLAGS_STATIC_LIB}")
+        if(GFLAGS_INCLUDE_DIR)
+            list(APPEND _glog_interface_includes "${GFLAGS_INCLUDE_DIR}")
+        endif()
+    endif()
+    set_target_properties(glog
+                          PROPERTIES IMPORTED_LOCATION "${GLOG_STATIC_LIB}"
+                                     INTERFACE_SYSTEM_INCLUDE_DIRECTORIES
+                                     "${_glog_interface_includes}"
+                                     INTERFACE_LINK_LIBRARIES "${_glog_interface_libs}"
+                                     INTERFACE_COMPILE_DEFINITIONS "GLOG_USE_GLOG_EXPORT")
+    unset(_glog_interface_includes)
+    unset(_glog_interface_libs)
+else()
+    build_glog()
+endif()
 
 if(PAIMON_ENABLE_AVRO)
     build_avro()
 endif()
 if(PAIMON_ENABLE_ORC)
-    build_protobuf()
-    build_orc()
+    if(PAIMON_USE_EXTERNAL_ORC)
+        if(TARGET orc::orc)
+            message(STATUS "Using external ORC target: orc::orc")
+        elseif(TARGET orc)
+            add_library(orc::orc ALIAS orc)
+            message(STATUS "Using external ORC target: orc (aliased to orc::orc)")
+        else()
+            message(FATAL_ERROR
+                    "PAIMON_USE_EXTERNAL_ORC=ON but no ORC target found. Define target orc::orc "
+                    "(or orc) before including ThirdpartyToolchain.cmake.")
+        endif()
+
+        get_target_property(_orc_include_dirs orc::orc INTERFACE_INCLUDE_DIRECTORIES)
+        if(_orc_include_dirs AND NOT _orc_include_dirs STREQUAL "NOTFOUND")
+            set(ORC_INCLUDE_DIR "${_orc_include_dirs}")
+        endif()
+    else()
+        build_protobuf()
+        build_orc()
+    endif()
 endif()
 if(PAIMON_ENABLE_JINDO)
     build_jindosdk_c()
diff --git a/cmake_modules/arrow.diff b/cmake_modules/arrow.diff
index 997cb6b..c7b1cf4 100644
--- a/cmake_modules/arrow.diff
+++ b/cmake_modules/arrow.diff
@@ -194,5 +194,22 @@ index 4d3acb491e..3906ff3c59 100644
    int64_t max_row_group_length_;
 +  int64_t max_row_group_size_;
    int64_t pagesize_;
-   ParquetDataPageVersion parquet_data_page_version_;
-   ParquetVersion::type parquet_version_;
+  ParquetDataPageVersion parquet_data_page_version_;
+  ParquetVersion::type parquet_version_;
+
+diff --git a/cpp/cmake_modules/ThirdpartyToolchain.cmake b/cpp/cmake_modules/ThirdpartyToolchain.cmake
+--- a/cpp/cmake_modules/ThirdpartyToolchain.cmake
++++ b/cpp/cmake_modules/ThirdpartyToolchain.cmake
+@@ -1789,8 +1789,11 @@ if(ARROW_WITH_THRIFT)
+                      REQUIRED_VERSION
+                      0.11.0)
+ 
+-  string(REPLACE "." ";" Thrift_VERSION_LIST ${Thrift_VERSION})
++  if(NOT Thrift_VERSION)
++    set(Thrift_VERSION "${ARROW_THRIFT_BUILD_VERSION}")
++  endif()
++  string(REPLACE "." ";" Thrift_VERSION_LIST "${Thrift_VERSION}")
+   list(GET Thrift_VERSION_LIST 0 Thrift_VERSION_MAJOR)
+   list(GET Thrift_VERSION_LIST 1 Thrift_VERSION_MINOR)
+   list(GET Thrift_VERSION_LIST 2 Thrift_VERSION_PATCH)
+ endif()
diff --git a/src/paimon/common/logging/logging.cpp b/src/paimon/common/logging/logging.cpp
index 5892436..ce599f1 100644
--- a/src/paimon/common/logging/logging.cpp
+++ b/src/paimon/common/logging/logging.cpp
@@ -22,8 +22,8 @@
 #include <optional>
 #include <shared_mutex>
 
-#include "glog/log_severity.h"
 #include "glog/logging.h"
+#include "glog/log_severity.h"
 #include "glog/raw_logging.h"
 
 namespace paimon {
diff --git a/src/paimon/common/memory/bytes.cpp b/src/paimon/common/memory/bytes.cpp
index 6b2b6c9..8a5f6d7 100644
--- a/src/paimon/common/memory/bytes.cpp
+++ b/src/paimon/common/memory/bytes.cpp
@@ -59,9 +59,16 @@ Bytes& Bytes::operator=(Bytes&& other) noexcept {
     if (&other == this) {
         return *this;
     }
-    this->~Bytes();
-    std::memcpy(this, &other, sizeof(*this));
-    new (&other) Bytes();
+    if (data_ != nullptr) {
+        assert(pool_);
+        pool_->Free(data_, size_);
+    }
+    pool_ = other.pool_;
+    data_ = other.data_;
+    size_ = other.size_;
+    other.pool_ = nullptr;
+    other.data_ = nullptr;
+    other.size_ = 0;
     return *this;
 }
 
diff --git a/src/paimon/format/orc/CMakeLists.txt b/src/paimon/format/orc/CMakeLists.txt
index 91319a1..69478be 100644
--- a/src/paimon/format/orc/CMakeLists.txt
+++ b/src/paimon/format/orc/CMakeLists.txt
@@ -24,6 +24,22 @@ if(PAIMON_ENABLE_ORC)
         orc_stats_extractor.cpp
         orc_format_writer.cpp)
 
+    set(PAIMON_ORC_DEFLATE_LIBS)
+    if(TARGET deflate)
+        list(APPEND PAIMON_ORC_DEFLATE_LIBS deflate)
+    elseif(TARGET libdeflate)
+        list(APPEND PAIMON_ORC_DEFLATE_LIBS libdeflate)
+    else()
+        find_library(PAIMON_LIBDEFLATE_LIBRARY
+                     NAMES deflate libdeflate
+                     HINTS
+                     "$ENV{DORIS_THIRDPARTY}/installed/lib"
+                     "$ENV{DORIS_THIRDPARTY}/installed/lib64")
+        if(PAIMON_LIBDEFLATE_LIBRARY)
+            list(APPEND PAIMON_ORC_DEFLATE_LIBS ${PAIMON_LIBDEFLATE_LIBRARY})
+        endif()
+    endif()
+
     add_paimon_lib(paimon_orc_file_format
                    SOURCES
                    ${PAIMON_ORC_FILE_FORMAT}
@@ -40,8 +56,10 @@ if(PAIMON_ENABLE_ORC)
                    tbb
                    dl
                    Threads::Threads
+                   ${PAIMON_ORC_DEFLATE_LIBS}
                    SHARED_LINK_LIBS
                    paimon_shared
+                   ${PAIMON_ORC_DEFLATE_LIBS}
                    SHARED_LINK_FLAGS
                    ${PAIMON_VERSION_SCRIPT_FLAGS})
 
diff --git a/src/paimon/format/orc/orc_adapter.cpp b/src/paimon/format/orc/orc_adapter.cpp
index e986c79..20b9015 100644
--- a/src/paimon/format/orc/orc_adapter.cpp
+++ b/src/paimon/format/orc/orc_adapter.cpp
@@ -64,6 +64,41 @@
 namespace paimon::orc {
 namespace {
 template <typename T>
+uint64_t OrcBufferSize(const ::orc::DataBuffer<T>& buffer) {
+#if defined(PAIMON_ORC_V1)
+    return const_cast<::orc::DataBuffer<T>&>(buffer).size();
+#else
+    return buffer.size();
+#endif
+}
+
+template <typename T>
+void OrcBufferSetData(::orc::DataBuffer<T>* buffer, T* data, uint64_t size_bytes) {
+#if defined(PAIMON_ORC_V1)
+    uint64_t length = size_bytes / sizeof(T);
+    buffer->resize(length);
+    std::memcpy(buffer->data(), data, size_bytes);
+#else
+    buffer->setData(data, size_bytes);
+#endif
+}
+
+int64_t OrcInt128HighBits(const ::orc::Int128& value) {
+#if defined(PAIMON_ORC_V1)
+    return const_cast<::orc::Int128&>(value).getHighBits();
+#else
+    return value.getHighBits();
+#endif
+}
+
+uint64_t OrcInt128LowBits(const ::orc::Int128& value) {
+#if defined(PAIMON_ORC_V1)
+    return const_cast<::orc::Int128&>(value).getLowBits();
+#else
+    return value.getLowBits();
+#endif
+}
+template <typename T>
 class OrcBackedArrowBuffer : public arrow::ResizableBuffer {
  public:
     explicit OrcBackedArrowBuffer(::orc::DataBuffer<T>&& buffer)
@@ -473,12 +508,12 @@ class UnPooledStringDictionaryBuilder : public EmptyBuilder {
         const auto& dict_data = orc_dictionary->dictionaryBlob;
         auto offsets =
             std::make_shared<arrow::Buffer>(reinterpret_cast<const uint8_t*>(dict_offset.data()),
-                                            dict_offset.size() * sizeof(int64_t));
+                                            OrcBufferSize(dict_offset) * sizeof(int64_t));
         auto data = std::make_shared<arrow::Buffer>(
-            reinterpret_cast<const uint8_t*>(dict_data.data()), dict_data.size());
+            reinterpret_cast<const uint8_t*>(dict_data.data()), OrcBufferSize(dict_data));
         dict_builder->SetData(data);
         dict_builder->SetOffsets(offsets);
-        dict_builder->IncreaseLength(dict_offset.size() - 1);
+        dict_builder->IncreaseLength(OrcBufferSize(dict_offset) - 1);
         std::shared_ptr<arrow::Array> dictionary;
         ARROW_RETURN_NOT_OK(dict_builder->Finish(&dictionary));
         dictionary_.reset(new OrcStringDictionary(dictionary->data(), orc_dictionary));
@@ -700,8 +735,8 @@ Result<std::shared_ptr<arrow::ArrayBuilder>> MakeOrcBackedDecimal128Builder(
             arrow::internal::checked_cast<const ::orc::Decimal128VectorBatch*>(column_vector_batch);
         for (size_t i = 0; i < typed_batch->numElements; i++) {
             if (!has_nulls || typed_batch->notNull[i]) {
-                int64_t high_bits = typed_batch->values[i].getHighBits();
-                uint64_t low_bits = typed_batch->values[i].getLowBits();
+                int64_t high_bits = OrcInt128HighBits(typed_batch->values[i]);
+                uint64_t low_bits = OrcInt128LowBits(typed_batch->values[i]);
                 PAIMON_RETURN_NOT_OK_FROM_ARROW(
                     builder->Append(arrow::Decimal128(high_bits, low_bits)));
             } else {
@@ -1150,7 +1185,7 @@ arrow::Status ShallowCopyGenericBatch(const arrow::Array& array,
         batch->notNull[i] = array_.IsValid(i) ? static_cast<char>(1) : static_cast<char>(0);
     }
     auto* raw_values = const_cast<value_type*>(array_.raw_values());
-    batch->data.setData(raw_values, sizeof(value_type) * length);
+    OrcBufferSetData(&batch->data, raw_values, sizeof(value_type) * length);
     batch->numElements = length;
     return arrow::Status::OK();
 }
diff --git a/src/paimon/format/orc/orc_input_stream_impl.cpp b/src/paimon/format/orc/orc_input_stream_impl.cpp
index 72cb83a..65060de 100644
--- a/src/paimon/format/orc/orc_input_stream_impl.cpp
+++ b/src/paimon/format/orc/orc_input_stream_impl.cpp
@@ -71,10 +71,12 @@ void OrcInputStreamImpl::read(void* buf, uint64_t length, uint64_t offset) {
     }
 }
 
+#if !defined(PAIMON_ORC_V1)
 std::future<void> OrcInputStreamImpl::readAsync(void* buf, uint64_t length, uint64_t offset) {
     // TODO(liancheng.lsz)
     throw ::orc::NotImplementedYet("do not support read async for now");
 }
+#endif
 
 const std::string& OrcInputStreamImpl::getName() const {
     return uri_name_;
diff --git a/src/paimon/format/orc/orc_input_stream_impl.h b/src/paimon/format/orc/orc_input_stream_impl.h
index e32e861..e16d962 100644
--- a/src/paimon/format/orc/orc_input_stream_impl.h
+++ b/src/paimon/format/orc/orc_input_stream_impl.h
@@ -50,7 +50,9 @@ class OrcInputStreamImpl : public ::orc::InputStream {
     uint64_t getLength() const override;
     uint64_t getNaturalReadSize() const override;
     void read(void* buf, uint64_t length, uint64_t offset) override;
+#if !defined(PAIMON_ORC_V1)
     std::future<void> readAsync(void* buf, uint64_t length, uint64_t offset) override;
+#endif
     const std::string& getName() const override;
 
  private:
