// Licensed to the Apache Software Foundation (ASF) under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The ASF licenses this file
// to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.  You may obtain a copy of the License at
//
//   http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing,
// software distributed under the License is distributed on an
// "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
// KIND, either express or implied.  See the License for the
// specific language governing permissions and limitations
// under the License.

suite("cast_to_datetime") {
    sql "set debug_skip_fold_constant = true"

qt_sql """ select cast("2023-07-16T19:20:30.123+08:00" as datetime(6)) """
qt_sql """ select cast("2023-07-16T19+08:00" as datetime(6)) """
qt_sql """ select cast("2023-07-16T1920+08:00" as datetime(6)) """
qt_sql """ select cast("70-1-1T00:00:00-0000" as datetime(6)) """
qt_sql """ select cast("19991231T235959.5UTC" as datetime(6)) """
qt_sql """ select cast("2024-05-01T00:00Asia/Shanghai" as datetime(6)) """
qt_sql """ select cast("20231005T081530Europe/London" as datetime(6)) """
qt_sql """ select cast("20230105T081530 Europe/London" as datetime(6)) """
qt_sql """ select cast("85-12-25T000000gMt" as datetime(6)) """
qt_sql """ select cast("2024-05-01" as datetime(6)) """
qt_sql """ select cast("24-5-1" as datetime(6)) """
qt_sql """ select cast("2024-05-01 0:1:2.333" as datetime(6)) """
qt_sql """ select cast("2024-05-01 0:1:2." as datetime(6)) """
qt_sql """ select cast("20240501 01" as datetime(6)) """
qt_sql """ select cast("20230716 1920Z" as datetime(6)) """
qt_sql """ select cast("20240501T0000" as datetime(6)) """
qt_sql """ select cast("2024-12-31 23:59:59.9999999" as datetime(6)) """
qt_sql """ select cast("2025/06/15T00:00:00.99999999999999" as datetime(6)) """
qt_sql """ select cast("2025/06/15T00:00:00.9999987" as datetime(6)) """
qt_sql """ select cast("2025/06/15T00:00:00.99999849" as datetime(6)) """
qt_sql """ select cast("2020-12-12 13:12:12-03:00" as datetime(6)) """
qt_sql """ select cast("0023-01-01T00:00Z" as datetime(6)) """
qt_sql """ select cast("69-12-31" as datetime(6)) """
qt_sql """ select cast("70-01-01" as datetime(6)) """
qt_sql """ select cast("230102" as datetime(6)) """
qt_sql """ select cast("19230101" as datetime(6)) """
qt_sql """ select cast("120102030405" as datetime(6)) """
qt_sql """ select cast("20120102030405" as datetime(6)) """
qt_sql """ select cast("120102030405.999" as datetime(6)) """
qt_sql """ select cast("2024-05-01 0:1:2.333" as datetime(6)) """
qt_sql """ select cast("2023-07-16T19.123+08:00" as datetime(6)) """
qt_sql """ select cast("2024/05/01" as datetime(6)) """
qt_sql """ select cast("24012" as datetime(6)) """
qt_sql """ select cast("2411 123" as datetime(6)) """
qt_sql """ select cast("2024-05-01 01:030:02" as datetime(6)) """
qt_sql """ select cast("10000-01-01 00:00:00" as datetime(6)) """
qt_sql """ select cast("2024-0131T12:00" as datetime(6)) """
qt_sql """ select cast("2024-05-01@00:00" as datetime(6)) """
qt_sql """ select cast("20120212051" as datetime(6)) """
qt_sql """ select cast("2024-05-01T00:00XYZ" as datetime(6)) """
qt_sql """ select cast("2024-5-1T24:00" as datetime(6)) """
qt_sql """ select cast("2024-02-30" as datetime(6)) """
qt_sql """ select cast("2024-05-01T12:60" as datetime(6)) """
qt_sql """ select cast("2012-06-30T23:59:60" as datetime(6)) """
qt_sql """ select cast("2024-05-01T00:00+14:30" as datetime(6)) """
qt_sql """ select cast("2024-05-01T00:00+08:25" as datetime(6)) """
qt_sql """ select cast("9999-12-31 23:59:59.9999999" as datetime(6)) """
qt_sql """ select cast(" 2023-7-4T9-5-3.1Z " as datetime(6)) """
qt_sql """ select cast("99.12.31 23.59.59+05:30" as datetime(6)) """
qt_sql """ select cast("2000/01/01T00/00/00-230" as datetime(6)) """
qt_sql """ select cast("85 1 1T0 0 0. CST" as datetime(6)) """
qt_sql """ select cast("2024-02-29T23:59:59.999999 UTC" as datetime(6)) """
qt_sql """ select cast("70-01-01T00:00:00+14" as datetime(6)) """
qt_sql """ select cast("0023-1-1T1:2:3. -00:00" as datetime(6)) """
qt_sql """ select cast("2025/06/15T00:00:00.0-0" as datetime(6)) """
qt_sql """ select cast("2025/06/15T00:00:00.99999999999" as datetime(6)) """
qt_sql """ select cast("2024-02-29T23-59-60ZULU" as datetime(6)) """
qt_sql """ select cast("2024 12 31T121212.123456 America/New_York" as datetime(6)) """
qt_sql """ select cast("123.123" as datetime(6)) """
qt_sql """ select cast("12121" as datetime(6)) """

qt_sql """ select cast("2023-07-16T19:20:30.123+08:00" as datetime(3)) """
qt_sql """ select cast("2023-07-16T19+08:00" as datetime(3)) """
qt_sql """ select cast("2023-07-16T1920+08:00" as datetime(3)) """
qt_sql """ select cast("70-1-1T00:00:00-0000" as datetime(3)) """
qt_sql """ select cast("19991231T235959.5UTC" as datetime(3)) """
qt_sql """ select cast("2024-05-01T00:00Asia/Shanghai" as datetime(3)) """
qt_sql """ select cast("20231005T081530Europe/London" as datetime(3)) """
qt_sql """ select cast("20230105T081530 Europe/London" as datetime(3)) """
qt_sql """ select cast("85-12-25T000000gMt" as datetime(3)) """
qt_sql """ select cast("2024-05-01" as datetime(3)) """
qt_sql """ select cast("24-5-1" as datetime(3)) """
qt_sql """ select cast("2024-05-01 0:1:2.333" as datetime(3)) """
qt_sql """ select cast("2024-05-01 0:1:2." as datetime(3)) """
qt_sql """ select cast("20240501 01" as datetime(3)) """
qt_sql """ select cast("20230716 1920Z" as datetime(3)) """
qt_sql """ select cast("20240501T0000" as datetime(3)) """
qt_sql """ select cast("2024-12-31 23:59:59.9999999" as datetime(3)) """
qt_sql """ select cast("2025/06/15T00:00:00.99999999999999" as datetime(3)) """
qt_sql """ select cast("2025/06/15T00:00:00.9999987" as datetime(3)) """
qt_sql """ select cast("2025/06/15T00:00:00.99999849" as datetime(3)) """
qt_sql """ select cast("2020-12-12 13:12:12-03:00" as datetime(3)) """
qt_sql """ select cast("0023-01-01T00:00Z" as datetime(3)) """
qt_sql """ select cast("69-12-31" as datetime(3)) """
qt_sql """ select cast("70-01-01" as datetime(3)) """
qt_sql """ select cast("230102" as datetime(3)) """
qt_sql """ select cast("19230101" as datetime(3)) """
qt_sql """ select cast("120102030405" as datetime(3)) """
qt_sql """ select cast("20120102030405" as datetime(3)) """
qt_sql """ select cast("120102030405.999" as datetime(3)) """
qt_sql """ select cast("2024-05-01 0:1:2.333" as datetime(3)) """
qt_sql """ select cast("2023-07-16T19.123+08:00" as datetime(3)) """
qt_sql """ select cast("2024/05/01" as datetime(3)) """
qt_sql """ select cast("24012" as datetime(3)) """
qt_sql """ select cast("2411 123" as datetime(3)) """
qt_sql """ select cast("2024-05-01 01:030:02" as datetime(3)) """
qt_sql """ select cast("10000-01-01 00:00:00" as datetime(3)) """
qt_sql """ select cast("2024-0131T12:00" as datetime(3)) """
qt_sql """ select cast("2024-05-01@00:00" as datetime(3)) """
qt_sql """ select cast("20120212051" as datetime(3)) """
qt_sql """ select cast("2024-05-01T00:00XYZ" as datetime(3)) """
qt_sql """ select cast("2024-5-1T24:00" as datetime(3)) """
qt_sql """ select cast("2024-02-30" as datetime(3)) """
qt_sql """ select cast("2024-05-01T12:60" as datetime(3)) """
qt_sql """ select cast("2012-06-30T23:59:60" as datetime(3)) """
qt_sql """ select cast("2024-05-01T00:00+14:30" as datetime(3)) """
qt_sql """ select cast("2024-05-01T00:00+08:25" as datetime(3)) """
qt_sql """ select cast("9999-12-31 23:59:59.9999999" as datetime(3)) """
qt_sql """ select cast(" 2023-7-4T9-5-3.1Z " as datetime(3)) """
qt_sql """ select cast("99.12.31 23.59.59+05:30" as datetime(3)) """
qt_sql """ select cast("2000/01/01T00/00/00-230" as datetime(3)) """
qt_sql """ select cast("85 1 1T0 0 0. CST" as datetime(3)) """
qt_sql """ select cast("2024-02-29T23:59:59.999999 UTC" as datetime(3)) """
qt_sql """ select cast("70-01-01T00:00:00+14" as datetime(3)) """
qt_sql """ select cast("0023-1-1T1:2:3. -00:00" as datetime(3)) """
qt_sql """ select cast("2025/06/15T00:00:00.0-0" as datetime(3)) """
qt_sql """ select cast("2025/06/15T00:00:00.99999999999" as datetime(3)) """
qt_sql """ select cast("2024-02-29T23-59-60ZULU" as datetime(3)) """
qt_sql """ select cast("2024 12 31T121212.123456 America/New_York" as datetime(3)) """
qt_sql """ select cast("123.123" as datetime(3)) """
qt_sql """ select cast("12121" as datetime(3)) """

qt_sql """ select cast("2023-07-16T19:20:30.123+08:00" as datetime(0)) """
qt_sql """ select cast("2023-07-16T19+08:00" as datetime(0)) """
qt_sql """ select cast("2023-07-16T1920+08:00" as datetime(0)) """
qt_sql """ select cast("70-1-1T00:00:00-0000" as datetime(0)) """
qt_sql """ select cast("19991231T235959.5UTC" as datetime(0)) """
qt_sql """ select cast("2024-05-01T00:00Asia/Shanghai" as datetime(0)) """
qt_sql """ select cast("20231005T081530Europe/London" as datetime(0)) """
qt_sql """ select cast("20230105T081530 Europe/London" as datetime(0)) """
qt_sql """ select cast("85-12-25T000000gMt" as datetime(0)) """
qt_sql """ select cast("2024-05-01" as datetime(0)) """
qt_sql """ select cast("24-5-1" as datetime(0)) """
qt_sql """ select cast("2024-05-01 0:1:2.333" as datetime(0)) """
qt_sql """ select cast("2024-05-01 0:1:2." as datetime(0)) """
qt_sql """ select cast("20240501 01" as datetime(0)) """
qt_sql """ select cast("20230716 1920Z" as datetime(0)) """
qt_sql """ select cast("20240501T0000" as datetime(0)) """
qt_sql """ select cast("2024-12-31 23:59:59.9999999" as datetime(0)) """
qt_sql """ select cast("2025/06/15T00:00:00.99999999999999" as datetime(0)) """
qt_sql """ select cast("2025/06/15T00:00:00.9999987" as datetime(0)) """
qt_sql """ select cast("2025/06/15T00:00:00.99999849" as datetime(0)) """
qt_sql """ select cast("2020-12-12 13:12:12-03:00" as datetime(0)) """
qt_sql """ select cast("0023-01-01T00:00Z" as datetime(0)) """
qt_sql """ select cast("69-12-31" as datetime(0)) """
qt_sql """ select cast("70-01-01" as datetime(0)) """
qt_sql """ select cast("230102" as datetime(0)) """
qt_sql """ select cast("19230101" as datetime(0)) """
qt_sql """ select cast("120102030405" as datetime(0)) """
qt_sql """ select cast("20120102030405" as datetime(0)) """
qt_sql """ select cast("120102030405.999" as datetime(0)) """
qt_sql """ select cast("2024-05-01 0:1:2.333" as datetime(0)) """
qt_sql """ select cast("2023-07-16T19.123+08:00" as datetime(0)) """
qt_sql """ select cast("2024/05/01" as datetime(0)) """
qt_sql """ select cast("24012" as datetime(0)) """
qt_sql """ select cast("2411 123" as datetime(0)) """
qt_sql """ select cast("2024-05-01 01:030:02" as datetime(0)) """
qt_sql """ select cast("10000-01-01 00:00:00" as datetime(0)) """
qt_sql """ select cast("2024-0131T12:00" as datetime(0)) """
qt_sql """ select cast("2024-05-01@00:00" as datetime(0)) """
qt_sql """ select cast("20120212051" as datetime(0)) """
qt_sql """ select cast("2024-05-01T00:00XYZ" as datetime(0)) """
qt_sql """ select cast("2024-5-1T24:00" as datetime(0)) """
qt_sql """ select cast("2024-02-30" as datetime(0)) """
qt_sql """ select cast("2024-05-01T12:60" as datetime(0)) """
qt_sql """ select cast("2012-06-30T23:59:60" as datetime(0)) """
qt_sql """ select cast("2024-05-01T00:00+14:30" as datetime(0)) """
qt_sql """ select cast("2024-05-01T00:00+08:25" as datetime(0)) """
qt_sql """ select cast("9999-12-31 23:59:59.9999999" as datetime(0)) """
qt_sql """ select cast(" 2023-7-4T9-5-3.1Z " as datetime(0)) """
qt_sql """ select cast("99.12.31 23.59.59+05:30" as datetime(0)) """
qt_sql """ select cast("2000/01/01T00/00/00-230" as datetime(0)) """
qt_sql """ select cast("85 1 1T0 0 0. CST" as datetime(0)) """
qt_sql """ select cast("2024-02-29T23:59:59.999999 UTC" as datetime(0)) """
qt_sql """ select cast("70-01-01T00:00:00+14" as datetime(0)) """
qt_sql """ select cast("0023-1-1T1:2:3. -00:00" as datetime(0)) """
qt_sql """ select cast("2025/06/15T00:00:00.0-0" as datetime(0)) """
qt_sql """ select cast("2025/06/15T00:00:00.99999999999" as datetime(0)) """
qt_sql """ select cast("2024-02-29T23-59-60ZULU" as datetime(0)) """
qt_sql """ select cast("2024 12 31T121212.123456 America/New_York" as datetime(0)) """
qt_sql """ select cast("123.123" as datetime(0)) """
qt_sql """ select cast("12121" as datetime(0)) """

qt_sql """ select cast(cast(123.123 as bigint) as datetime(6)) """
qt_sql """ select cast(cast(20150102030405 as bigint) as datetime(6)) """
qt_sql """ select cast(cast(20150102030405.123456 as bigint) as datetime(6)) """
qt_sql """ select cast(cast(20151231235959.99999999999 as bigint) as datetime(6)) """
qt_sql """ select cast(cast(1000 as bigint) as datetime(6)) """

qt_sql """ select cast(cast(123.123 as double) as datetime(6)) """
qt_sql """ select cast(cast(20150102030405 as double) as datetime(6)) """
qt_sql """ select cast(cast(20150102030405.123456 as double) as datetime(6)) """
qt_sql """ select cast(cast(20151231235959.99999999999 as double) as datetime(6)) """
qt_sql """ select cast(cast(1000 as double) as datetime(6)) """

qt_sql """ select cast(cast(123.123 as decimal(27, 9)) as datetime(6)) """
qt_sql """ select cast(cast(20150102030405 as decimal(27, 9)) as datetime(6)) """
qt_sql """ select cast(cast(20150102030405.123456 as decimal(27, 9)) as datetime(6)) """
qt_sql """ select cast(cast(20151231235959.99999999999 as decimal(27, 9)) as datetime(6)) """
qt_sql """ select cast(cast(1000 as decimal(27, 9)) as datetime(6)) """

qt_sql """ select cast(cast("2012-02-05" as date) as datetime(6)) """
qt_sql """ select cast(cast("2012-02-05" as date) as datetime(0)) """

qt_sql """ select cast(cast("500:00:00" as time(1)) as datetime(6)) """
qt_sql """ select cast(cast("23:59:59" as time(3)) as datetime(0)) """

qt_sql """ select cast(cast("2020-12-12 00:00:00.123" as datetime(3)) as datetime(6)) """
qt_sql """ select cast(cast("2020-12-12 00:00:00.123456" as datetime(6)) as datetime(3)) """
qt_sql """ select cast(cast("2020-12-12 00:00:00.99666" as datetime(6)) as datetime(2)) """
qt_sql """ select cast(cast("9999-12-31 23:59:59.999999" as datetime(6)) as datetime(5)) """
}