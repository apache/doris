// Licensed to the Apache Software Foundation (ASF) under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The ASF licenses this file
// to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.  You may obtain a copy of the License at
//
//   http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing,
// software distributed under the License is distributed on an
// "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
// KIND, either express or implied.  See the License for the
// specific language governing permissions and limitations
// under the License.


suite("test_cast_to_decimal64_18_17_from_str") {

    // This test case is generated from the correspoinding be UT test case,
    // update this case if the correspoinding be UT test case is updated,
    // e.g.: ../run-be-ut.sh --run --filter=FunctionCastToDecimalTest.* --gen_regression_case
    sql "drop table if exists test_cast_to_decimal64_18_17_from_str_22_18_17;"
    sql "create table test_cast_to_decimal64_18_17_from_str_22_18_17(f1 int, f2 string) properties('replication_num'='1');"
    sql """insert into test_cast_to_decimal64_18_17_from_str_22_18_17 values (4956, "0.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e2147483647"),(4957, "-0.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e2147483647"),(4958, "0"),(4959, "1"),(4960, "8"),(4961, "9"),(4962, "0."),(4963, "1."),(4964, "8."),(4965, "9."),
      (4966, "-0"),(4967, "-1"),(4968, "-8"),(4969, "-9"),(4970, "-0."),(4971, "-1."),(4972, "-8."),(4973, "-9."),(4974, ".000000000000000004"),(4975, ".000000000000000014"),
      (4976, ".000000000000000094"),(4977, ".099999999999999994"),(4978, ".900000000000000004"),(4979, ".900000000000000014"),(4980, ".999999999999999984"),(4981, ".999999999999999994"),(4982, ".000000000000000005"),(4983, ".000000000000000015"),(4984, ".000000000000000095"),(4985, ".099999999999999995"),
      (4986, ".900000000000000005"),(4987, ".900000000000000015"),(4988, ".999999999999999985"),(4989, ".999999999999999994"),(4990, "-.000000000000000004"),(4991, "-.000000000000000014"),(4992, "-.000000000000000094"),(4993, "-.099999999999999994"),(4994, "-.900000000000000004"),(4995, "-.900000000000000014"),
      (4996, "-.999999999999999984"),(4997, "-.999999999999999994"),(4998, "-.000000000000000005"),(4999, "-.000000000000000015"),(5000, "-.000000000000000095"),(5001, "-.099999999999999995"),(5002, "-.900000000000000005"),(5003, "-.900000000000000015"),(5004, "-.999999999999999985"),(5005, "-.999999999999999994"),
      (5006, "00000000000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5007, "00000000000000000140000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5008, "00000000000000000940000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5009, "00999999999999999940000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5010, "09000000000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5011, "09000000000000000140000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5012, "09999999999999999840000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5013, "09999999999999999940000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5014, "10000000000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5015, "10000000000000000140000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),
      (5016, "10000000000000000940000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5017, "10999999999999999940000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5018, "19000000000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5019, "19000000000000000140000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5020, "19999999999999999840000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5021, "19999999999999999940000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5022, "80000000000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5023, "80000000000000000140000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5024, "80000000000000000940000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5025, "80999999999999999940000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),
      (5026, "89000000000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5027, "89000000000000000140000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5028, "89999999999999999840000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5029, "89999999999999999940000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5030, "90000000000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5031, "90000000000000000140000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5032, "90000000000000000940000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5033, "90999999999999999940000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5034, "99000000000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5035, "99000000000000000140000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),
      (5036, "99999999999999999840000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5037, "99999999999999999940000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5038, "00000000000000000050000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5039, "00000000000000000150000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5040, "00000000000000000950000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5041, "00999999999999999950000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5042, "09000000000000000050000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5043, "09000000000000000150000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5044, "09999999999999999850000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5045, "09999999999999999950000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),
      (5046, "10000000000000000050000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5047, "10000000000000000150000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5048, "10000000000000000950000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5049, "10999999999999999950000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5050, "19000000000000000050000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5051, "19000000000000000150000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5052, "19999999999999999850000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5053, "19999999999999999950000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5054, "80000000000000000050000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5055, "80000000000000000150000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),
      (5056, "80000000000000000950000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5057, "80999999999999999950000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5058, "89000000000000000050000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5059, "89000000000000000150000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5060, "89999999999999999850000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5061, "89999999999999999950000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5062, "90000000000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5063, "90000000000000000140000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5064, "90000000000000000940000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5065, "90999999999999999940000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),
      (5066, "99000000000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5067, "99000000000000000140000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5068, "99999999999999999840000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5069, "99999999999999999940000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5070, "-00000000000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5071, "-00000000000000000140000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5072, "-00000000000000000940000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5073, "-00999999999999999940000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5074, "-09000000000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5075, "-09000000000000000140000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),
      (5076, "-09999999999999999840000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5077, "-09999999999999999940000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5078, "-10000000000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5079, "-10000000000000000140000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5080, "-10000000000000000940000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5081, "-10999999999999999940000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5082, "-19000000000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5083, "-19000000000000000140000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5084, "-19999999999999999840000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5085, "-19999999999999999940000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),
      (5086, "-80000000000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5087, "-80000000000000000140000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5088, "-80000000000000000940000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5089, "-80999999999999999940000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5090, "-89000000000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5091, "-89000000000000000140000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5092, "-89999999999999999840000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5093, "-89999999999999999940000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5094, "-90000000000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5095, "-90000000000000000140000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),
      (5096, "-90000000000000000940000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5097, "-90999999999999999940000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5098, "-99000000000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5099, "-99000000000000000140000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5100, "-99999999999999999840000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5101, "-99999999999999999940000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5102, "-00000000000000000050000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5103, "-00000000000000000150000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5104, "-00000000000000000950000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5105, "-00999999999999999950000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),
      (5106, "-09000000000000000050000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5107, "-09000000000000000150000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5108, "-09999999999999999850000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5109, "-09999999999999999950000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5110, "-10000000000000000050000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5111, "-10000000000000000150000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5112, "-10000000000000000950000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5113, "-10999999999999999950000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5114, "-19000000000000000050000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5115, "-19000000000000000150000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),
      (5116, "-19999999999999999850000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5117, "-19999999999999999950000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5118, "-80000000000000000050000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5119, "-80000000000000000150000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5120, "-80000000000000000950000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5121, "-80999999999999999950000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5122, "-89000000000000000050000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5123, "-89000000000000000150000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5124, "-89999999999999999850000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5125, "-89999999999999999950000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),
      (5126, "-90000000000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5127, "-90000000000000000140000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5128, "-90000000000000000940000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5129, "-90999999999999999940000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5130, "-99000000000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5131, "-99000000000000000140000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5132, "-99999999999999999840000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100"),(5133, "-99999999999999999940000000000000000000000000000000000000000000000000000000000000000000000000000000000.e-100");
    """

    sql "set enable_strict_cast=true;"
    qt_sql_22_strict 'select f1, cast(f2 as decimalv3(18, 17)) from test_cast_to_decimal64_18_17_from_str_22_18_17 order by 1;'

    sql "set enable_strict_cast=false;"
    qt_sql_22_non_strict 'select f1, cast(f2 as decimalv3(18, 17)) from test_cast_to_decimal64_18_17_from_str_22_18_17 order by 1;'

}