--dialect option
set sql_dialect='presto';

-- extract
select EXTRACT(HOUR FROM TIME '12:34:56.123456789012+08:35');
select hour(TIME '12:34:56.123456789012+08:35');
select EXTRACT(MINUTE FROM TIME '12:34:56.123456789012+08:35');
select minute(TIME '12:34:56.123456789012+08:35');
select EXTRACT(SECOND FROM TIME '12:34:56.123456789012+08:35');
second(TIME '12:34:56.123456789012+08:35');
select millisecond(TIME '12:34:56.123456789012+08:35');
select EXTRACT(TIMEZONE_HOUR FROM TIME '12:34:56.123456789012+08:35');
select timezone_hour(TIME '12:34:56.123456789012+08:35');
select EXTRACT(TIMEZONE_HOUR FROM TIME '12:34:56.123456789012-08:35');
select timezone_hour(TIME '12:34:56.123456789012-08:35');
select EXTRACT(TIMEZONE_MINUTE FROM TIME '12:34:56.123456789012+08:35')
select timezone_minute(TIME '12:34:56.123456789012+08:35');
select EXTRACT(TIMEZONE_MINUTE FROM TIME '12:34:56.123456789012-08:35');

-- operators
select TIME '00:00:00.123456789123+14:00' = TIME '00:00:00.123456789123-01:00';
select TIME '12:34:56.123456789123+08:35' <> TIME '12:34:56.123456789123-07:21';
select TIME '12:34:56.123456789123+08:35' IS DISTINCT FROM TIME '12:34:56.123456789123-07:21';
select TIME '03:00:00.123456789123+01:00' < TIME '21:00:00.123456789123-10:00';
select TIME '21:00:00.123456789123-10:00' > TIME '03:00:00.123456789123+01:00';
select TIME '21:00:00.123456789123-01:00' <= TIME '23:00:00.123456789123+01:00';
select TIME '23:00:00.123456789123+01:00' >= TIME '21:00:00.123456789123-01:00';
select TIME '12:34:56.123456789012+08:35' + INTERVAL '1.123' SECOND";
select TIME '12:34:56.123456789012+08:35' - INTERVAL '1.123' SECOND";
select TIME '12:34:56.222222222222+08:35' - TIME '12:34:55.111111111111+08:35';
select TIME '12:34:56.999999999999+08:35' - TIME '12:34:55.111111111111+08:35';
select TIME '09:00:00.000000000000-14:00' - TIME '19:00:00.000000000000+03:00';
select TIME '19:00:00.000000000000+03:00' - TIME '09:00:00.000000000000-14:00';

-- cast to time
select CAST(TIME '12:34:56+08:35' AS TIME(0))
select CAST(TIME '12:34:56.123456789123+08:35' AS TIME(12));
select CAST(TIME '12:34:56.111111111111+08:35' AS TIME(11));
select CAST(TIME '23:59:59.999999999999+08:35' AS TIME(11));

-- -- cast to time with timezone
-- select CAST(TIME '12:34:56 +08:35' AS TIME(0) WITH TIME ZONE);
-- select CAST(TIME '12:34:56.123456789123 +08:35' AS TIME(12) WITH TIME ZONE);
-- select CAST(TIME '12:34:56.111111111111 +08:35' AS TIME(11) WITH TIME ZONE);
-- select CAST(TIME '12:34:56.555555555555 +08:35' AS TIME(11) WITH TIME ZONE);

-- -- cast to timestamp with timezone
-- select CAST(TIME '12:34:56+08:35' AS TIMESTAMP(0) WITH TIME ZONE);
-- select CAST(TIME '12:34:56.123456789123+08:35' AS TIMESTAMP(12) WITH TIME ZONE);
-- select CAST(TIME '12:34:56.12345678912+08:35' AS TIMESTAMP(12) WITH TIME ZONE);
-- select CAST(TIME '12:34:56.111111111111+08:35' AS TIMESTAMP(11) WITH TIME ZONE);
-- select CAST(TIME '12:34:56.555555555555+08:35' AS TIMESTAMP(11) WITH TIME ZONE);

-- cast to varchar
select CAST(TIME '12:34:56.123456789012+08:35' AS VARCHAR);
select CAST(TIME '12:34:56.123456789012-08:35' AS VARCHAR);
select CAST(TIME '12:34:56.123456789012-00:35' AS VARCHAR);

-- cast from varchar
select CAST('12:34:56.111111111111+08:35' AS TIME(12) WITH TIME ZONE);
select CAST('12:34:56.555555555555+08:35' AS TIME(12) WITH TIME ZONE);
select CAST('23:59:59.999999999999+08:35' AS TIME(11) WITH TIME ZONE);

-- test lower digits zeroed
select CAST(CAST(TIME '12:34:56.111+08:35' AS TIME(0) WITH TIME ZONE) AS TIME(3) WITH TIME ZONE);
select CAST(CAST(TIME '12:34:56.555+08:35' AS TIME(0) WITH TIME ZONE) AS TIME(3) WITH TIME ZONE);

-- test round down
select CAST(TIME '12:34:56.111111111111+08:35' AS TIME(11) WITH TIME ZONE);

-- test round up
select CAST(TIME '12:34:56.555555555555+08:35' AS TIME(11) WITH TIME ZONE);

-- test format
select format('%s', TIME '12:34:56.111111111111+08:35');

-- test date_diff
select date_diff('millisecond', TIME '12:34:55.111111111111+08:35', TIME '12:34:56.222222222222+08:35');
select date_diff('hour', TIME '11:34:55.111111111111+08:35', TIME '12:34:56.222222222222+08:35');
select date_diff('millisecond', TIME '13:35:56.123456789123+09:36', TIME '12:34:56.123456789123+08:35');
select date_diff('second', TIME '00:00:00.123456789123+14:00', TIME '00:00:00.123456789123-10:00');

-- test date_add
select date_add('millisecond', 1, TIME '12:34:56.100000000000+08:35');
select date_add('second', 1, TIME '12:34:56.123456789123+08:35');
select date_add('millisecond', BIGINT '365' * 24 * 60 * 60 * 1000 + 1, TIME '12:34:56.000+08:35');
select date_add('millisecond', 889, TIME '23:59:59.111+08:35');

-- test date_tunc
select date_trunc('millisecond', TIME '12:34:56.555555555555+08:35');
select date_trunc('second', TIME '12:34:56.111111111111+08:35');
select date_trunc('minute', TIME '12:34:56.555555555555+08:35');
select date_trunc('hour', TIME '12:34:56.555555555555+08:35');