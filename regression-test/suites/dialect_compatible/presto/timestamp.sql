--dialect option
set sql_dialect='presto';

-- extract
select EXTRACT(YEAR FROM TIMESTAMP '2020-05-10 12:34:56');
select year(TIMESTAMP '2020-05-10 12:34:56');
select EXTRACT(MONTH FROM TIMESTAMP '2020-05-10 12:34:56');
select month(TIMESTAMP '2020-05-10 12:34:56');
select EXTRACT(WEEK FROM TIMESTAMP '2020-05-10 12:34:56');
select week(TIMESTAMP '2020-05-10 12:34:56');
select EXTRACT(DAY FROM TIMESTAMP '2020-05-10 12:34:56');
select day(TIMESTAMP '2020-05-10 12:34:56');
-- select EXTRACT(DAY_OF_MONTH FROM TIMESTAMP '2020-05-10 12:34:56');
-- select day_of_month(TIMESTAMP '2020-05-10 12:34:56');
select EXTRACT(HOUR FROM TIMESTAMP '2020-05-10 12:34:56');
select hour(TIMESTAMP '2020-05-10 12:34:56');
select EXTRACT(MINUTE FROM TIMESTAMP '2020-05-10 12:34:56');
select minute(TIMESTAMP '2020-05-10 12:34:56');
select EXTRACT(SECOND FROM TIMESTAMP '2020-05-10 12:34:56');
select second(TIMESTAMP '2020-05-10 12:34:56');
select EXTRACT(SECOND FROM TIMESTAMP '1500-05-10 12:34:56');
select second(TIMESTAMP '1500-05-10 12:34:56');
-- SELECT millisecond(TIMESTAMP '2020-05-10 12:34:56');
-- SELECT EXTRACT(DAY_OF_WEEK FROM TIMESTAMP '2020-05-10 12:34:56');
-- select day_of_week(TIMESTAMP '2020-05-10 12:34:56');
-- select EXTRACT(DOW FROM TIMESTAMP '2020-05-10 12:34:56');
-- select EXTRACT(DAY_OF_YEAR FROM TIMESTAMP '2020-05-10 12:34:56');
-- select day_of_year(TIMESTAMP '2020-05-10 12:34:56');
-- select EXTRACT(DOY FROM TIMESTAMP '2020-05-10 12:34:56');
select EXTRACT(QUARTER FROM TIMESTAMP '2020-05-10 12:34:56');
select quarter(TIMESTAMP '2020-05-10 12:34:56');
-- SELECT week_of_year(TIMESTAMP '2020-05-10 12:34:56');
-- SELECT EXTRACT(YEAR_OF_WEEK FROM TIMESTAMP '2020-05-10 12:34:56');
-- select EXTRACT(YOW FROM TIMESTAMP '2020-05-10 12:34:56');

-- data_trunc
-- SELECT date_trunc('year', TIMESTAMP '2020-05-10 12:34:56');
-- SELECT date_trunc('quarter', TIMESTAMP '2020-05-10 12:34:56');
-- SELECT date_trunc('month', TIMESTAMP '2020-05-10 12:34:56');
-- SELECT date_trunc('week', TIMESTAMP '2020-05-10 12:34:56');
-- SELECT date_trunc('day', TIMESTAMP '2020-05-10 12:34:56');
-- SELECT date_trunc('hour', TIMESTAMP '2020-05-10 12:34:56');
-- SELECT date_trunc('minute', TIMESTAMP '2020-05-10 12:34:56');
-- SELECT date_trunc('second', TIMESTAMP '2020-05-10 12:34:56');
-- SELECT date_trunc('millisecond', TIMESTAMP '2020-05-10 12:34:56');

-- operators
select TIMESTAMP '2020-05-01 12:34:56' = TIMESTAMP '2020-05-01 12:34:56';
select TIMESTAMP '2020-05-01 12:34:56' <> TIMESTAMP '2021-05-01 12:34:56';
-- select TIMESTAMP '2020-05-01 12:34:56' IS DISTINCT FROM TIMESTAMP '2020-05-01 12:34:55';
select TIMESTAMP '2020-05-01 12:34:56' < TIMESTAMP '2020-05-01 12:34:57';
select TIMESTAMP '2020-05-01 12:34:56' > TIMESTAMP '2020-05-01 12:34:55';
select TIMESTAMP '2020-05-01 12:34:56' <= TIMESTAMP '2020-05-01 12:34:57';
select TIMESTAMP '2020-05-01 12:34:56' >= TIMESTAMP '2020-05-01 12:34:55';
select TIMESTAMP '2020-05-01 12:34:56' BETWEEN TIMESTAMP '2020-05-01 12:34:55' and TIMESTAMP '2020-05-01 12:34:57';
select TIMESTAMP '2020-05-01 12:34:56' + INTERVAL '1.123' SECOND;
select TIMESTAMP '2020-05-01 12:34:56' - INTERVAL '1.123' SECOND;
select TIMESTAMP '2020-05-01 12:34:56' - INTERVAL '1' DAY;
select TIMESTAMP '2020-05-01 12:34:56' + INTERVAL '1' MONTH;
select TIMESTAMP '2020-05-01 12:34:56' - INTERVAL '1' MONTH;
select TIMESTAMP '2020-05-01 12:34:56' - TIMESTAMP '2020-05-01 12:34:55';

-- timestamp
-- select to_unixtime(TIMESTAMP '2020-05-10 12:34:56');
select localtimestamp(0);
-- select localtimestamp(12);
select CAST(TIMESTAMP '2020-05-01 12:34:56' AS DATE);
-- select CAST(DATE '2020-05-01' AS TIMESTAMP(0));
-- select CAST(DATE '2020-05-01' AS TIMESTAMP(12));
-- select CAST(TIMESTAMP '2020-05-01 12:34:56' AS TIME(0));
-- select CAST(TIMESTAMP '2020-05-01 12:34:56.123456789123' AS TIME(12));
-- select CAST(TIMESTAMP '2020-05-01 12:34:56' AS TIME(0) WITH TIME ZONE);
-- select CAST(TIMESTAMP '2020-05-01 12:34:56.123456789123' AS TIME(12) WITH TIME ZONE);
-- select CAST(TIMESTAMP '12001-05-01 12:34:56' AS TIME(0) WITH TIME ZONE);
-- select CAST(TIMESTAMP '-12001-05-01 12:34:56' AS TIME(0) WITH TIME ZONE);
-- select CAST(TIMESTAMP '2020-05-01 23:59:59.9' AS TIME(0) WITH TIME ZONE);
-- select CAST(TIMESTAMP '2020-05-01 23:59:59.999999999999' AS TIME(11) WITH TIME ZONE);
-- select CAST(TIMESTAMP '2020-05-01 12:34:56' AS TIMESTAMP(0) WITH TIME ZONE);
-- select CAST(TIMESTAMP '2020-05-01 12:34:56.12345678912' AS TIMESTAMP(12) WITH TIME ZONE);
-- select CAST(TIMESTAMP '2020-05-01 12:34:56.1' AS TIMESTAMP(0) WITH TIME ZONE);
-- select CAST(TIMESTAMP '2020-05-01 12:34:56.111111111111' AS TIMESTAMP(11) WITH TIME ZONE);
-- select CAST(TIMESTAMP '2020-05-01 12:34:56.5' AS TIMESTAMP(0) WITH TIME ZONE);
-- select CAST(TIMESTAMP '2020-05-01 12:34:56.555555555555' AS TIMESTAMP(11) WITH TIME ZONE);
-- select CAST(TIMESTAMP '12001-05-01 12:34:56' AS TIMESTAMP(0) WITH TIME ZONE);
-- select CAST(TIMESTAMP '-12001-05-01 12:34:56' AS TIMESTAMP(0) WITH TIME ZONE);

-- select CAST(TIMESTAMP '2020-05-01 12:34:56.123456789012' AS JSON);
-- select CAST(TIMESTAMP '123001-05-01 12:34:56.123456789012' AS JSON);
-- select CAST(TIMESTAMP '-123001-05-01 12:34:56.123456789012' AS JSON);
select CAST(TIMESTAMP '2020-05-01 12:34:56.123456789012' AS VARCHAR);
select CAST(TIMESTAMP '1500-05-01 12:34:56.123456789012' AS VARCHAR);
-- select CAST(TIMESTAMP '123001-05-01 12:34:56' AS VARCHAR);
-- select CAST(TIMESTAMP '-123001-05-01 12:34:56' AS VARCHAR);

select CAST('2020-05-01 12:34:56.555555555555' AS TIMESTAMP(0));
select CAST('2020-05-01 12:34:56.555555555555' AS TIMESTAMP(12));
select CAST('1500-05-01 12:34:56.555555555555' AS TIMESTAMP(12));
select CAST('123001-05-01 12:34:56.111111111111' AS TIMESTAMP(12));
select CAST('+123001-05-01 12:34:56.111111111111' AS TIMESTAMP(12));
select CAST('-123001-05-01 12:34:56.111111111111' AS TIMESTAMP(12));
select CAST('2020-05-10 12:34:56.111111111111 +01:23' AS TIMESTAMP(12));

select CAST(CAST(TIMESTAMP '2020-05-10 12:34:56.111111111111' AS TIMESTAMP(0)) AS TIMESTAMP(12));
select CAST(TIMESTAMP '2020-05-10 12:34:56.111111111111' AS TIMESTAMP(0));
select CAST(TIMESTAMP '2020-05-10 12:34:56.111111111111' AS TIMESTAMP(11));
select CAST(TIMESTAMP '1500-05-10 12:34:56.111111111111' AS TIMESTAMP(11));
select CAST(TIMESTAMP '1970-01-01 00:00:00.999999999995' AS timestamp(11));

select to_iso8601(TIMESTAMP '2020-05-01 12:34:56');
select format('%s', TIMESTAMP '2020-05-10 12:34:56.111111111111');
select format_datetime(TIMESTAMP '2020-05-10 12:34:56.111111111111', 'yyyy-MM-dd HH:mm:ss.SSS');
select date_format(TIMESTAMP '2020-05-10 12:34:56.111111111111', '%Y-%m-%d %H:%i:%s.%f');
select with_timezone(TIMESTAMP '2020-05-01 12:34:56.123456789123', 'America/Los_Angeles');
select sequence(TIMESTAMP '2020-01-01 12:34:56', TIMESTAMP '2020-01-01 12:34:59', INTERVAL '1' SECOND);
select sequence(TIMESTAMP '2020-01-01 12:34:56.123456789012', TIMESTAMP '2020-01-01 12:34:59.123456789012', INTERVAL '1' SECOND);
select sequence(TIMESTAMP '2020-01-01 12:34:56', TIMESTAMP '2020-04-01 12:34:56', INTERVAL '1' MONTH);
select sequence(TIMESTAMP '2020-01-01 12:34:56.123456789012', TIMESTAMP '2020-04-01 12:34:59.123456789012', INTERVAL '1' MONTH);

select date_diff('millisecond', TIMESTAMP '2020-05-10 12:34:55', TIMESTAMP '2020-05-10 12:34:56');
select date_diff('millisecond', TIMESTAMP '2020-05-10 12:34:55.111111111111', TIMESTAMP '2020-05-10 12:34:56.222222222222');
select date_diff('hour', TIMESTAMP '2020-05-10 11:34:55.1', TIMESTAMP '2020-05-10 12:34:56.9');
select date_diff('hour', TIMESTAMP '2020-05-10 11:34:55.111111111111', TIMESTAMP '2020-05-10 12:34:56.999999999999');
select date_diff('day', TIMESTAMP '2001-01-31 19:34:55', TIMESTAMP '2005-09-10 13:31:00');
select date_diff('day', TIMESTAMP '2001-01-31 19:34:55.111111111111', TIMESTAMP '2005-09-10 13:31:00.999999999999');
select date_diff('week', TIMESTAMP '2001-01-31 19:34:55', TIMESTAMP '2005-09-10 13:31:00');
select date_diff('week', TIMESTAMP '2001-01-31 19:34:55.111111111111', TIMESTAMP '2005-09-10 13:31:00.999999999999');
select date_diff('month', TIMESTAMP '2001-01-31 19:34:55', TIMESTAMP '2005-09-10 13:31:00');
select date_diff('month', TIMESTAMP '2001-01-31 19:34:55.111111111111', TIMESTAMP '2005-09-10 13:31:00.999999999999');
select date_diff('quarter', TIMESTAMP '2001-01-31 19:34:55', TIMESTAMP '2005-09-10 13:31:00');
select date_diff('quarter', TIMESTAMP '2001-01-31 19:34:55.111111111111', TIMESTAMP '2005-09-10 13:31:00.999999999999');
select date_diff('year', TIMESTAMP '2001-01-31 19:34:55', TIMESTAMP '2005-09-10 13:31:00');
select date_diff('year', TIMESTAMP '2001-01-31 19:34:55.111111111111', TIMESTAMP '2005-09-10 13:31:00.999999999999');

select date_add('millisecond', 1, TIMESTAMP '2020-05-10 12:34:56.111111111111');
select date_add('day', 1683, TIMESTAMP '2001-01-31 13:31:00.111111111111');
select date_add('week', 240, TIMESTAMP '2001-02-03 13:31:00.111111111111');
select date_add('month', 55, TIMESTAMP '2001-02-10 13:31:00.111111111111');
select date_add('quarter', 18, TIMESTAMP '2001-03-10 13:31:00.111111111111');
select date_add('year', 4, TIMESTAMP '2001-09-10 13:31:00.111111111111');

select last_day_of_month(TIMESTAMP '2020-05-01 12:34:56.123456789123');

select CAST(TIMESTAMP '2020-05-26 09:26:10' as TIME(0));
select CAST(TIMESTAMP '2020-05-26 09:26:10.111111111111' as TIME(12));

select TIMESTAMP '2020-05-01 12:34:56.123456789123' AT TIME ZONE 'America/Los_Angeles';
select TIMESTAMP '2020-05-01 12:34:56.123456789123' AT TIME ZONE INTERVAL '10' HOUR";
select CAST('2001-1-22 Asia/Oral' AS timestamp);
