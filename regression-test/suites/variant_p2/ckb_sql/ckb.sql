SELECT COUNT(*) FROM regression_test_variant_p2.ckb_hits;
SELECT COUNT(*) FROM regression_test_variant_p2.ckb_hits WHERE cast(var['AdvEngineID'] as smallint) <> 0;
SELECT SUM(cast(var['AdvEngineID'] as smallint)), COUNT(*), AVG(cast(var['ResolutionWidth'] as smallint)) FROM regression_test_variant_p2.ckb_hits;
SELECT AVG(UserID) FROM regression_test_variant_p2.ckb_hits;
SELECT COUNT(DISTINCT UserID) FROM regression_test_variant_p2.ckb_hits;
SELECT COUNT(DISTINCT cast(var['SearchPhrase'] as text)) FROM regression_test_variant_p2.ckb_hits;
SELECT MIN(EventDate), MAX(EventDate) FROM regression_test_variant_p2.ckb_hits;
SELECT cast(var['AdvEngineID'] as smallint), COUNT(*) FROM regression_test_variant_p2.ckb_hits WHERE cast(var['AdvEngineID'] as smallint) <> 0 GROUP BY cast(var['AdvEngineID'] as smallint) ORDER BY COUNT(*) DESC;
SELECT cast(var['RegionID'] as int), COUNT(DISTINCT UserID) AS u FROM regression_test_variant_p2.ckb_hits GROUP BY cast(var['RegionID'] as int) ORDER BY u DESC LIMIT 10;
SELECT cast(var['RegionID'] as int), SUM(cast(var['AdvEngineID'] as smallint)), COUNT(*) AS c, AVG(cast(var['ResolutionWidth'] as smallint)), COUNT(DISTINCT UserID) FROM regression_test_variant_p2.ckb_hits GROUP BY cast(var['RegionID'] as int) ORDER BY c DESC LIMIT 10;
SELECT cast(var['MobilePhoneModel'] as text), COUNT(DISTINCT UserID) AS u FROM regression_test_variant_p2.ckb_hits WHERE cast(var['MobilePhoneModel'] as text) <> '' GROUP BY cast(var['MobilePhoneModel'] as text) ORDER BY u DESC LIMIT 10;
SELECT cast(var['MobilePhone'] as tinyint) as MobilePhoneNumber, cast(var['MobilePhoneModel'] as text), COUNT(DISTINCT UserID) AS u FROM regression_test_variant_p2.ckb_hits WHERE cast(var['MobilePhoneModel'] as text) <> '' GROUP BY MobilePhoneNumber, cast(var['MobilePhoneModel'] as text) ORDER BY u DESC LIMIT 10;
SELECT cast(var['SearchPhrase'] as text), COUNT(*) AS c FROM regression_test_variant_p2.ckb_hits WHERE cast(var['SearchPhrase'] as text) <> '' GROUP BY cast(var['SearchPhrase'] as text) ORDER BY c DESC LIMIT 10;
SELECT cast(var['SearchPhrase'] as text), COUNT(DISTINCT UserID) AS u FROM regression_test_variant_p2.ckb_hits WHERE cast(var['SearchPhrase'] as text) <> '' GROUP BY cast(var['SearchPhrase'] as text) ORDER BY u DESC LIMIT 10;
SELECT cast(var['SearchEngineID'] as smallint) as SearchEngineID, cast(var['SearchPhrase'] as text), COUNT(*) AS c FROM regression_test_variant_p2.ckb_hits WHERE cast(var['SearchPhrase'] as text) <> '' GROUP BY SearchEngineID, cast(var['SearchPhrase'] as text) ORDER BY c DESC LIMIT 10;
SELECT UserID, COUNT(*) FROM regression_test_variant_p2.ckb_hits GROUP BY UserID ORDER BY COUNT(*) DESC LIMIT 10;
SELECT UserID, cast(var['SearchPhrase'] as text), COUNT(*) FROM regression_test_variant_p2.ckb_hits GROUP BY UserID, cast(var['SearchPhrase'] as text) ORDER BY COUNT(*) DESC LIMIT 10;
SELECT UserID, cast(var['SearchPhrase'] as text) as SearchPhrase, COUNT(*) FROM regression_test_variant_p2.ckb_hits GROUP BY UserID, cast(var['SearchPhrase'] as text) ORDER BY UserID, SearchPhrase LIMIT 10;
SELECT UserID, extract(minute FROM EventTime) AS m, cast(var['SearchPhrase'] as text), COUNT(*) FROM regression_test_variant_p2.ckb_hits GROUP BY UserID, m, cast(var['SearchPhrase'] as text) ORDER BY COUNT(*) DESC, UserID LIMIT 10;
SELECT UserID FROM regression_test_variant_p2.ckb_hits WHERE UserID = 435090932899640449;
SELECT COUNT(*) FROM regression_test_variant_p2.ckb_hits WHERE cast(var['URL'] as text) LIKE '%google%';
SELECT cast(var['SearchPhrase'] as text), MIN(cast(var['URL'] as text)) as URL, COUNT(*) AS c FROM regression_test_variant_p2.ckb_hits WHERE cast(var['URL'] as text) LIKE '%google%' AND cast(var['SearchPhrase'] as text) <> '' GROUP BY cast(var['SearchPhrase'] as text) ORDER BY c DESC, URL LIMIT 10;
SELECT cast(var['SearchPhrase'] as text), MIN(cast(var['URL'] as text)) as URL, MIN(cast(var['Title'] as text)), COUNT(*) AS c, COUNT(DISTINCT UserID) FROM regression_test_variant_p2.ckb_hits WHERE cast(var['Title'] as text) LIKE '%Google%' AND cast(var['URL'] as text) NOT LIKE '%.google.%' AND cast(var['SearchPhrase'] as text) <> '' GROUP BY cast(var['SearchPhrase'] as text) ORDER BY c DESC, URL LIMIT 10;
SELECT * FROM regression_test_variant_p2.ckb_hits WHERE cast(var['URL'] as text) LIKE '%google%' ORDER BY EventTime LIMIT 10;
SELECT cast(var['SearchPhrase'] as text) as SearchPhrase FROM regression_test_variant_p2.ckb_hits WHERE cast(var['SearchPhrase'] as text) <> '' ORDER BY EventTime, SearchPhrase LIMIT 10;
SELECT cast(var['SearchPhrase'] as text) FROM regression_test_variant_p2.ckb_hits WHERE cast(var['SearchPhrase'] as text) <> '' ORDER BY cast(var['SearchPhrase'] as text) LIMIT 10;
SELECT cast(var['SearchPhrase'] as text) FROM regression_test_variant_p2.ckb_hits WHERE cast(var['SearchPhrase'] as text) <> '' ORDER BY EventTime, cast(var['SearchPhrase'] as text) LIMIT 10;
SELECT cast(var['CounterID'] as smallint), AVG(length(cast(var['URL'] as text))) AS l, COUNT(*) AS c FROM regression_test_variant_p2.ckb_hits WHERE cast(var['URL'] as text) <> '' GROUP BY cast(var['CounterID'] as smallint) HAVING COUNT(*) > 100000 ORDER BY l DESC LIMIT 25;
SELECT REGEXP_REPLACE(cast(var['Referer'] as text), '^https?://(?:www\.)?([^/]+)/.*$', '\\1') AS k, AVG(length(cast(var['Referer'] as text))) AS l, COUNT(*) AS c, MIN(cast(var['Referer'] as text)) FROM regression_test_variant_p2.ckb_hits WHERE cast(var['Referer'] as text) <> '' GROUP BY k HAVING COUNT(*) > 100000 ORDER BY l DESC LIMIT 25;
SELECT SUM(cast(var['ResolutionWidth'] as smallint)), SUM(cast(var['ResolutionWidth'] as smallint) + 1), SUM(cast(var['ResolutionWidth'] as smallint) + 2), SUM(cast(var['ResolutionWidth'] as smallint) + 3), SUM(cast(var['ResolutionWidth'] as smallint) + 4), SUM(cast(var['ResolutionWidth'] as smallint) + 5), SUM(cast(var['ResolutionWidth'] as smallint) + 6), SUM(cast(var['ResolutionWidth'] as smallint) + 7), SUM(cast(var['ResolutionWidth'] as smallint) + 8), SUM(cast(var['ResolutionWidth'] as smallint) + 9), SUM(cast(var['ResolutionWidth'] as smallint) + 10), SUM(cast(var['ResolutionWidth'] as smallint) + 11), SUM(cast(var['ResolutionWidth'] as smallint) + 12), SUM(cast(var['ResolutionWidth'] as smallint) + 13), SUM(cast(var['ResolutionWidth'] as smallint) + 14), SUM(cast(var['ResolutionWidth'] as smallint) + 15), SUM(cast(var['ResolutionWidth'] as smallint) + 16), SUM(cast(var['ResolutionWidth'] as smallint) + 17), SUM(cast(var['ResolutionWidth'] as smallint) + 18), SUM(cast(var['ResolutionWidth'] as smallint) + 19), SUM(cast(var['ResolutionWidth'] as smallint) + 20), SUM(cast(var['ResolutionWidth'] as smallint) + 21), SUM(cast(var['ResolutionWidth'] as smallint) + 22), SUM(cast(var['ResolutionWidth'] as smallint) + 23), SUM(cast(var['ResolutionWidth'] as smallint) + 24), SUM(cast(var['ResolutionWidth'] as smallint) + 25), SUM(cast(var['ResolutionWidth'] as smallint) + 26), SUM(cast(var['ResolutionWidth'] as smallint) + 27), SUM(cast(var['ResolutionWidth'] as smallint) + 28), SUM(cast(var['ResolutionWidth'] as smallint) + 29), SUM(cast(var['ResolutionWidth'] as smallint) + 30), SUM(cast(var['ResolutionWidth'] as smallint) + 31), SUM(cast(var['ResolutionWidth'] as smallint) + 32), SUM(cast(var['ResolutionWidth'] as smallint) + 33), SUM(cast(var['ResolutionWidth'] as smallint) + 34), SUM(cast(var['ResolutionWidth'] as smallint) + 35), SUM(cast(var['ResolutionWidth'] as smallint) + 36), SUM(cast(var['ResolutionWidth'] as smallint) + 37), SUM(cast(var['ResolutionWidth'] as smallint) + 38), SUM(cast(var['ResolutionWidth'] as smallint) + 39), SUM(cast(var['ResolutionWidth'] as smallint) + 40), SUM(cast(var['ResolutionWidth'] as smallint) + 41), SUM(cast(var['ResolutionWidth'] as smallint) + 42), SUM(cast(var['ResolutionWidth'] as smallint) + 43), SUM(cast(var['ResolutionWidth'] as smallint) + 44), SUM(cast(var['ResolutionWidth'] as smallint) + 45), SUM(cast(var['ResolutionWidth'] as smallint) + 46), SUM(cast(var['ResolutionWidth'] as smallint) + 47), SUM(cast(var['ResolutionWidth'] as smallint) + 48), SUM(cast(var['ResolutionWidth'] as smallint) + 49), SUM(cast(var['ResolutionWidth'] as smallint) + 50), SUM(cast(var['ResolutionWidth'] as smallint) + 51), SUM(cast(var['ResolutionWidth'] as smallint) + 52), SUM(cast(var['ResolutionWidth'] as smallint) + 53), SUM(cast(var['ResolutionWidth'] as smallint) + 54), SUM(cast(var['ResolutionWidth'] as smallint) + 55), SUM(cast(var['ResolutionWidth'] as smallint) + 56), SUM(cast(var['ResolutionWidth'] as smallint) + 57), SUM(cast(var['ResolutionWidth'] as smallint) + 58), SUM(cast(var['ResolutionWidth'] as smallint) + 59), SUM(cast(var['ResolutionWidth'] as smallint) + 60), SUM(cast(var['ResolutionWidth'] as smallint) + 61), SUM(cast(var['ResolutionWidth'] as smallint) + 62), SUM(cast(var['ResolutionWidth'] as smallint) + 63), SUM(cast(var['ResolutionWidth'] as smallint) + 64), SUM(cast(var['ResolutionWidth'] as smallint) + 65), SUM(cast(var['ResolutionWidth'] as smallint) + 66), SUM(cast(var['ResolutionWidth'] as smallint) + 67), SUM(cast(var['ResolutionWidth'] as smallint) + 68), SUM(cast(var['ResolutionWidth'] as smallint) + 69), SUM(cast(var['ResolutionWidth'] as smallint) + 70), SUM(cast(var['ResolutionWidth'] as smallint) + 71), SUM(cast(var['ResolutionWidth'] as smallint) + 72), SUM(cast(var['ResolutionWidth'] as smallint) + 73), SUM(cast(var['ResolutionWidth'] as smallint) + 74), SUM(cast(var['ResolutionWidth'] as smallint) + 75), SUM(cast(var['ResolutionWidth'] as smallint) + 76), SUM(cast(var['ResolutionWidth'] as smallint) + 77), SUM(cast(var['ResolutionWidth'] as smallint) + 78), SUM(cast(var['ResolutionWidth'] as smallint) + 79), SUM(cast(var['ResolutionWidth'] as smallint) + 80), SUM(cast(var['ResolutionWidth'] as smallint) + 81), SUM(cast(var['ResolutionWidth'] as smallint) + 82), SUM(cast(var['ResolutionWidth'] as smallint) + 83), SUM(cast(var['ResolutionWidth'] as smallint) + 84), SUM(cast(var['ResolutionWidth'] as smallint) + 85), SUM(cast(var['ResolutionWidth'] as smallint) + 86), SUM(cast(var['ResolutionWidth'] as smallint) + 87), SUM(cast(var['ResolutionWidth'] as smallint) + 88), SUM(cast(var['ResolutionWidth'] as smallint) + 89) FROM regression_test_variant_p2.ckb_hits;
SELECT cast(var['SearchEngineID'] as smallint) as SearchEngineID, cast(var['ClientIP'] as int) as ClientIP, COUNT(*) AS c, SUM(cast(var['IsRefresh'] as tinyint)), AVG(cast(var['ResolutionWidth'] as smallint)) FROM regression_test_variant_p2.ckb_hits WHERE cast(var['SearchPhrase'] as text) <> '' GROUP BY SearchEngineID, cast(var['ClientIP'] as int) ORDER BY c DESC, ClientIP LIMIT 10;
SELECT WatchID, cast(var['ClientIP'] as int), COUNT(*) AS c, SUM(cast(var['IsRefresh'] as tinyint)), AVG(cast(var['ResolutionWidth'] as smallint)) FROM regression_test_variant_p2.ckb_hits WHERE cast(var['SearchPhrase'] as text) <> '' GROUP BY WatchID, cast(var['ClientIP'] as int) ORDER BY c, WatchID DESC LIMIT 10;
SELECT WatchID, cast(var['ClientIP'] as int), COUNT(*) AS c, SUM(cast(var['IsRefresh'] as tinyint)), AVG(cast(var['ResolutionWidth'] as smallint)) FROM regression_test_variant_p2.ckb_hits GROUP BY WatchID, cast(var['ClientIP'] as int) ORDER BY c, WatchID DESC LIMIT 10;
SELECT cast(var['URL'] as text), COUNT(*) AS c FROM regression_test_variant_p2.ckb_hits GROUP BY cast(var['URL'] as text) ORDER BY c DESC LIMIT 10;
SELECT 1, cast(var['URL'] as text), COUNT(*) AS c FROM regression_test_variant_p2.ckb_hits GROUP BY 1, cast(var['URL'] as text) ORDER BY c DESC LIMIT 10;
SELECT cast(var['ClientIP'] as int), cast(var['ClientIP'] as int) - 1, cast(var['ClientIP'] as int) - 2, cast(var['ClientIP'] as int) - 3, COUNT(*) AS c FROM regression_test_variant_p2.ckb_hits GROUP BY cast(var['ClientIP'] as int), cast(var['ClientIP'] as int) - 1, cast(var['ClientIP'] as int) - 2, cast(var['ClientIP'] as int) - 3 ORDER BY c DESC LIMIT 10;
SELECT cast(var['URL'] as text), COUNT(*) AS PageViews FROM regression_test_variant_p2.ckb_hits WHERE cast(var['CounterID'] as smallint) = 62 AND EventDate >= '2013-07-01' AND EventDate <= '2013-07-31' AND cast(var['DontCountHits'] as tinyint) = 0 AND cast(var['IsRefresh'] as tinyint) = 0 AND cast(var['URL'] as text) <> '' GROUP BY cast(var['URL'] as text) ORDER BY PageViews DESC LIMIT 10;
SELECT cast(var['Title'] as text), COUNT(*) AS PageViews FROM regression_test_variant_p2.ckb_hits WHERE cast(var['CounterID'] as smallint) = 62 AND EventDate >= '2013-07-01' AND EventDate <= '2013-07-31' AND cast(var['DontCountHits'] as tinyint) = 0 AND cast(var['IsRefresh'] as tinyint) = 0 AND cast(var['Title'] as text) <> '' GROUP BY cast(var['Title'] as text) ORDER BY PageViews DESC LIMIT 10;
SELECT cast(var['URL'] as text) as URL, COUNT(*) AS PageViews FROM regression_test_variant_p2.ckb_hits WHERE cast(var['CounterID'] as smallint) = 62 AND EventDate >= '2013-07-01' AND EventDate <= '2013-07-31' AND cast(var['IsRefresh'] as tinyint) = 0 AND cast(var['IsLink'] as tinyint) <> 0 AND cast(var['IsDownload'] as tinyint) = 0 GROUP BY URL ORDER BY PageViews DESC, URL DESC LIMIT 10 OFFSET 1000;
SELECT cast(var['TraficSourceID'] as tinyint) as TraficSourceID, cast(var['SearchEngineID'] as smallint) as SearchEngineID, cast(var['AdvEngineID'] as smallint) as AdvEngineID, CASE WHEN (cast(var['SearchEngineID'] as smallint) = 0 AND cast(var['AdvEngineID'] as smallint) = 0) THEN cast(var['Referer'] as text) ELSE '' END AS Src, cast(var['URL'] as text) AS Dst, COUNT(*) AS PageViews FROM regression_test_variant_p2.ckb_hits WHERE cast(var['CounterID'] as smallint) = 62 AND EventDate >= '2013-07-01' AND EventDate <= '2013-07-31' AND cast(var['IsRefresh'] as tinyint) = 0 GROUP BY TraficSourceID, SearchEngineID, AdvEngineID , Src, Dst ORDER BY PageViews DESC, src LIMIT 10 OFFSET 1000;
SELECT URLHash, EventDate, COUNT(*) AS PageViews FROM regression_test_variant_p2.ckb_hits WHERE cast(var['CounterID'] as smallint) = 62 AND EventDate >= '2013-07-01' AND EventDate <= '2013-07-31' AND cast(var['IsRefresh'] as tinyint) = 0 AND cast(var['TraficSourceID'] as tinyint) IN (-1, 6) AND RefererHash = 3594120000172545465 GROUP BY URLHash, EventDate ORDER BY PageViews DESC, URLHash LIMIT 10 OFFSET 100;
SELECT cast(var['WindowClientWidth'] as smallint) as WindowClientWidth, cast(var['WindowClientHeight'] as smallint) as WindowClientHeight, COUNT(*) AS PageViews FROM regression_test_variant_p2.ckb_hits WHERE cast(var['CounterID'] as smallint) = 62 AND EventDate >= '2013-07-01' AND EventDate <= '2013-07-31' AND cast(var['IsRefresh'] as tinyint) = 0 AND cast(var['DontCountHits'] as tinyint) = 0 AND URLHash = 2868770270353813622 GROUP BY WindowClientWidth, WindowClientHeight ORDER BY PageViews DESC, WindowClientWidth, WindowClientHeight LIMIT 10 OFFSET 1000;
SELECT DATE_FORMAT(EventTime, '%Y-%m-%d %H:%i:00') AS M, COUNT(*) AS PageViews FROM regression_test_variant_p2.ckb_hits WHERE cast(var['CounterID'] as smallint) = 62 AND EventDate >= '2013-07-14' AND EventDate <= '2013-07-15' AND cast(var['IsRefresh'] as tinyint) = 0 AND cast(var['DontCountHits'] as tinyint) = 0 GROUP BY DATE_FORMAT(EventTime, '%Y-%m-%d %H:%i:00') ORDER BY DATE_FORMAT(EventTime, '%Y-%m-%d %H:%i:00') LIMIT 10 OFFSET 1000;