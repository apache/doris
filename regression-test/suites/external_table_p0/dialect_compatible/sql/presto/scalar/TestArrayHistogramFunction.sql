set sql_dialect='presto';
set enable_fallback_to_original_planner=false;
set debug_skip_fold_constant=false;
-- SELECT array_histogram(ARRAY[42]); # error: errCode = 2, detailMessage = Unknown column 'ARRAY' in 'table list' in PROJECT clause
-- SELECT array_histogram(ARRAY[42]); # error: errCode = 2, detailMessage = Unknown column 'ARRAY' in 'table list' in PROJECT clause
-- SELECT array_histogram(ARRAY[42, 7]); # error: errCode = 2, detailMessage = Syntax error in line 1:	SELECT array_histogram(ARRAY[42, 7]);	                               ^	Encountered: COMMA	Expected: ||	
-- SELECT array_histogram(ARRAY[42, 42, 42]); # error: errCode = 2, detailMessage = Syntax error in line 1:	SELECT array_histogram(ARRAY[42, 42, 42]);	                               ^	Encountered: COMMA	Expected: ||	
-- SELECT array_histogram(ARRAY['a', 'b', 'a']); # error: errCode = 2, detailMessage = Syntax error in line 1:	SELECT array_histogram(ARRAY['a', 'b', 'a']);	                                ^	Encountered: COMMA	Expected: ||	
-- SELECT array_histogram(ARRAY[42, 42, 42]); # error: errCode = 2, detailMessage = Syntax error in line 1:	SELECT array_histogram(ARRAY[42, 42, 42]);	                               ^	Encountered: COMMA	Expected: ||	
-- SELECT array_histogram(ARRAY['a', 'b', 'a']); # error: errCode = 2, detailMessage = Syntax error in line 1:	SELECT array_histogram(ARRAY['a', 'b', 'a']);	                                ^	Encountered: COMMA	Expected: ||	
-- SELECT array_histogram(ARRAY[]); # error: errCode = 2, detailMessage = Syntax error in line 1:	SELECT array_histogram(ARRAY[]);	                             ^	Encountered: ]	Expected: IDENTIFIER	
-- SELECT array_histogram(ARRAY[NULL]); # error: errCode = 2, detailMessage = Unknown column 'ARRAY' in 'table list' in PROJECT clause
-- SELECT array_histogram(ARRAY[42, NULL]); # error: errCode = 2, detailMessage = Syntax error in line 1:	SELECT array_histogram(ARRAY[42, NULL]);	                               ^	Encountered: COMMA	Expected: ||	
-- SELECT array_histogram(ARRAY[NULL, NULL, NULL, NULL, NULL]); # error: errCode = 2, detailMessage = Syntax error in line 1:	SELECT array_histogram(ARRAY[NULL, NULL, NULL, NULL, NULL]);	                                 ^	Encountered: COMMA	Expected: ||	
-- SELECT array_histogram(ARRAY[42, 42, 42, 7, 1, 7, 1, 42, 7, 1, 1, 42, 7, 42, 1, 7, 2, 3, 7, 42, 42]); # error: errCode = 2, detailMessage = Syntax error in line 1:	...T array_histogram(ARRAY[42, 42, 42, 7, 1, 7, 1, 42, 7,...	                             ^	Encountered: COMMA	Expected: ||	
-- SELECT array_histogram(ARRAY[NULL, '', NULL, '']); # error: errCode = 2, detailMessage = Syntax error in line 1:	SELECT array_histogram(ARRAY[NULL, '', NULL, '']);	                                 ^	Encountered: COMMA	Expected: ||	
-- SELECT array_histogram(CAST(ARRAY[NULL, -0.1, 0, 0.1, -0.1, NULL, 0.0] AS ARRAY(DECIMAL(1,1)))); # error: errCode = 2, detailMessage = Syntax error in line 1:	..._histogram(CAST(ARRAY[NULL, -0.1, 0, 0.1, -0.1, NULL, ...	                             ^	Encountered: COMMA	Expected: ||	
-- SELECT array_histogram(ARRAY[IPADDRESS '10.0.0.1', IPADDRESS '::ffff:a00:1']); # error: errCode = 2, detailMessage = Syntax error in line 1:	...histogram(ARRAY[IPADDRESS '10.0.0.1', IPADDRESS '::fff...	                             ^	Encountered: STRING LITERAL	Expected: ||	
-- SELECT transform_keys(array_histogram(a); # error: errCode = 2, detailMessage = Syntax error in line 1:	SELECT transform_keys(array_histogram(a);	                                        ^	Encountered: ;	Expected: COMMA	
-- SELECT array_histogram(ARRAY[true, false, true]); # error: errCode = 2, detailMessage = Syntax error in line 1:	SELECT array_histogram(ARRAY[true, false, true]);	                                 ^	Encountered: COMMA	Expected: ||	
-- SELECT array_histogram(ARRAY[42, 7, 42]); # error: errCode = 2, detailMessage = Syntax error in line 1:	SELECT array_histogram(ARRAY[42, 7, 42]);	                               ^	Encountered: COMMA	Expected: ||	
-- SELECT array_histogram(ARRAY[42.1, 7.7, 42.1]); # error: errCode = 2, detailMessage = Syntax error in line 1:	SELECT array_histogram(ARRAY[42.1, 7.7, 42.1]);	                                 ^	Encountered: COMMA	Expected: ||	
-- SELECT array_histogram(ARRAY[DECIMAL '42.1', DECIMAL '7.7', DECIMAL '42.1']); # error: errCode = 2, detailMessage = Syntax error in line 1:	...y_histogram(ARRAY[DECIMAL '42.1', DECIMAL '7.7', DECIM...	                             ^	Encountered: STRING LITERAL	Expected: ||	
-- SELECT array_histogram(ARRAY[X'42', X'77', X'42']); # error: errCode = 2, detailMessage = Syntax error in line 1:	SELECT array_histogram(ARRAY[X'42', X'77', X'42']);	                              ^	Encountered: STRING LITERAL	Expected: ||	
-- SELECT array_histogram(ARRAY[json_object('k1': 42), json_object('k1': 7), json_object('k1': 42)]); # error: errCode = 2, detailMessage = Syntax error in line 1:	...ram(ARRAY[json_object('k1': 42), json_object('k1': 7),...	                             ^	Encountered: :	Expected: ||, COMMA	
-- SELECT array_histogram(ARRAY[DATE '2023-01-01', DATE '2023-07-07', DATE '2023-01-01']); # error: errCode = 2, detailMessage = Syntax error in line 1:	...am(ARRAY[DATE '2023-01-01', DATE '2023-07-07', DATE '2...	                             ^	Encountered: COMMA	Expected: ||	
-- SELECT array_histogram(ARRAY[TIMESTAMP '2023-01-01 00:00:42', TIMESTAMP '2023-07-07 00:00:07', TIMESTAMP '2023-01-01 00:00:42']); # error: errCode = 2, detailMessage = Syntax error in line 1:	...TAMP '2023-01-01 00:00:42', TIMESTAMP '2023-07-07 00:0...	                             ^	Encountered: COMMA	Expected: ||	
-- SELECT array_histogram(ARRAY[ARRAY[42], ARRAY[42, 7], ARRAY[42]]); # error: errCode = 2, detailMessage = Syntax error in line 1:	..._histogram(ARRAY[ARRAY[42], ARRAY[42, 7], ARRAY[42]]);	                             ^	Encountered: COMMA	Expected: ||	
-- SELECT array_histogram(ARRAY[MAP(ARRAY[42], ARRAY[1]), MAP(ARRAY[42, 7], ARRAY[1, 1]), MAP(ARRAY[42], ARRAY[1])]); # error: errCode = 2, detailMessage = Syntax error in line 1:	...Y[MAP(ARRAY[42], ARRAY[1]), MAP(ARRAY[42, 7], ARRAY[1,...	                             ^	Encountered: COMMA	Expected: ||	
-- SELECT array_histogram(ARRAY[ROW(42, 42), ROW(7, 7), ROW(42, 42)]); # error: errCode = 2, detailMessage = Syntax error in line 1:	SELECT array_histogram(ARRAY[ROW(42, 42), ROW(7, 7), ROW(...	                             ^	Encountered: ROW	Expected: ROW is keyword, maybe `ROW`	
set debug_skip_fold_constant=true;
-- SELECT array_histogram(ARRAY[42]); # error: errCode = 2, detailMessage = Unknown column 'ARRAY' in 'table list' in PROJECT clause
-- SELECT array_histogram(ARRAY[42]); # error: errCode = 2, detailMessage = Unknown column 'ARRAY' in 'table list' in PROJECT clause
-- SELECT array_histogram(ARRAY[42, 7]); # error: errCode = 2, detailMessage = Syntax error in line 1:	SELECT array_histogram(ARRAY[42, 7]);	                               ^	Encountered: COMMA	Expected: ||	
-- SELECT array_histogram(ARRAY[42, 42, 42]); # error: errCode = 2, detailMessage = Syntax error in line 1:	SELECT array_histogram(ARRAY[42, 42, 42]);	                               ^	Encountered: COMMA	Expected: ||	
-- SELECT array_histogram(ARRAY['a', 'b', 'a']); # error: errCode = 2, detailMessage = Syntax error in line 1:	SELECT array_histogram(ARRAY['a', 'b', 'a']);	                                ^	Encountered: COMMA	Expected: ||	
-- SELECT array_histogram(ARRAY[42, 42, 42]); # error: errCode = 2, detailMessage = Syntax error in line 1:	SELECT array_histogram(ARRAY[42, 42, 42]);	                               ^	Encountered: COMMA	Expected: ||	
-- SELECT array_histogram(ARRAY['a', 'b', 'a']); # error: errCode = 2, detailMessage = Syntax error in line 1:	SELECT array_histogram(ARRAY['a', 'b', 'a']);	                                ^	Encountered: COMMA	Expected: ||	
-- SELECT array_histogram(ARRAY[]); # error: errCode = 2, detailMessage = Syntax error in line 1:	SELECT array_histogram(ARRAY[]);	                             ^	Encountered: ]	Expected: IDENTIFIER	
-- SELECT array_histogram(ARRAY[NULL]); # error: errCode = 2, detailMessage = Unknown column 'ARRAY' in 'table list' in PROJECT clause
-- SELECT array_histogram(ARRAY[42, NULL]); # error: errCode = 2, detailMessage = Syntax error in line 1:	SELECT array_histogram(ARRAY[42, NULL]);	                               ^	Encountered: COMMA	Expected: ||	
-- SELECT array_histogram(ARRAY[NULL, NULL, NULL, NULL, NULL]); # error: errCode = 2, detailMessage = Syntax error in line 1:	SELECT array_histogram(ARRAY[NULL, NULL, NULL, NULL, NULL]);	                                 ^	Encountered: COMMA	Expected: ||	
-- SELECT array_histogram(ARRAY[42, 42, 42, 7, 1, 7, 1, 42, 7, 1, 1, 42, 7, 42, 1, 7, 2, 3, 7, 42, 42]); # error: errCode = 2, detailMessage = Syntax error in line 1:	...T array_histogram(ARRAY[42, 42, 42, 7, 1, 7, 1, 42, 7,...	                             ^	Encountered: COMMA	Expected: ||	
-- SELECT array_histogram(ARRAY[NULL, '', NULL, '']); # error: errCode = 2, detailMessage = Syntax error in line 1:	SELECT array_histogram(ARRAY[NULL, '', NULL, '']);	                                 ^	Encountered: COMMA	Expected: ||	
-- SELECT array_histogram(CAST(ARRAY[NULL, -0.1, 0, 0.1, -0.1, NULL, 0.0] AS ARRAY(DECIMAL(1,1)))); # error: errCode = 2, detailMessage = Syntax error in line 1:	..._histogram(CAST(ARRAY[NULL, -0.1, 0, 0.1, -0.1, NULL, ...	                             ^	Encountered: COMMA	Expected: ||	
-- SELECT array_histogram(ARRAY[IPADDRESS '10.0.0.1', IPADDRESS '::ffff:a00:1']); # error: errCode = 2, detailMessage = Syntax error in line 1:	...histogram(ARRAY[IPADDRESS '10.0.0.1', IPADDRESS '::fff...	                             ^	Encountered: STRING LITERAL	Expected: ||	
-- SELECT transform_keys(array_histogram(a); # error: errCode = 2, detailMessage = Syntax error in line 1:	SELECT transform_keys(array_histogram(a);	                                        ^	Encountered: ;	Expected: COMMA	
-- SELECT array_histogram(ARRAY[true, false, true]); # error: errCode = 2, detailMessage = Syntax error in line 1:	SELECT array_histogram(ARRAY[true, false, true]);	                                 ^	Encountered: COMMA	Expected: ||	
-- SELECT array_histogram(ARRAY[42, 7, 42]); # error: errCode = 2, detailMessage = Syntax error in line 1:	SELECT array_histogram(ARRAY[42, 7, 42]);	                               ^	Encountered: COMMA	Expected: ||	
-- SELECT array_histogram(ARRAY[42.1, 7.7, 42.1]); # error: errCode = 2, detailMessage = Syntax error in line 1:	SELECT array_histogram(ARRAY[42.1, 7.7, 42.1]);	                                 ^	Encountered: COMMA	Expected: ||	
-- SELECT array_histogram(ARRAY[DECIMAL '42.1', DECIMAL '7.7', DECIMAL '42.1']); # error: errCode = 2, detailMessage = Syntax error in line 1:	...y_histogram(ARRAY[DECIMAL '42.1', DECIMAL '7.7', DECIM...	                             ^	Encountered: STRING LITERAL	Expected: ||	
-- SELECT array_histogram(ARRAY[X'42', X'77', X'42']); # error: errCode = 2, detailMessage = Syntax error in line 1:	SELECT array_histogram(ARRAY[X'42', X'77', X'42']);	                              ^	Encountered: STRING LITERAL	Expected: ||	
-- SELECT array_histogram(ARRAY[json_object('k1': 42), json_object('k1': 7), json_object('k1': 42)]); # error: errCode = 2, detailMessage = Syntax error in line 1:	...ram(ARRAY[json_object('k1': 42), json_object('k1': 7),...	                             ^	Encountered: :	Expected: ||, COMMA	
-- SELECT array_histogram(ARRAY[DATE '2023-01-01', DATE '2023-07-07', DATE '2023-01-01']); # error: errCode = 2, detailMessage = Syntax error in line 1:	...am(ARRAY[DATE '2023-01-01', DATE '2023-07-07', DATE '2...	                             ^	Encountered: COMMA	Expected: ||	
-- SELECT array_histogram(ARRAY[TIMESTAMP '2023-01-01 00:00:42', TIMESTAMP '2023-07-07 00:00:07', TIMESTAMP '2023-01-01 00:00:42']); # error: errCode = 2, detailMessage = Syntax error in line 1:	...TAMP '2023-01-01 00:00:42', TIMESTAMP '2023-07-07 00:0...	                             ^	Encountered: COMMA	Expected: ||	
-- SELECT array_histogram(ARRAY[ARRAY[42], ARRAY[42, 7], ARRAY[42]]); # error: errCode = 2, detailMessage = Syntax error in line 1:	..._histogram(ARRAY[ARRAY[42], ARRAY[42, 7], ARRAY[42]]);	                             ^	Encountered: COMMA	Expected: ||	
-- SELECT array_histogram(ARRAY[MAP(ARRAY[42], ARRAY[1]), MAP(ARRAY[42, 7], ARRAY[1, 1]), MAP(ARRAY[42], ARRAY[1])]); # error: errCode = 2, detailMessage = Syntax error in line 1:	...Y[MAP(ARRAY[42], ARRAY[1]), MAP(ARRAY[42, 7], ARRAY[1,...	                             ^	Encountered: COMMA	Expected: ||	
-- SELECT array_histogram(ARRAY[ROW(42, 42), ROW(7, 7), ROW(42, 42)]) # error: errCode = 2, detailMessage = Syntax error in line 1:	SELECT array_histogram(ARRAY[ROW(42, 42), ROW(7, 7), ROW(...	                             ^	Encountered: ROW	Expected: ROW is keyword, maybe `ROW`	
