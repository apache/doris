set sql_dialect='presto';
set enable_fallback_to_original_planner=false;
set debug_skip_fold_constant=false;
-- SELECT zip_with(ARRAY[], ARRAY[], (x, y) -> (y, x)); # error: errCode = 2, detailMessage = Syntax error in line 1:	SELECT zip_with(ARRAY[], ARRAY[], (x, y) -> (y, x));	                      ^	Encountered: ]	Expected: IDENTIFIER	
-- SELECT zip_with(ARRAY[1, 2], ARRAY['a', 'b'], (x, y) -> (y, x)); # error: errCode = 2, detailMessage = Syntax error in line 1:	SELECT zip_with(ARRAY[1, 2], ARRAY['a', 'b'], (x, y...	                       ^	Encountered: COMMA	Expected: ||	
-- SELECT zip_with(ARRAY[1, 2], ARRAY[VARCHAR 'a', VARCHAR 'b'], (x, y) -> (y, x)); # error: errCode = 2, detailMessage = Syntax error in line 1:	SELECT zip_with(ARRAY[1, 2], ARRAY[VARCHAR 'a', VAR...	                       ^	Encountered: COMMA	Expected: ||	
-- SELECT zip_with(ARRAY[1, 1], ARRAY[1, 2], (x, y) -> x + y); # error: errCode = 2, detailMessage = Syntax error in line 1:	SELECT zip_with(ARRAY[1, 1], ARRAY[1, 2], (x, y) -> x + y);	                       ^	Encountered: COMMA	Expected: ||	
-- SELECT zip_with(CAST(ARRAY[3, 5] AS ARRAY(BIGINT)), CAST(ARRAY[1, 2] AS ARRAY(BIGINT)), (x, y) -> x * y); # error: errCode = 2, detailMessage = Syntax error in line 1:	SELECT zip_with(CAST(ARRAY[3, 5] AS ARRAY(BIGINT)), CAST...	                            ^	Encountered: COMMA	Expected: ||	
-- SELECT zip_with(ARRAY[true, false], ARRAY[false, true], (x, y) -> x OR y); # error: errCode = 2, detailMessage = Syntax error in line 1:	SELECT zip_with(ARRAY[true, false], ARRAY[false, true]...	                          ^	Encountered: COMMA	Expected: ||	
-- SELECT zip_with(ARRAY['a', 'b'], ARRAY['c', 'd'], (x, y) -> concat(x, y)); # error: errCode = 2, detailMessage = Syntax error in line 1:	SELECT zip_with(ARRAY['a', 'b'], ARRAY['c', 'd'], (x,...	                         ^	Encountered: COMMA	Expected: ||	
-- SELECT zip_with(ARRAY[MAP(ARRAY[CAST ('a' AS VARCHAR)], ARRAY[1]), MAP(ARRAY[VARCHAR 'b'], ARRAY[2])], ARRAY[MAP(ARRAY['c'], ARRAY[3]), MAP()], (x, y) -> map_concat(x, y)); # error: errCode = 2, detailMessage = Syntax error in line 1:	...a' AS VARCHAR)], ARRAY[1]), MAP(ARRAY[VARCHAR 'b'], AR...	                             ^	Encountered: COMMA	Expected: ||	
-- SELECT zip_with(ARRAY[1], ARRAY['a', 'bc'], (x, y) -> (y, x)); # error: errCode = 2, detailMessage = Syntax error in line 1:	...p_with(ARRAY[1], ARRAY['a', 'bc'], (x, y) -> (y, x));	                             ^	Encountered: COMMA	Expected: ||	
-- SELECT zip_with(ARRAY[NULL, 2], ARRAY['a'], (x, y) -> (y, x)); # error: errCode = 2, detailMessage = Syntax error in line 1:	SELECT zip_with(ARRAY[NULL, 2], ARRAY['a'], (x, y) -> ...	                          ^	Encountered: COMMA	Expected: ||	
-- SELECT zip_with(ARRAY[NULL, NULL], ARRAY[NULL, 2, 1], (x, y) -> x + y); # error: errCode = 2, detailMessage = Syntax error in line 1:	SELECT zip_with(ARRAY[NULL, NULL], ARRAY[NULL, 2, 1], ...	                          ^	Encountered: COMMA	Expected: ||	
-- SELECT zip_with(CAST(NULL AS ARRAY(UNKNOWN)), ARRAY[], (x, y) -> (y, x)); # error: errCode = 2, detailMessage = Syntax error in line 1:	...ip_with(CAST(NULL AS ARRAY(UNKNOWN)), ARRAY[], (x, y) ...	                             ^	Encountered: (	Expected	
-- SELECT zip_with(ARRAY[NULL], ARRAY[NULL], (x, y) -> (y, x)); # error: errCode = 2, detailMessage = Syntax error in line 1:	SELECT zip_with(ARRAY[NULL], ARRAY[NULL], (x, y) -> (y, x));	                                            ^	Encountered: COMMA	Expected: ||	
-- SELECT zip_with(ARRAY[NULL], ARRAY[NULL], (x, y) -> x IS NULL AND y IS NULL); # error: errCode = 2, detailMessage = Unknown column 'ARRAY' in 'table list' in PROJECT clause
-- SELECT zip_with(ARRAY['a', NULL], ARRAY[NULL, 1], (x, y) -> x IS NULL OR y IS NULL); # error: errCode = 2, detailMessage = Syntax error in line 1:	SELECT zip_with(ARRAY['a', NULL], ARRAY[NULL, 1], (x,...	                         ^	Encountered: COMMA	Expected: ||	
-- SELECT zip_with(ARRAY[1, NULL], ARRAY[3, 4], (x, y) -> x + y); # error: errCode = 2, detailMessage = Syntax error in line 1:	SELECT zip_with(ARRAY[1, NULL], ARRAY[3, 4], (x, y)...	                       ^	Encountered: COMMA	Expected: ||	
-- SELECT zip_with(ARRAY['a', 'b'], ARRAY[1, 3], (x, y) -> NULL); # error: errCode = 2, detailMessage = Syntax error in line 1:	SELECT zip_with(ARRAY['a', 'b'], ARRAY[1, 3], (x, y) ...	                         ^	Encountered: COMMA	Expected: ||	
set debug_skip_fold_constant=true;
-- SELECT zip_with(ARRAY[], ARRAY[], (x, y) -> (y, x)); # error: errCode = 2, detailMessage = Syntax error in line 1:	SELECT zip_with(ARRAY[], ARRAY[], (x, y) -> (y, x));	                      ^	Encountered: ]	Expected: IDENTIFIER	
-- SELECT zip_with(ARRAY[1, 2], ARRAY['a', 'b'], (x, y) -> (y, x)); # error: errCode = 2, detailMessage = Syntax error in line 1:	SELECT zip_with(ARRAY[1, 2], ARRAY['a', 'b'], (x, y...	                       ^	Encountered: COMMA	Expected: ||	
-- SELECT zip_with(ARRAY[1, 2], ARRAY[VARCHAR 'a', VARCHAR 'b'], (x, y) -> (y, x)); # error: errCode = 2, detailMessage = Syntax error in line 1:	SELECT zip_with(ARRAY[1, 2], ARRAY[VARCHAR 'a', VAR...	                       ^	Encountered: COMMA	Expected: ||	
-- SELECT zip_with(ARRAY[1, 1], ARRAY[1, 2], (x, y) -> x + y); # error: errCode = 2, detailMessage = Syntax error in line 1:	SELECT zip_with(ARRAY[1, 1], ARRAY[1, 2], (x, y) -> x + y);	                       ^	Encountered: COMMA	Expected: ||	
-- SELECT zip_with(CAST(ARRAY[3, 5] AS ARRAY(BIGINT)), CAST(ARRAY[1, 2] AS ARRAY(BIGINT)), (x, y) -> x * y); # error: errCode = 2, detailMessage = Syntax error in line 1:	SELECT zip_with(CAST(ARRAY[3, 5] AS ARRAY(BIGINT)), CAST...	                            ^	Encountered: COMMA	Expected: ||	
-- SELECT zip_with(ARRAY[true, false], ARRAY[false, true], (x, y) -> x OR y); # error: errCode = 2, detailMessage = Syntax error in line 1:	SELECT zip_with(ARRAY[true, false], ARRAY[false, true]...	                          ^	Encountered: COMMA	Expected: ||	
-- SELECT zip_with(ARRAY['a', 'b'], ARRAY['c', 'd'], (x, y) -> concat(x, y)); # error: errCode = 2, detailMessage = Syntax error in line 1:	SELECT zip_with(ARRAY['a', 'b'], ARRAY['c', 'd'], (x,...	                         ^	Encountered: COMMA	Expected: ||	
-- SELECT zip_with(ARRAY[MAP(ARRAY[CAST ('a' AS VARCHAR)], ARRAY[1]), MAP(ARRAY[VARCHAR 'b'], ARRAY[2])], ARRAY[MAP(ARRAY['c'], ARRAY[3]), MAP()], (x, y) -> map_concat(x, y)); # error: errCode = 2, detailMessage = Syntax error in line 1:	...a' AS VARCHAR)], ARRAY[1]), MAP(ARRAY[VARCHAR 'b'], AR...	                             ^	Encountered: COMMA	Expected: ||	
-- SELECT zip_with(ARRAY[1], ARRAY['a', 'bc'], (x, y) -> (y, x)); # error: errCode = 2, detailMessage = Syntax error in line 1:	...p_with(ARRAY[1], ARRAY['a', 'bc'], (x, y) -> (y, x));	                             ^	Encountered: COMMA	Expected: ||	
-- SELECT zip_with(ARRAY[NULL, 2], ARRAY['a'], (x, y) -> (y, x)); # error: errCode = 2, detailMessage = Syntax error in line 1:	SELECT zip_with(ARRAY[NULL, 2], ARRAY['a'], (x, y) -> ...	                          ^	Encountered: COMMA	Expected: ||	
-- SELECT zip_with(ARRAY[NULL, NULL], ARRAY[NULL, 2, 1], (x, y) -> x + y); # error: errCode = 2, detailMessage = Syntax error in line 1:	SELECT zip_with(ARRAY[NULL, NULL], ARRAY[NULL, 2, 1], ...	                          ^	Encountered: COMMA	Expected: ||	
-- SELECT zip_with(CAST(NULL AS ARRAY(UNKNOWN)), ARRAY[], (x, y) -> (y, x)); # error: errCode = 2, detailMessage = Syntax error in line 1:	...ip_with(CAST(NULL AS ARRAY(UNKNOWN)), ARRAY[], (x, y) ...	                             ^	Encountered: (	Expected	
-- SELECT zip_with(ARRAY[NULL], ARRAY[NULL], (x, y) -> (y, x)); # error: errCode = 2, detailMessage = Syntax error in line 1:	SELECT zip_with(ARRAY[NULL], ARRAY[NULL], (x, y) -> (y, x));	                                            ^	Encountered: COMMA	Expected: ||	
-- SELECT zip_with(ARRAY[NULL], ARRAY[NULL], (x, y) -> x IS NULL AND y IS NULL); # error: errCode = 2, detailMessage = Unknown column 'ARRAY' in 'table list' in PROJECT clause
-- SELECT zip_with(ARRAY['a', NULL], ARRAY[NULL, 1], (x, y) -> x IS NULL OR y IS NULL); # error: errCode = 2, detailMessage = Syntax error in line 1:	SELECT zip_with(ARRAY['a', NULL], ARRAY[NULL, 1], (x,...	                         ^	Encountered: COMMA	Expected: ||	
-- SELECT zip_with(ARRAY[1, NULL], ARRAY[3, 4], (x, y) -> x + y); # error: errCode = 2, detailMessage = Syntax error in line 1:	SELECT zip_with(ARRAY[1, NULL], ARRAY[3, 4], (x, y)...	                       ^	Encountered: COMMA	Expected: ||	
-- SELECT zip_with(ARRAY['a', 'b'], ARRAY[1, 3], (x, y) -> NULL) # error: errCode = 2, detailMessage = Syntax error in line 1:	SELECT zip_with(ARRAY['a', 'b'], ARRAY[1, 3], (x, y) ...	                         ^	Encountered: COMMA	Expected: ||	
