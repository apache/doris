-- This file is automatically generated. You should know what you did if you want to edit this
-- !ds_shape_64 --
cost = 5.6467570685776794E10
PhysicalCTEAnchor ( cteId=CTEId#1 )
|--PhysicalCTEProducer[168246] ( stats=6,233,420.5, cteId=CTEId#1 )
|  +--PhysicalProject[168243]@80 ( stats=6,233,420.5, projects=[i_product_name#340 AS `product_name`#341, i_item_sk#319 AS `item_sk`#342, s_store_name#198 AS `store_name`#343, s_zip#218 AS `store_zip`#344, ca_street_number#289 AS `b_street_number`#345, ca_street_name#290 AS `b_street_name`#346, ca_city#293 AS `b_city`#347, ca_zip#296 AS `b_zip`#348, ca_street_number#302 AS `c_street_number`#349, ca_street_name#303 AS `c_street_name`#350, ca_city#306 AS `c_city`#351, ca_zip#309 AS `c_zip`#352, d_year#115 AS `syear`#353, cnt#356, s1#357, s2#358, s3#359] )
|     +--PhysicalHashAggregate[168240]@79 ( stats=6,233,420.5, aggPhase=GLOBAL, aggMode=BUFFER_TO_RESULT, maybeUseStreaming=false, groupByExpr=[i_product_name#340, i_item_sk#319, s_store_name#198, s_zip#218, ca_street_number#289, ca_street_name#290, ca_city#293, ca_zip#296, ca_street_number#302, ca_street_name#303, ca_city#306, ca_zip#309, d_year#115, d_year#143, d_year#171], outputExpr=[i_product_name#340, i_item_sk#319, s_store_name#198, s_zip#218, ca_street_number#289, ca_street_name#290, ca_city#293, ca_zip#296, ca_street_number#302, ca_street_name#303, ca_city#306, ca_zip#309, d_year#115, d_year#143, d_year#171, count(partial_count(*)#469) AS `cnt`#356, sum(partial_sum(ss_wholesale_cost)#470) AS `s1`#357, sum(partial_sum(ss_list_price)#471) AS `s2`#358, sum(partial_sum(ss_coupon_amt)#472) AS `s3`#359], partitionExpr=Optional.empty, topnFilter=false, topnPushDown=false )
|        +--PhysicalDistribute[168237]@3034 ( stats=6,233,420.5, distributionSpec=DistributionSpecHash ( orderedShuffledColumns=[340, 319, 198, 218, 289, 290, 293, 296, 302, 303, 306, 309, 115, 143, 171], shuffleType=EXECUTION_BUCKETED, tableId=-1, selectedIndexId=-1, partitionIds=[], equivalenceExprIds=[[340], [319], [198], [218], [289], [290], [293], [296], [302], [303], [306], [309], [115], [143], [171]], exprIdToEquivalenceSet={340=0, 319=1, 198=2, 218=3, 289=4, 290=5, 293=6, 296=7, 302=8, 303=9, 306=10, 309=11, 115=12, 143=13, 171=14} ) )
|           +--PhysicalHashAggregate[168234]@3034 ( stats=6,233,420.5, aggPhase=LOCAL, aggMode=INPUT_TO_BUFFER, maybeUseStreaming=true, groupByExpr=[i_product_name#340, i_item_sk#319, s_store_name#198, s_zip#218, ca_street_number#289, ca_street_name#290, ca_city#293, ca_zip#296, ca_street_number#302, ca_street_name#303, ca_city#306, ca_zip#309, d_year#115, d_year#143, d_year#171], outputExpr=[i_product_name#340, i_item_sk#319, s_store_name#198, s_zip#218, ca_street_number#289, ca_street_name#290, ca_city#293, ca_zip#296, ca_street_number#302, ca_street_name#303, ca_city#306, ca_zip#309, d_year#115, d_year#143, d_year#171, partial_count(*) AS `partial_count(*)`#469, partial_sum(ss_wholesale_cost#74) AS `partial_sum(ss_wholesale_cost)`#470, partial_sum(ss_list_price#75) AS `partial_sum(ss_list_price)`#471, partial_sum(ss_coupon_amt#82) AS `partial_sum(ss_coupon_amt)`#472], partitionExpr=Optional.empty, topnFilter=false, topnPushDown=false )
|              +--PhysicalProject[168231]@78 ( stats=6,233,420.5, projects=[i_product_name#340, i_item_sk#319, s_store_name#198, s_zip#218, ca_street_number#289, ca_street_name#290, ca_city#293, ca_zip#296, ca_street_number#302, ca_street_name#303, ca_city#306, ca_zip#309, d_year#115, d_year#143, d_year#171, ss_coupon_amt#82, ss_wholesale_cost#74, ss_list_price#75] )
|                 +--PhysicalHashJoin[168228]@3032 ( stats=8,100,077.29, type=INNER_JOIN, hashCondition=[(c_first_shipto_date_sk#227 = d_date_sk#165)], otherCondition=[], markCondition=[], RFs=[RF19[d_date_sk#165->[c_first_shipto_date_sk#227](ndv/size = 73042/65536) ] )
|                    |--PhysicalProject[168225]@3025 ( stats=8,099,301.1, projects=[ss_item_sk#64, ss_wholesale_cost#74, ss_list_price#75, ss_coupon_amt#82, s_store_name#198, s_zip#218, i_item_sk#319, i_product_name#340, d_year#115, ca_street_number#289, ca_street_name#290, ca_city#293, ca_zip#296, c_first_shipto_date_sk#227, d_year#143, ca_street_number#302, ca_street_name#303, ca_city#306, ca_zip#309] )
|                    |  +--PhysicalHashJoin[168222]@3030 ( stats=8,099,301.1, type=INNER_JOIN, hashCondition=[(ss_customer_sk#67 = c_customer_sk#222)], otherCondition=[( not (cd_marital_status#242 = cd_marital_status#251))], markCondition=[], RFs=[RF18[c_customer_sk#222->[ss_customer_sk#67](ndv/size = 11915597/16777216) ] )
|                    |     |--PhysicalDistribute[168219]@2859 ( stats=10,099,787.79, distributionSpec=DistributionSpecHash ( orderedShuffledColumns=[67], shuffleType=EXECUTION_BUCKETED, tableId=-1, selectedIndexId=-1, partitionIds=[], equivalenceExprIds=[[67]], exprIdToEquivalenceSet={67=0} ) )
|                    |     |  +--PhysicalProject[168216]@2859 ( stats=10,099,787.79, projects=[ss_item_sk#64, ss_customer_sk#67, ss_wholesale_cost#74, ss_list_price#75, ss_coupon_amt#82, s_store_name#198, s_zip#218, i_item_sk#319, i_product_name#340, d_year#115, cd_marital_status#242, ca_street_number#289, ca_street_name#290, ca_city#293, ca_zip#296] )
|                    |     |     +--PhysicalHashJoin[168213]@2956 ( stats=10,099,787.79, type=INNER_JOIN, hashCondition=[(ss_promo_sk#72 = p_promo_sk#258)], otherCondition=[], markCondition=[], RFs=[RF17[p_promo_sk#258->[ss_promo_sk#72](ndv/size = 1489/2048) ] )
|                    |     |        |--PhysicalProject[168210]@2745 ( stats=10,025,722.68, projects=[ss_item_sk#64, ss_customer_sk#67, ss_promo_sk#72, ss_wholesale_cost#74, ss_list_price#75, ss_coupon_amt#82, s_store_name#198, s_zip#218, i_item_sk#319, i_product_name#340, d_year#115, cd_marital_status#242, ca_street_number#289, ca_street_name#290, ca_city#293, ca_zip#296] )
|                    |     |        |  +--PhysicalHashJoin[168207]@2746 ( stats=10,025,722.68, type=INNER_JOIN, hashCondition=[(ss_addr_sk#70 = ca_address_sk#287)], otherCondition=[], markCondition=[], RFs=[RF16[ss_addr_sk#70->[ca_address_sk#287](ndv/size = 6015811/8388608) ] )
|                    |     |        |     |--PhysicalProject[167720]@59 ( stats=6,000,000, projects=[ca_address_sk#287, ca_street_number#289, ca_street_name#290, ca_city#293, ca_zip#296] )
|                    |     |        |     |  +--PhysicalOlapScan[customer_address]@58 ( stats=6,000,000, operativeSlots=[ca_address_sk#287, ca_street_number#289, ca_street_name#290, ca_city#293, ca_zip#296], virtualColumns=[], JRFs= RF16 )
|                    |     |        |     +--PhysicalDistribute[168204]@2675 ( stats=10,052,142.13, distributionSpec=DistributionSpecHash ( orderedShuffledColumns=[70], shuffleType=STORAGE_BUCKETED, tableId=-1, selectedIndexId=-1, partitionIds=[], equivalenceExprIds=[[70]], exprIdToEquivalenceSet={70=0} ) )
|                    |     |        |        +--PhysicalProject[168201]@2675 ( stats=10,052,142.13, projects=[ss_item_sk#64, ss_customer_sk#67, ss_addr_sk#70, ss_promo_sk#72, ss_wholesale_cost#74, ss_list_price#75, ss_coupon_amt#82, s_store_name#198, s_zip#218, i_item_sk#319, i_product_name#340, d_year#115, cd_marital_status#242] )
|                    |     |        |           +--PhysicalHashJoin[168198]@2744 ( stats=10,052,142.13, type=INNER_JOIN, hashCondition=[(ss_item_sk#64 = sr_item_sk#86), (ss_ticket_number#65 = sr_ticket_number#87)], otherCondition=[], markCondition=[], RFs=[RF14[ss_item_sk#64->[sr_item_sk#86](ndv/size = 1673/2048) , RF15[ss_ticket_number#65->[sr_ticket_number#87](ndv/size = 6530065/8388608) ] )
|                    |     |        |              |--PhysicalProject[167725]@3 ( stats=287,999,764, projects=[sr_item_sk#86, sr_ticket_number#87] )
|                    |     |        |              |  +--PhysicalOlapScan[store_returns]@2 ( stats=287,999,764, operativeSlots=[sr_item_sk#86, sr_ticket_number#87], virtualColumns=[], JRFs= RF14 RF15 )
|                    |     |        |              +--PhysicalProject[168195]@2668 ( stats=6,545,174.14, projects=[ss_item_sk#64, ss_ticket_number#65, ss_customer_sk#67, ss_addr_sk#70, ss_promo_sk#72, ss_wholesale_cost#74, ss_list_price#75, ss_coupon_amt#82, s_store_name#198, s_zip#218, i_item_sk#319, i_product_name#340, d_year#115, cd_marital_status#242] )
|                    |     |        |                 +--PhysicalHashJoin[168192]@2669 ( stats=6,545,174.14, type=INNER_JOIN, hashCondition=[(ss_cdemo_sk#68 = cd_demo_sk#240)], otherCondition=[], markCondition=[], RFs=[RF13[cd_demo_sk#240->[ss_cdemo_sk#68](ndv/size = 1916366/2097152) ] )
|                    |     |        |                    |--PhysicalHashJoin[168189]@2631 ( stats=6,530,065.17, type=INNER_JOIN, hashCondition=[(ss_item_sk#64 = i_item_sk#319)], otherCondition=[], markCondition=[], RFs=[RF12[i_item_sk#319->[ss_item_sk#64, cs_item_sk#405, cr_item_sk#438](ndv/size = 1673/2048) ] )
|                    |     |        |                    |  |--PhysicalProject[168186]@2163 ( stats=576,272,060.24, projects=[ss_item_sk#64, ss_ticket_number#65, ss_customer_sk#67, ss_cdemo_sk#68, ss_addr_sk#70, ss_promo_sk#72, ss_wholesale_cost#74, ss_list_price#75, ss_coupon_amt#82, d_year#115, s_store_name#198, s_zip#218] )
|                    |     |        |                    |  |  +--PhysicalHashJoin[168183]@2592 ( stats=576,272,060.24, type=INNER_JOIN, hashCondition=[(ss_store_sk#71 = s_store_sk#193)], otherCondition=[], markCondition=[], RFs=[RF11[s_store_sk#193->[ss_store_sk#71](ndv/size = 988/1024) ] )
|                    |     |        |                    |  |     |--PhysicalProject[168180]@2134 ( stats=568,220,354.81, projects=[ss_item_sk#64, ss_ticket_number#65, ss_customer_sk#67, ss_cdemo_sk#68, ss_addr_sk#70, ss_store_sk#71, ss_promo_sk#72, ss_wholesale_cost#74, ss_list_price#75, ss_coupon_amt#82, d_year#115] )
|                    |     |        |                    |  |     |  +--PhysicalHashJoin[168177]@2135 ( stats=568,220,354.81, type=INNER_JOIN, hashCondition=[(hd_income_band_sk#278 = ib_income_band_sk#313)], otherCondition=[], markCondition=[], RFs=[RF10[ib_income_band_sk#313->[hd_income_band_sk#278](ndv/size = 20/32) ] )
|                    |     |        |                    |  |     |     |--PhysicalProject[168174]@1396 ( stats=568,220,354.81, projects=[ss_item_sk#64, ss_ticket_number#65, ss_customer_sk#67, ss_cdemo_sk#68, ss_addr_sk#70, ss_store_sk#71, ss_promo_sk#72, ss_wholesale_cost#74, ss_list_price#75, ss_coupon_amt#82, d_year#115, hd_income_band_sk#278] )
|                    |     |        |                    |  |     |     |  +--PhysicalHashJoin[168171]@1397 ( stats=568,220,354.81, type=INNER_JOIN, hashCondition=[(ss_hdemo_sk#69 = hd_demo_sk#277)], otherCondition=[], markCondition=[], RFs=[RF9[hd_demo_sk#277->[ss_hdemo_sk#69](ndv/size = 7200/8192) ] )
|                    |     |        |                    |  |     |     |     |--PhysicalProject[168168]@909 ( stats=572,245,248.99, projects=[ss_item_sk#64, ss_ticket_number#65, ss_customer_sk#67, ss_cdemo_sk#68, ss_hdemo_sk#69, ss_addr_sk#70, ss_store_sk#71, ss_promo_sk#72, ss_wholesale_cost#74, ss_list_price#75, ss_coupon_amt#82, d_year#115] )
|                    |     |        |                    |  |     |     |     |  +--PhysicalHashJoin[168165]@1231 ( stats=572,245,248.99, type=INNER_JOIN, hashCondition=[(ss_item_sk#64 = cs_item_sk#106)], otherCondition=[], markCondition=[], RFs=[RF8[cs_item_sk#106->[ss_item_sk#64](ndv/size = 147716/131072) ] )
|                    |     |        |                    |  |     |     |     |     |--PhysicalProject[167751]@582 ( stats=1,144,490,497.98, projects=[ss_item_sk#64, ss_ticket_number#65, ss_customer_sk#67, ss_cdemo_sk#68, ss_hdemo_sk#69, ss_addr_sk#70, ss_store_sk#71, ss_promo_sk#72, ss_wholesale_cost#74, ss_list_price#75, ss_coupon_amt#82, d_year#115] )
|                    |     |        |                    |  |     |     |     |     |  +--PhysicalHashJoin[167747]@583 ( stats=1,144,490,497.98, type=INNER_JOIN, hashCondition=[(ss_sold_date_sk#63 = d_date_sk#109)], otherCondition=[], markCondition=[], RFs=[RF7[d_date_sk#109->[ss_sold_date_sk#63](ndv/size = 723/1024) ] )
|                    |     |        |                    |  |     |     |     |     |     |--PhysicalProject[167730]@1 ( stats=2,879,987,999, projects=[ss_sold_date_sk#63, ss_item_sk#64, ss_ticket_number#65, ss_customer_sk#67, ss_cdemo_sk#68, ss_hdemo_sk#69, ss_addr_sk#70, ss_store_sk#71, ss_promo_sk#72, ss_wholesale_cost#74, ss_list_price#75, ss_coupon_amt#82] )
|                    |     |        |                    |  |     |     |     |     |     |  +--PhysicalOlapScan[store_sales]@0 ( stats=2,879,987,999, operativeSlots=[ss_sold_date_sk#63, ss_item_sk#64, ss_ticket_number#65, ss_customer_sk#67, ss_cdemo_sk#68, ss_hdemo_sk#69, ss_addr_sk#70, ss_store_sk#71, ss_promo_sk#72, ss_wholesale_cost#74, ss_list_price#75, ss_coupon_amt#82], virtualColumns=[], JRFs= RF7 RF8 RF9 RF11 RF12 RF13 RF17 RF18 )
|                    |     |        |                    |  |     |     |     |     |     +--PhysicalDistribute[167743]@19 ( stats=723.26, distributionSpec=DistributionSpecReplicated )
|                    |     |        |                    |  |     |     |     |     |        +--PhysicalProject[167739]@19 ( stats=723.26, projects=[d_date_sk#109, d_year#115] )
|                    |     |        |                    |  |     |     |     |     |           +--PhysicalFilter[167735]@18 ( stats=723.26, predicates=d_year#115 IN (2000, 1999) )
|                    |     |        |                    |  |     |     |     |     |              +--PhysicalOlapScan[date_dim]@17 ( stats=73,049, operativeSlots=[d_date_sk#109, d_year#115], virtualColumns=[] )
|                    |     |        |                    |  |     |     |     |     +--PhysicalDistribute[168162]@14 ( stats=147,716.5, distributionSpec=DistributionSpecReplicated )
|                    |     |        |                    |  |     |     |     |        +--PhysicalProject[168159]@14 ( stats=147,716.5, projects=[cs_item_sk#405 AS `cs_item_sk`#106] )
|                    |     |        |                    |  |     |     |     |           +--PhysicalFilter[168156]@13 ( stats=147,716.5, predicates=(sale#465 > (2 * refund#466)) )
|                    |     |        |                    |  |     |     |     |              +--PhysicalHashAggregate[168153]@12 ( stats=295,433, aggPhase=GLOBAL, aggMode=BUFFER_TO_RESULT, maybeUseStreaming=false, groupByExpr=[cs_item_sk#405], outputExpr=[cs_item_sk#405, sum(partial_sum(cs_ext_list_price)#467) AS `sale`#465, sum(partial_sum((cast((cast(cr_refunded_cash as DECIMALV3(8, 2)) + cast(cr_reversed_charge as DECIMALV3(8, 2))) as DECIMALV3(9, 2)) + cast(cr_store_credit as DECIMALV3(9, 2))))#468) AS `refund`#466], partitionExpr=Optional.empty, topnFilter=false, topnPushDown=false )
|                    |     |        |                    |  |     |     |     |                 +--PhysicalDistribute[168150]@586 ( stats=295,433, distributionSpec=DistributionSpecHash ( orderedShuffledColumns=[405], shuffleType=EXECUTION_BUCKETED, tableId=-1, selectedIndexId=-1, partitionIds=[], equivalenceExprIds=[[405]], exprIdToEquivalenceSet={405=0} ) )
|                    |     |        |                    |  |     |     |     |                    +--PhysicalHashAggregate[168147]@ ( stats=295,433, aggPhase=LOCAL, aggMode=INPUT_TO_BUFFER, maybeUseStreaming=true, groupByExpr=[cs_item_sk#405], outputExpr=[cs_item_sk#405, partial_sum(cs_ext_list_price#429) AS `partial_sum(cs_ext_list_price)`#467, partial_sum((cast((cast(cr_refunded_cash as DECIMALV3(8, 2)) + cast(cr_reversed_charge as DECIMALV3(8, 2))) as DECIMALV3(9, 2)) + cast(cr_store_credit as DECIMALV3(9, 2)))#473) AS `partial_sum((cast((cast(cr_refunded_cash as DECIMALV3(8, 2)) + cast(cr_reversed_charge as DECIMALV3(8, 2))) as DECIMALV3(9, 2)) + cast(cr_store_credit as DECIMALV3(9, 2))))`#468], partitionExpr=Optional.empty, topnFilter=false, topnPushDown=false )
|                    |     |        |                    |  |     |     |     |                       +--PhysicalProject[168145]@11 ( stats=1,303,678,910.39, projects=[cs_item_sk#405, cs_ext_list_price#429, (cast((cast(cr_refunded_cash#461 as DECIMALV3(8, 2)) + cast(cr_reversed_charge#462 as DECIMALV3(8, 2))) as DECIMALV3(9, 2)) + cast(cr_store_credit#463 as DECIMALV3(9, 2))) AS `(cast((cast(cr_refunded_cash as DECIMALV3(8, 2)) + cast(cr_reversed_charge as DECIMALV3(8, 2))) as DECIMALV3(9, 2)) + cast(cr_store_credit as DECIMALV3(9, 2)))`#473] )
|                    |     |        |                    |  |     |     |     |                          +--PhysicalHashJoin[167765]@10 ( stats=1,303,678,910.39, type=INNER_JOIN, hashCondition=[(cs_item_sk#405 = cr_item_sk#438), (cs_order_number#406 = cr_order_number#439)], otherCondition=[], markCondition=[], RFs=[RF5[cr_item_sk#438->[cs_item_sk#405](ndv/size = 295433/262144) , RF6[cr_order_number#439->[cs_order_number#406](ndv/size = 93476424/134217728) ] )
|                    |     |        |                    |  |     |     |     |                             |--PhysicalProject[167756]@7 ( stats=1,439,980,416, projects=[cs_item_sk#405, cs_order_number#406, cs_ext_list_price#429] )
|                    |     |        |                    |  |     |     |     |                             |  +--PhysicalOlapScan[catalog_sales]@6 ( stats=1,439,980,416, operativeSlots=[cs_item_sk#405, cs_order_number#406, cs_ext_list_price#429], virtualColumns=[], JRFs= RF5 RF6 RF12 )
|                    |     |        |                    |  |     |     |     |                             +--PhysicalProject[167761]@9 ( stats=143,996,756, projects=[cr_item_sk#438, cr_order_number#439, cr_refunded_cash#461, cr_reversed_charge#462, cr_store_credit#463] )
|                    |     |        |                    |  |     |     |     |                                +--PhysicalOlapScan[catalog_returns]@8 ( stats=143,996,756, operativeSlots=[cr_item_sk#438, cr_order_number#439, cr_refunded_cash#461, cr_reversed_charge#462, cr_store_credit#463], virtualColumns=[], JRFs= RF12 )
|                    |     |        |                    |  |     |     |     +--PhysicalDistribute[167810]@51 ( stats=7,200, distributionSpec=DistributionSpecReplicated )
|                    |     |        |                    |  |     |     |        +--PhysicalProject[167806]@51 ( stats=7,200, projects=[hd_demo_sk#277, hd_income_band_sk#278] )
|                    |     |        |                    |  |     |     |           +--PhysicalOlapScan[household_demographics]@50 ( stats=7,200, operativeSlots=[hd_demo_sk#277, hd_income_band_sk#278], virtualColumns=[], JRFs= RF10 )
|                    |     |        |                    |  |     |     +--PhysicalDistribute[167827]@67 ( stats=20, distributionSpec=DistributionSpecReplicated )
|                    |     |        |                    |  |     |        +--PhysicalProject[167823]@67 ( stats=20, projects=[ib_income_band_sk#313] )
|                    |     |        |                    |  |     |           +--PhysicalOlapScan[income_band]@66 ( stats=20, operativeSlots=[ib_income_band_sk#313], virtualColumns=[] )
|                    |     |        |                    |  |     +--PhysicalDistribute[167844]@23 ( stats=1,002, distributionSpec=DistributionSpecReplicated )
|                    |     |        |                    |  |        +--PhysicalProject[167840]@23 ( stats=1,002, projects=[s_store_sk#193, s_store_name#198, s_zip#218] )
|                    |     |        |                    |  |           +--PhysicalOlapScan[store]@22 ( stats=1,002, operativeSlots=[s_store_sk#193, s_store_name#198, s_zip#218], virtualColumns=[] )
|                    |     |        |                    |  +--PhysicalDistribute[167865]@76 ( stats=1,673.86, distributionSpec=DistributionSpecReplicated )
|                    |     |        |                    |     +--PhysicalProject[167861]@76 ( stats=1,673.86, projects=[i_item_sk#319, i_product_name#340] )
|                    |     |        |                    |        +--PhysicalFilter[167857]@75 ( stats=1,673.86, predicates=AND[i_color#336 IN ('orange', 'lace', 'lawn', 'misty', 'blush', 'pink'),(i_current_price#324 >= 49.00),(i_current_price#324 <= 58.00)] )
|                    |     |        |                    |           +--PhysicalOlapScan[item]@74 ( stats=300,000, operativeSlots=[i_item_sk#319, i_current_price#324, i_color#336, i_product_name#340], virtualColumns=[] )
|                    |     |        |                    +--PhysicalDistribute[167878]@39 ( stats=1,920,800, distributionSpec=DistributionSpecReplicated )
|                    |     |        |                       +--PhysicalProject[167874]@39 ( stats=1,920,800, projects=[cd_demo_sk#240, cd_marital_status#242] )
|                    |     |        |                          +--PhysicalOlapScan[customer_demographics]@38 ( stats=1,920,800, operativeSlots=[cd_demo_sk#240, cd_marital_status#242], virtualColumns=[] )
|                    |     |        +--PhysicalDistribute[167915]@47 ( stats=1,500, distributionSpec=DistributionSpecReplicated )
|                    |     |           +--PhysicalProject[167911]@47 ( stats=1,500, projects=[p_promo_sk#258] )
|                    |     |              +--PhysicalOlapScan[promotion]@46 ( stats=1,500, operativeSlots=[p_promo_sk#258], virtualColumns=[] )
|                    |     +--PhysicalDistribute[168021]@262 ( stats=11,944,312.19, distributionSpec=DistributionSpecHash ( orderedShuffledColumns=[222], shuffleType=EXECUTION_BUCKETED, tableId=-1, selectedIndexId=-1, partitionIds=[], equivalenceExprIds=[[222]], exprIdToEquivalenceSet={222=0} ) )
|                    |        +--PhysicalProject[168017]@262 ( stats=11,944,312.19, projects=[c_customer_sk#222, c_first_shipto_date_sk#227, d_year#143, cd_marital_status#251, ca_street_number#302, ca_street_name#303, ca_city#306, ca_zip#309] )
|                    |           +--PhysicalHashJoin[168013]@358 ( stats=11,944,312.19, type=INNER_JOIN, hashCondition=[(c_current_addr_sk#226 = ca_address_sk#300)], otherCondition=[], markCondition=[], RFs=[RF4[c_current_addr_sk#226->[ca_address_sk#300](ndv/size = 5243359/8388608) ] )
|                    |              |--PhysicalProject[167932]@63 ( stats=6,000,000, projects=[ca_address_sk#300, ca_street_number#302, ca_street_name#303, ca_city#306, ca_zip#309] )
|                    |              |  +--PhysicalOlapScan[customer_address]@62 ( stats=6,000,000, operativeSlots=[ca_address_sk#300, ca_street_number#302, ca_street_name#303, ca_city#306, ca_zip#309], virtualColumns=[], JRFs= RF4 )
|                    |              +--PhysicalDistribute[168009]@160 ( stats=11,944,312.19, distributionSpec=DistributionSpecHash ( orderedShuffledColumns=[226], shuffleType=STORAGE_BUCKETED, tableId=-1, selectedIndexId=-1, partitionIds=[], equivalenceExprIds=[[226]], exprIdToEquivalenceSet={226=0} ) )
|                    |                 +--PhysicalProject[168005]@160 ( stats=11,944,312.19, projects=[c_customer_sk#222, c_current_addr_sk#226, c_first_shipto_date_sk#227, d_year#143, cd_marital_status#251] )
|                    |                    +--PhysicalHashJoin[168001]@333 ( stats=11,944,312.19, type=INNER_JOIN, hashCondition=[(c_current_cdemo_sk#224 = cd_demo_sk#249)], otherCondition=[], markCondition=[], RFs=[RF3[cd_demo_sk#249->[c_current_cdemo_sk#224](ndv/size = 1916366/2097152) ] )
|                    |                       |--PhysicalProject[167988]@118 ( stats=11,916,739.78, projects=[c_customer_sk#222, c_current_cdemo_sk#224, c_current_addr_sk#226, c_first_shipto_date_sk#227, d_year#143] )
|                    |                       |  +--PhysicalHashJoin[167984]@331 ( stats=11,916,739.78, type=INNER_JOIN, hashCondition=[(c_first_sales_date_sk#228 = d_date_sk#137)], otherCondition=[], markCondition=[], RFs=[RF2[d_date_sk#137->[c_first_sales_date_sk#228](ndv/size = 73042/65536) ] )
|                    |                       |     |--PhysicalProject[167971]@104 ( stats=11,915,597.85, projects=[c_customer_sk#222, c_current_cdemo_sk#224, c_current_addr_sk#226, c_first_shipto_date_sk#227, c_first_sales_date_sk#228] )
|                    |                       |     |  +--PhysicalHashJoin[167967]@105 ( stats=11,915,597.85, type=INNER_JOIN, hashCondition=[(c_current_hdemo_sk#225 = hd_demo_sk#282)], otherCondition=[], markCondition=[], RFs=[RF1[hd_demo_sk#282->[c_current_hdemo_sk#225](ndv/size = 7200/8192) ] )
|                    |                       |     |     |--PhysicalProject[167937]@27 ( stats=12,000,000, projects=[c_customer_sk#222, c_current_cdemo_sk#224, c_current_hdemo_sk#225, c_current_addr_sk#226, c_first_shipto_date_sk#227, c_first_sales_date_sk#228] )
|                    |                       |     |     |  +--PhysicalOlapScan[customer]@26 ( stats=12,000,000, operativeSlots=[c_customer_sk#222, c_current_cdemo_sk#224, c_current_hdemo_sk#225, c_current_addr_sk#226, c_first_shipto_date_sk#227, c_first_sales_date_sk#228], virtualColumns=[], JRFs= RF1 RF2 RF3 RF19 )
|                    |                       |     |     +--PhysicalDistribute[167963]@94 ( stats=7,200, distributionSpec=DistributionSpecReplicated )
|                    |                       |     |        +--PhysicalProject[167959]@94 ( stats=7,200, projects=[hd_demo_sk#282] )
|                    |                       |     |           +--PhysicalHashJoin[167955]@95 ( stats=7,200, type=INNER_JOIN, hashCondition=[(hd_income_band_sk#283 = ib_income_band_sk#316)], otherCondition=[], markCondition=[], RFs=[RF0[ib_income_band_sk#316->[hd_income_band_sk#283](ndv/size = 20/32) ] )
|                    |                       |     |              |--PhysicalProject[167942]@55 ( stats=7,200, projects=[hd_demo_sk#282, hd_income_band_sk#283] )
|                    |                       |     |              |  +--PhysicalOlapScan[household_demographics]@54 ( stats=7,200, operativeSlots=[hd_demo_sk#282, hd_income_band_sk#283], virtualColumns=[], JRFs= RF0 )
|                    |                       |     |              +--PhysicalDistribute[167951]@71 ( stats=20, distributionSpec=DistributionSpecReplicated )
|                    |                       |     |                 +--PhysicalProject[167947]@71 ( stats=20, projects=[ib_income_band_sk#316] )
|                    |                       |     |                    +--PhysicalOlapScan[income_band]@70 ( stats=20, operativeSlots=[ib_income_band_sk#316], virtualColumns=[] )
|                    |                       |     +--PhysicalDistribute[167980]@31 ( stats=73,049, distributionSpec=DistributionSpecReplicated )
|                    |                       |        +--PhysicalProject[167976]@31 ( stats=73,049, projects=[d_date_sk#137, d_year#143] )
|                    |                       |           +--PhysicalOlapScan[date_dim]@30 ( stats=73,049, operativeSlots=[d_date_sk#137, d_year#143], virtualColumns=[] )
|                    |                       +--PhysicalDistribute[167997]@43 ( stats=1,920,800, distributionSpec=DistributionSpecReplicated )
|                    |                          +--PhysicalProject[167993]@43 ( stats=1,920,800, projects=[cd_demo_sk#249, cd_marital_status#251] )
|                    |                             +--PhysicalOlapScan[customer_demographics]@42 ( stats=1,920,800, operativeSlots=[cd_demo_sk#249, cd_marital_status#251], virtualColumns=[] )
|                    +--PhysicalDistribute[168038]@35 ( stats=73,049, distributionSpec=DistributionSpecReplicated )
|                       +--PhysicalProject[168034]@35 ( stats=73,049, projects=[d_date_sk#165, d_year#171] )
|                          +--PhysicalOlapScan[date_dim]@34 ( stats=73,049, operativeSlots=[d_date_sk#165, d_year#171], virtualColumns=[] )
+--PhysicalResultSink[168120] ( outputExprs=[product_name#360, store_name#362, store_zip#363, b_street_number#364, b_street_name#365, b_city#366, b_zip#367, c_street_number#368, c_street_name#369, c_city#370, c_zip#371, syear#372, cnt#375, s11#398, s21#399, s31#400, s12#401, s22#402, s32#403, syear#391, cnt#394] )
   +--PhysicalQuickSort[168116]@90 ( stats=2,901,642,489.25, orderKeys=[product_name#360 asc null first, store_name#362 asc null first, cnt#394 asc null first, s11#398 asc null first, s12#401 asc null first], phase=MERGE_SORT )
      +--PhysicalDistribute[168112]@3035 ( stats=2,901,642,489.25, distributionSpec=DistributionSpecGather )
         +--PhysicalQuickSort[168108]@3035 ( stats=2,901,642,489.25, orderKeys=[product_name#360 asc null first, store_name#362 asc null first, cnt#394 asc null first, s11#398 asc null first, s12#401 asc null first], phase=LOCAL_SORT )
            +--PhysicalProject[168104]@89 ( stats=2,901,642,489.25, projects=[product_name#360, store_name#362, store_zip#363, b_street_number#364, b_street_name#365, b_city#366, b_zip#367, c_street_number#368, c_street_name#369, c_city#370, c_zip#371, syear#372, cnt#375, s11#398, s21#399, s31#400, s12#401, s22#402, s32#403, syear#391, cnt#394] )
               +--PhysicalHashJoin[168100]@88 ( stats=2,901,642,489.25, type=INNER_JOIN, hashCondition=[(item_sk#361 = item_sk#380), (store_name#362 = store_name#381), (store_zip#363 = store_zip#382)], otherCondition=[(cnt#394 <= cnt#375)], markCondition=[], RFs=[RF20[item_sk#380->[item_sk#361](ndv/size = 1673/2048) , RF21[store_name#381->[store_name#362](ndv/size = 11/16) , RF22[store_zip#382->[store_zip#363](ndv/size = 354/512) ] )
                  |--PhysicalDistribute[168083]@84 ( stats=3,116,710.25, distributionSpec=DistributionSpecHash ( orderedShuffledColumns=[361, 362, 363], shuffleType=EXECUTION_BUCKETED, tableId=-1, selectedIndexId=-1, partitionIds=[], equivalenceExprIds=[[361], [362], [363]], exprIdToEquivalenceSet={361=0, 362=1, 363=2} ) )
                  |  +--PhysicalProject[168079]@84 ( stats=3,116,710.25, projects=[product_name#360, item_sk#361, store_name#362, store_zip#363, b_street_number#364, b_street_name#365, b_city#366, b_zip#367, c_street_number#368, c_street_name#369, c_city#370, c_zip#371, syear#372, cnt#375, s1#376 AS `s11`#398, s2#377 AS `s21`#399, s3#378 AS `s31`#400] )
                  |     +--PhysicalFilter[168075]@83 ( stats=3,116,710.25, predicates=(syear#372 = 1999) )
                  |        +--PhysicalCTEConsumer[168071] ( stats=6,233,420.5, cteId=CTEId#1, RFs= RF20 RF21 RF22, map={product_name#360=product_name#341, item_sk#361=item_sk#342, store_name#362=store_name#343, store_zip#363=store_zip#344, b_street_number#364=b_street_number#345, b_street_name#365=b_street_name#346, b_city#366=b_city#347, b_zip#367=b_zip#348, c_street_number#368=c_street_number#349, c_street_name#369=c_street_name#350, c_city#370=c_city#351, c_zip#371=c_zip#352, syear#372=syear#353, cnt#375=cnt#356, s1#376=s1#357, s2#377=s2#358, s3#378=s3#359} )
                  +--PhysicalDistribute[168096]@87 ( stats=3,116,710.25, distributionSpec=DistributionSpecHash ( orderedShuffledColumns=[380, 381, 382], shuffleType=EXECUTION_BUCKETED, tableId=-1, selectedIndexId=-1, partitionIds=[], equivalenceExprIds=[[380], [381], [382]], exprIdToEquivalenceSet={380=0, 381=1, 382=2} ) )
                     +--PhysicalProject[168092]@87 ( stats=3,116,710.25, projects=[item_sk#380, store_name#381, store_zip#382, syear#391, cnt#394, s1#395 AS `s12`#401, s2#396 AS `s22`#402, s3#397 AS `s32`#403] )
                        +--PhysicalFilter[168088]@86 ( stats=3,116,710.25, predicates=(syear#391 = 2000) )
                           +--PhysicalCTEConsumer[168084] ( stats=6,233,420.5, cteId=CTEId#1, map={item_sk#380=item_sk#342, store_name#381=store_name#343, store_zip#382=store_zip#344, syear#391=syear#353, cnt#394=cnt#356, s1#395=s1#357, s2#396=s2#358, s3#397=s3#359} )


 group expression count exceeds memo_max_group_expression_size(10000)

