-- This file is automatically generated. You should know what you did if you want to edit this
-- !ds_shape_2 --
PhysicalCteAnchor ( cteId=CTEId#1 )
--PhysicalCteProducer ( cteId=CTEId#1 )
----hashAgg[GLOBAL]
------PhysicalDistribute[DistributionSpecHash]
--------hashAgg[LOCAL]
----------PhysicalProject
------------hashJoin[INNER_JOIN broadcast] hashCondition=((date_dim.d_date_sk = wscs.sold_date_sk)) otherCondition=()
--------------PhysicalUnion
----------------PhysicalDistribute[DistributionSpecHash]
------------------PhysicalProject
--------------------PhysicalOlapScan[web_sales]
----------------PhysicalDistribute[DistributionSpecHash]
------------------PhysicalProject
--------------------PhysicalOlapScan[catalog_sales]
--------------PhysicalProject
----------------PhysicalOlapScan[date_dim]
--PhysicalResultSink
----PhysicalQuickSort[MERGE_SORT]
------PhysicalDistribute[DistributionSpecGather]
--------PhysicalQuickSort[LOCAL_SORT]
----------PhysicalProject
------------hashJoin[INNER_JOIN broadcast] hashCondition=((date_dim.d_week_seq = d_week_seq1)) otherCondition=() build RFs:RF2 d_week_seq->[d_week_seq]
--------------PhysicalProject
----------------hashJoin[INNER_JOIN shuffle] hashCondition=((expr_cast(d_week_seq1 as BIGINT) = expr_(d_week_seq2 - 53))) otherCondition=()
------------------PhysicalProject
--------------------hashJoin[INNER_JOIN shuffle] hashCondition=((date_dim.d_week_seq = d_week_seq2)) otherCondition=() build RFs:RF1 d_week_seq->[d_week_seq]
----------------------PhysicalProject
------------------------PhysicalCteConsumer ( cteId=CTEId#1 ) apply RFs: RF1
----------------------PhysicalProject
------------------------filter((date_dim.d_year = 1999))
--------------------------PhysicalOlapScan[date_dim]
------------------PhysicalProject
--------------------PhysicalCteConsumer ( cteId=CTEId#1 ) apply RFs: RF2
--------------PhysicalProject
----------------filter((date_dim.d_year = 1998))
------------------PhysicalOlapScan[date_dim]

