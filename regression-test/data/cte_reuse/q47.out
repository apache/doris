-- This file is automatically generated. You should know what you did if you want to edit this
-- !sql --
CteAnchor[cteId= ( CTEId#0=] )
--CteProducer[cteId= ( CTEId#0=] )
----PhysicalProject
------PhysicalWindow
--------PhysicalQuickSort
----------PhysicalDistribute
------------PhysicalWindow
--------------PhysicalQuickSort
----------------PhysicalDistribute
------------------PhysicalProject
--------------------hashAgg[GLOBAL]
----------------------PhysicalDistribute
------------------------hashAgg[LOCAL]
--------------------------PhysicalProject
----------------------------hashJoin[INNER_JOIN](store_sales.ss_store_sk = store.s_store_sk)
------------------------------PhysicalProject
--------------------------------hashJoin[INNER_JOIN](store_sales.ss_item_sk = item.i_item_sk)
----------------------------------hashJoin[INNER_JOIN](store_sales.ss_sold_date_sk = date_dim.d_date_sk)
------------------------------------PhysicalProject
--------------------------------------PhysicalOlapScan[store_sales]
------------------------------------PhysicalDistribute
--------------------------------------PhysicalProject
----------------------------------------filter((((date_dim.d_year = 1999) OR ((date_dim.d_year = 1998) AND (date_dim.d_moy = 12))) OR ((date_dim.d_year = 2000) AND (date_dim.d_moy = 1))))
------------------------------------------PhysicalOlapScan[date_dim]
----------------------------------PhysicalDistribute
------------------------------------PhysicalProject
--------------------------------------PhysicalOlapScan[item]
------------------------------PhysicalDistribute
--------------------------------PhysicalProject
----------------------------------PhysicalOlapScan[store]
--PhysicalProject
----PhysicalTopN
------PhysicalDistribute
--------PhysicalTopN
----------PhysicalProject
------------hashJoin[INNER_JOIN](i_category = v1_lag.i_category)(i_brand = v1_lag.i_brand)(s_store_name = v1_lag.s_store_name)(s_company_name = v1_lag.s_company_name)(v1.rn = expr_(rn + 1))
--------------PhysicalProject
----------------CteConsumer[cteId= ( CTEId#0=] )
--------------PhysicalDistribute
----------------hashJoin[INNER_JOIN](i_category = v1_lead.i_category)(i_brand = v1_lead.i_brand)(s_store_name = v1_lead.s_store_name)(s_company_name = v1_lead.s_company_name)(v1.rn = expr_(rn - 1))
------------------PhysicalProject
--------------------CteConsumer[cteId= ( CTEId#0=] )
------------------PhysicalDistribute
--------------------PhysicalProject
----------------------filter((CASE WHEN (avg_monthly_sales > 0.0000) THEN (abs((cast(sum_sales as DOUBLE) - cast(avg_monthly_sales as DOUBLE))) / cast(avg_monthly_sales as DOUBLE)) ELSE NULL END > 0.1)(v2.d_year = 1999)(v2.avg_monthly_sales > 0.0000))
------------------------CteConsumer[cteId= ( CTEId#0=] )

