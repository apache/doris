-- This file is automatically generated. You should know what you did if you want to edit this
-- !case_when_one_side_1 --
PhysicalResultSink
--PhysicalProject[t1.a, t2.x]
----NestedLoopJoin[INNER_JOIN]( not (CASE WHEN (x > 10) THEN a WHEN (y > 10) THEN (a + b) END = 95))
------PhysicalProject[(a + b) AS `(a + b)`, t1.a]
--------filter(OR[( not (a = 95)),( not ((a + b) = 95))])
----------PhysicalOlapScan[tbl_join_extract_or_from_case_when_1(t1)]
------PhysicalProject[(x > 10) AS `(x > 10)`, (y > 10) AS `(y > 10)`, t2.x]
--------PhysicalOlapScan[tbl_join_extract_or_from_case_when_2(t2)]

-- !case_when_one_side_2 --
PhysicalResultSink
--PhysicalProject[t1.a, t2.x]
----NestedLoopJoin[INNER_JOIN]( not (CASE WHEN (x > 10) THEN a WHEN (y > 10) THEN (a + b) END = ((a - b) - 5)))
------PhysicalProject[((a - b) - 5) AS `((a - b) - 5)`, (a + b) AS `(a + b)`, t1.a]
--------filter(OR[( not (a = ((a - b) - 5))),( not ((a + b) = ((a - b) - 5)))])
----------PhysicalOlapScan[tbl_join_extract_or_from_case_when_1(t1)]
------PhysicalProject[(x > 10) AS `(x > 10)`, (y > 10) AS `(y > 10)`, t2.x]
--------PhysicalOlapScan[tbl_join_extract_or_from_case_when_2(t2)]

-- !case_when_one_side_3 --
PhysicalResultSink
--PhysicalProject[t1.a, t2.x]
----NestedLoopJoin[INNER_JOIN]( not (CASE WHEN (x > 10) THEN a WHEN (y > 10) THEN (a + b) ELSE b END = 95))
------PhysicalProject[(a + b) AS `(a + b)`, t1.a, t1.b]
--------filter(OR[( not (a = 95)),( not ((a + b) = 95)),( not (b = 95))])
----------PhysicalOlapScan[tbl_join_extract_or_from_case_when_1(t1)]
------PhysicalProject[(x > 10) AS `(x > 10)`, (y > 10) AS `(y > 10)`, t2.x]
--------PhysicalOlapScan[tbl_join_extract_or_from_case_when_2(t2)]

-- !case_when_one_side_4 --
PhysicalResultSink
--PhysicalProject[t1.a, t2.x]
----NestedLoopJoin[INNER_JOIN]( not (CASE WHEN (x > 10) THEN a WHEN (y > 10) THEN (a + b) ELSE b END = ((a - b) - 5)))
------PhysicalProject[((a - b) - 5) AS `((a - b) - 5)`, (a + b) AS `(a + b)`, t1.a, t1.b]
--------filter(OR[( not (a = ((a - b) - 5))),( not ((a + b) = ((a - b) - 5))),( not (b = ((a - b) - 5)))])
----------PhysicalOlapScan[tbl_join_extract_or_from_case_when_1(t1)]
------PhysicalProject[(x > 10) AS `(x > 10)`, (y > 10) AS `(y > 10)`, t2.x]
--------PhysicalOlapScan[tbl_join_extract_or_from_case_when_2(t2)]

-- !case_when_one_side_5 --
PhysicalResultSink
--PhysicalProject[t1.a, t2.x]
----NestedLoopJoin[INNER_JOIN]((CASE WHEN (x > 10) THEN a WHEN (y > 10) THEN (a + b) ELSE b END + random(1, 100)) = (a - b))
------PhysicalProject[(a + b) AS `(a + b)`, (a - b) AS `(a - b)`, t1.a, t1.b]
--------PhysicalOlapScan[tbl_join_extract_or_from_case_when_1(t1)]
------PhysicalProject[(x > 10) AS `(x > 10)`, (y > 10) AS `(y > 10)`, t2.x]
--------PhysicalOlapScan[tbl_join_extract_or_from_case_when_2(t2)]

-- !case_when_one_side_6 --
PhysicalResultSink
--NestedLoopJoin[CROSS_JOIN]
----PhysicalProject[t1.a]
------filter(( not (CASE WHEN (a > 10) THEN a WHEN (b > 10) THEN (a + b) END = 95)))
--------PhysicalOlapScan[tbl_join_extract_or_from_case_when_1(t1)]
----PhysicalProject[t2.x]
------PhysicalOlapScan[tbl_join_extract_or_from_case_when_2(t2)]

-- !case_when_one_side_7 --
PhysicalResultSink
--PhysicalProject[t1.a, t2.x]
----NestedLoopJoin[INNER_JOIN]((CASE WHEN (x > 0) THEN a WHEN (x < 10) THEN (a + 1) END + CASE WHEN (x > 1) THEN (a + 1) WHEN (x < 10) THEN (a + 10) END) > (a + b))
------PhysicalProject[(a + 1) AS `(a + 1)`, (a + 10) AS `(a + 10)`, (a + b) AS `(a + b)`, t1.a]
--------PhysicalOlapScan[tbl_join_extract_or_from_case_when_1(t1)]
------PhysicalProject[(x < 10) AS `(x < 10)`, (x > 0) AS `(x > 0)`, (x > 1) AS `(x > 1)`, t2.x]
--------PhysicalOlapScan[tbl_join_extract_or_from_case_when_2(t2)]

-- !case_when_one_side_8 --
PhysicalResultSink
--PhysicalProject[t1.a, t2.x]
----NestedLoopJoin[INNER_JOIN]((CASE WHEN (x > 0) THEN a WHEN (x < 10) THEN (a + 1) END + CASE WHEN (a > 1) THEN (a + 1) WHEN (a < 10) THEN (a + 10) END) > (a + b))
------PhysicalProject[(a + 1) AS `(a + 1)`, (a + b) AS `(a + b)`, CASE WHEN (a > 1) THEN (a + 1) WHEN (a < 10) THEN (a + 10) END AS `CASE WHEN (a > 1) THEN (a + 1) WHEN (a < 10) THEN (a + 10) END`, t1.a]
--------filter(OR[((t1.a + CASE WHEN (a > 1) THEN (a + 1) WHEN (a < 10) THEN (a + 10) END) > (t1.a + t1.b)),((t1.a + CASE WHEN (a > 1) THEN (a + 1) WHEN (a < 10) THEN (a + 10) END) > ((t1.a + t1.b) - 1))])
----------PhysicalOlapScan[tbl_join_extract_or_from_case_when_1(t1)]
------PhysicalProject[(x < 10) AS `(x < 10)`, (x > 0) AS `(x > 0)`, t2.x]
--------PhysicalOlapScan[tbl_join_extract_or_from_case_when_2(t2)]

-- !case_when_one_side_9 --
PhysicalResultSink
--PhysicalProject[t1.a, t2.x]
----NestedLoopJoin[INNER_JOIN](CASE WHEN (x > 0) THEN 105 WHEN (x < 10) THEN 10005 ELSE NULL END > (a + b))
------PhysicalProject[(a + b) AS `(a + b)`, t1.a]
--------filter(((t1.a + t1.b) < 10005))
----------PhysicalOlapScan[tbl_join_extract_or_from_case_when_1(t1)]
------PhysicalProject[CASE WHEN (x > 0) THEN 105 WHEN (x < 10) THEN 10005 ELSE NULL END AS `CASE WHEN (x > 0) THEN 105 WHEN (x < 10) THEN 10005 ELSE NULL END`, t2.x]
--------PhysicalOlapScan[tbl_join_extract_or_from_case_when_2(t2)]

-- !case_when_one_side_10 --
PhysicalResultSink
--PhysicalProject[t1.a, t2.x]
----NestedLoopJoin[LEFT_OUTER_JOIN](CASE WHEN (x > 0) THEN 105 WHEN (x < 10) THEN 10005 ELSE NULL END > (a + b))
------PhysicalProject[(a + b) AS `(a + b)`, t1.a]
--------PhysicalOlapScan[tbl_join_extract_or_from_case_when_1(t1)]
------PhysicalProject[CASE WHEN (x > 0) THEN 105 WHEN (x < 10) THEN 10005 ELSE NULL END AS `CASE WHEN (x > 0) THEN 105 WHEN (x < 10) THEN 10005 ELSE NULL END`, t2.x]
--------PhysicalOlapScan[tbl_join_extract_or_from_case_when_2(t2)]

-- !case_when_one_side_11 --
PhysicalResultSink
--PhysicalProject[t1.a, t2.x]
----NestedLoopJoin[RIGHT_OUTER_JOIN](CASE WHEN (a > 0) THEN 105 WHEN (b < 10) THEN 10005 ELSE NULL END > (x + y))
------PhysicalProject[CASE WHEN (a > 0) THEN 105 WHEN (b < 10) THEN 10005 ELSE NULL END AS `CASE WHEN (a > 0) THEN 105 WHEN (b < 10) THEN 10005 ELSE NULL END`, t1.a]
--------PhysicalOlapScan[tbl_join_extract_or_from_case_when_1(t1)]
------PhysicalProject[(x + y) AS `(x + y)`, t2.x]
--------PhysicalOlapScan[tbl_join_extract_or_from_case_when_2(t2)]

-- !hash_cond_for_one_side_1 --
PhysicalResultSink
--PhysicalProject[t1.a, t2.x]
----hashJoin[INNER_JOIN] hashCondition=((expr_if((a > 1), 1, 100) = expr_if((x > 2), 1, 200))) otherCondition=()
------PhysicalProject[if((a > 1), 1, 100) AS `expr_if((a > 1), 1, 100)`, t1.a]
--------filter((t1.a > 1))
----------PhysicalOlapScan[tbl_join_extract_or_from_case_when_1(t1)]
------PhysicalProject[if((x > 2), 1, 200) AS `expr_if((x > 2), 1, 200)`, t2.x]
--------filter((t2.x > 2))
----------PhysicalOlapScan[tbl_join_extract_or_from_case_when_2(t2)]

-- !case_when_two_side_1 --
PhysicalCteAnchor ( cteId=CTEId#0 )
--PhysicalCteProducer ( cteId=CTEId#0 )
----PhysicalProject[(a + b) AS `(a + b)`, t1.a, t1.b]
------PhysicalOlapScan[tbl_join_extract_or_from_case_when_1(t1)]
--PhysicalCteAnchor ( cteId=CTEId#1 )
----PhysicalCteProducer ( cteId=CTEId#1 )
------PhysicalProject[((x + y) + -4) AS `((x + y) + -4)`, (x > 10) AS `(x > 10)`, (y > 10) AS `(y > 10)`, t2.x]
--------PhysicalOlapScan[tbl_join_extract_or_from_case_when_2(t2)]
----PhysicalResultSink
------PhysicalUnion
--------PhysicalProject[.a, .x]
----------hashJoin[INNER_JOIN] hashCondition=((.a = .((x + y) + -4))) otherCondition=((CASE WHEN (x > 10) THEN a WHEN (y > 10) THEN (a + b) ELSE b END = .((x + y) + -4)))
------------PhysicalCteConsumer ( cteId=CTEId#0 )
------------PhysicalCteConsumer ( cteId=CTEId#1 )
--------PhysicalProject[.a, .x]
----------hashJoin[INNER_JOIN] hashCondition=((.(a + b) = .((x + y) + -4))) otherCondition=((CASE WHEN (x > 10) THEN a WHEN (y > 10) THEN (a + b) ELSE b END = .((x + y) + -4)) and OR[( not (a = ((x + y) + -4))),(a = ((x + y) + -4)) IS NULL])
------------PhysicalCteConsumer ( cteId=CTEId#0 )
------------PhysicalCteConsumer ( cteId=CTEId#1 )
--------PhysicalProject[.a, .x]
----------hashJoin[INNER_JOIN] hashCondition=((.b = .((x + y) + -4))) otherCondition=((CASE WHEN (x > 10) THEN a WHEN (y > 10) THEN (a + b) ELSE b END = .((x + y) + -4)) and OR[( not ((a + b) = ((x + y) + -4))),((a + b) = ((x + y) + -4)) IS NULL] and OR[( not (a = ((x + y) + -4))),(a = ((x + y) + -4)) IS NULL])
------------PhysicalCteConsumer ( cteId=CTEId#0 )
------------PhysicalCteConsumer ( cteId=CTEId#1 )

-- !case_when_two_side_2 --
PhysicalCteAnchor ( cteId=CTEId#0 )
--PhysicalCteProducer ( cteId=CTEId#0 )
----PhysicalProject[(a + b) AS `(a + b)`, t1.a]
------PhysicalOlapScan[tbl_join_extract_or_from_case_when_1(t1)]
--PhysicalCteAnchor ( cteId=CTEId#1 )
----PhysicalCteProducer ( cteId=CTEId#1 )
------PhysicalProject[((x + y) + -4) AS `((x + y) + -4)`, (x > 10) AS `(x > 10)`, (y > 10) AS `(y > 10)`, t2.x]
--------PhysicalOlapScan[tbl_join_extract_or_from_case_when_2(t2)]
----PhysicalResultSink
------PhysicalUnion
--------PhysicalProject[.a, .x]
----------hashJoin[INNER_JOIN] hashCondition=((.a = .((x + y) + -4))) otherCondition=((CASE WHEN (x > 10) THEN a WHEN (y > 10) THEN (a + b) END = .((x + y) + -4)))
------------PhysicalCteConsumer ( cteId=CTEId#0 )
------------PhysicalCteConsumer ( cteId=CTEId#1 )
--------PhysicalProject[.a, .x]
----------hashJoin[INNER_JOIN] hashCondition=((.(a + b) = .((x + y) + -4))) otherCondition=((CASE WHEN (x > 10) THEN a WHEN (y > 10) THEN (a + b) END = .((x + y) + -4)) and OR[( not (a = ((x + y) + -4))),(a = ((x + y) + -4)) IS NULL])
------------PhysicalCteConsumer ( cteId=CTEId#0 )
------------PhysicalCteConsumer ( cteId=CTEId#1 )

-- !case_when_two_side_3 --
PhysicalResultSink
--PhysicalProject[t1.a, t2.x]
----NestedLoopJoin[INNER_JOIN]((CASE WHEN (x > 10) THEN a WHEN (y > 10) THEN (a + b) ELSE b END + random(1, 10)) = ((x + y) + 1))
------PhysicalProject[(a + b) AS `(a + b)`, t1.a, t1.b]
--------PhysicalOlapScan[tbl_join_extract_or_from_case_when_1(t1)]
------PhysicalProject[((x + y) + 1) AS `((x + y) + 1)`, (x > 10) AS `(x > 10)`, (y > 10) AS `(y > 10)`, t2.x]
--------PhysicalOlapScan[tbl_join_extract_or_from_case_when_2(t2)]

-- !case_when_two_side_4 --
PhysicalResultSink
--PhysicalProject[t1.a, t2.x]
----NestedLoopJoin[INNER_JOIN](CASE WHEN (x > 10) THEN a WHEN (y > 10) THEN (a + b) ELSE (x + b) END = ((x + y) + 1))
------PhysicalProject[(a + b) AS `(a + b)`, t1.a, t1.b]
--------PhysicalOlapScan[tbl_join_extract_or_from_case_when_1(t1)]
------PhysicalProject[((x + y) + 1) AS `((x + y) + 1)`, (x > 10) AS `(x > 10)`, (y > 10) AS `(y > 10)`, t2.x]
--------PhysicalOlapScan[tbl_join_extract_or_from_case_when_2(t2)]

-- !case_when_two_side_5 --
PhysicalCteAnchor ( cteId=CTEId#0 )
--PhysicalCteProducer ( cteId=CTEId#0 )
----PhysicalProject[(a + b) AS `(a + b)`, t1.a, t1.b]
------PhysicalOlapScan[tbl_join_extract_or_from_case_when_1(t1)]
--PhysicalCteAnchor ( cteId=CTEId#1 )
----PhysicalCteProducer ( cteId=CTEId#1 )
------PhysicalProject[((x + y) + -4) AS `((x + y) + -4)`, (x - y) AS `(x - y)`, (x > 10) AS `(x > 10)`, (y > 10) AS `(y > 10)`, t2.x]
--------PhysicalOlapScan[tbl_join_extract_or_from_case_when_2(t2)]
----PhysicalResultSink
------PhysicalUnion
--------PhysicalProject[.a, .x]
----------hashJoin[INNER_JOIN] hashCondition=((.a = .(x - y))) otherCondition=((CASE WHEN (x > 10) THEN a WHEN (y > 10) THEN (a + b) ELSE b END = .((x + y) + -4)) and (if((a > x), a, b) = .(x - y)))
------------PhysicalCteConsumer ( cteId=CTEId#0 )
------------PhysicalCteConsumer ( cteId=CTEId#1 )
--------PhysicalProject[.a, .x]
----------hashJoin[INNER_JOIN] hashCondition=((.b = .(x - y))) otherCondition=((CASE WHEN (x > 10) THEN a WHEN (y > 10) THEN (a + b) ELSE b END = .((x + y) + -4)) and (if((a > x), a, b) = .(x - y)) and OR[( not (a = (x - y))),(a = (x - y)) IS NULL])
------------PhysicalCteConsumer ( cteId=CTEId#0 )
------------PhysicalCteConsumer ( cteId=CTEId#1 )

-- !case_when_two_side_6 --
PhysicalCteAnchor ( cteId=CTEId#0 )
--PhysicalCteProducer ( cteId=CTEId#0 )
----PhysicalProject[a IS NULL AS `a IS NULL`, coalesce(a, b) AS `coalesce(a, b)`, t1.a]
------PhysicalOlapScan[tbl_join_extract_or_from_case_when_1(t1)]
--PhysicalCteAnchor ( cteId=CTEId#1 )
----PhysicalCteProducer ( cteId=CTEId#1 )
------PhysicalOlapScan[tbl_join_extract_or_from_case_when_2(t2)]
----PhysicalResultSink
------PhysicalUnion
--------PhysicalProject[.a, .x]
----------hashJoin[INNER_JOIN] hashCondition=((.x = .coalesce(a, b))) otherCondition=((if(a IS NULL, x, y) = .coalesce(a, b)))
------------PhysicalCteConsumer ( cteId=CTEId#0 )
------------PhysicalCteConsumer ( cteId=CTEId#1 )
--------PhysicalProject[.a, .x]
----------hashJoin[INNER_JOIN] hashCondition=((.y = .coalesce(a, b))) otherCondition=((if(a IS NULL, x, y) = .coalesce(a, b)) and OR[( not (x = coalesce(a, b))),(x = coalesce(a, b)) IS NULL])
------------PhysicalCteConsumer ( cteId=CTEId#0 )
------------PhysicalCteConsumer ( cteId=CTEId#1 )

-- !case_when_two_side_7 --
PhysicalResultSink
--PhysicalProject[t1.a, t2.x]
----NestedLoopJoin[INNER_JOIN](CASE WHEN (x > 10) THEN a WHEN (y > 10) THEN (a + b) ELSE 100 END = ((x + y) + -4))
------PhysicalProject[(a + b) AS `(a + b)`, t1.a]
--------PhysicalOlapScan[tbl_join_extract_or_from_case_when_1(t1)]
------PhysicalProject[((x + y) + -4) AS `((x + y) + -4)`, (x > 10) AS `(x > 10)`, (y > 10) AS `(y > 10)`, t2.x]
--------PhysicalOlapScan[tbl_join_extract_or_from_case_when_2(t2)]

-- !if_one_side_1 --
PhysicalResultSink
--PhysicalProject[t1.a, t2.x]
----NestedLoopJoin[INNER_JOIN](if((a > x), a, b) = (a + b))
------PhysicalProject[(a + b) AS `(a + b)`, t1.a, t1.b]
--------filter(OR[(t1.a = (t1.a + t1.b)),(t1.b = (t1.a + t1.b))])
----------PhysicalOlapScan[tbl_join_extract_or_from_case_when_1(t1)]
------PhysicalProject[t2.x]
--------PhysicalOlapScan[tbl_join_extract_or_from_case_when_2(t2)]

-- !if_two_side_1 --
PhysicalCteAnchor ( cteId=CTEId#0 )
--PhysicalCteProducer ( cteId=CTEId#0 )
----PhysicalOlapScan[tbl_join_extract_or_from_case_when_1(t1)]
--PhysicalCteAnchor ( cteId=CTEId#1 )
----PhysicalCteProducer ( cteId=CTEId#1 )
------PhysicalProject[(x + y) AS `(x + y)`, t2.x]
--------PhysicalOlapScan[tbl_join_extract_or_from_case_when_2(t2)]
----PhysicalResultSink
------PhysicalUnion
--------PhysicalProject[.a, .x]
----------hashJoin[INNER_JOIN] hashCondition=((.a = .(x + y))) otherCondition=((if((a > x), a, b) = .(x + y)))
------------PhysicalCteConsumer ( cteId=CTEId#0 )
------------PhysicalCteConsumer ( cteId=CTEId#1 )
--------PhysicalProject[.a, .x]
----------hashJoin[INNER_JOIN] hashCondition=((.b = .(x + y))) otherCondition=((if((a > x), a, b) = .(x + y)) and OR[( not (a = (x + y))),(a = (x + y)) IS NULL])
------------PhysicalCteConsumer ( cteId=CTEId#0 )
------------PhysicalCteConsumer ( cteId=CTEId#1 )

-- !ifnull_one_side_1 --
PhysicalResultSink
--PhysicalProject[t1.a, t2.x]
----NestedLoopJoin[INNER_JOIN](ifnull(a, x) = (a + b))
------PhysicalProject[(a + b) AS `(a + b)`, t1.a]
--------PhysicalOlapScan[tbl_join_extract_or_from_case_when_1(t1)]
------PhysicalProject[t2.x]
--------PhysicalOlapScan[tbl_join_extract_or_from_case_when_2(t2)]

-- !ifnull_two_side_1 --
PhysicalResultSink
--PhysicalProject[t1.a, t2.x]
----NestedLoopJoin[INNER_JOIN](ifnull(a, x) = (x + y))
------PhysicalProject[t1.a]
--------PhysicalOlapScan[tbl_join_extract_or_from_case_when_1(t1)]
------PhysicalProject[(x + y) AS `(x + y)`, t2.x]
--------PhysicalOlapScan[tbl_join_extract_or_from_case_when_2(t2)]

-- !nullif_one_side_1 --
PhysicalResultSink
--PhysicalProject[t1.a, t2.x]
----NestedLoopJoin[INNER_JOIN](nullif(a, x) = (a + b))
------PhysicalProject[(a + b) AS `(a + b)`, t1.a]
--------filter((t1.a = (t1.a + t1.b)))
----------PhysicalOlapScan[tbl_join_extract_or_from_case_when_1(t1)]
------PhysicalProject[t2.x]
--------PhysicalOlapScan[tbl_join_extract_or_from_case_when_2(t2)]

-- !nullif_two_side_1 --
PhysicalResultSink
--PhysicalProject[t1.a, t2.x]
----hashJoin[INNER_JOIN] hashCondition=((t1.a = expr_(x + y))) otherCondition=((nullif(a, x) = (t2.x + t2.y)))
------PhysicalProject[t1.a]
--------PhysicalOlapScan[tbl_join_extract_or_from_case_when_1(t1)]
------PhysicalProject[(x + y) AS `expr_(x + y)`, tbl_join_extract_or_from_case_when_2.x, tbl_join_extract_or_from_case_when_2.y]
--------PhysicalOlapScan[tbl_join_extract_or_from_case_when_2(t2)]

