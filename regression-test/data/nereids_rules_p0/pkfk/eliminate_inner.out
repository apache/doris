-- This file is automatically generated. You should know what you did if you want to edit this
-- !name --
simple_case

-- !shape --
PhysicalResultSink
--hashJoin[INNER_JOIN] hashCondition=((pkt.pk = fkt_not_null.fk)) otherCondition=()
----PhysicalOlapScan[pkt]
----PhysicalOlapScan[fkt_not_null]

-- !res --

-- !name --
with_pk_col

-- !shape --
PhysicalResultSink
--hashJoin[INNER_JOIN] hashCondition=((pkt.pk = fkt_not_null.fk)) otherCondition=()
----PhysicalOlapScan[pkt]
----PhysicalOlapScan[fkt_not_null]

-- !res --

-- !name --
with_pk_col

-- !shape --
PhysicalResultSink
--hashJoin[INNER_JOIN] hashCondition=((pkt.pk = fkt_not_null.fk)) otherCondition=()
----PhysicalOlapScan[pkt]
----hashJoin[INNER_JOIN] hashCondition=((fkt_not_null1.fk = fkt_not_null2.fk)) otherCondition=()
------PhysicalOlapScan[fkt_not_null]
------PhysicalOlapScan[fkt_not_null]

-- !res --

-- !name --
with_pk_col

-- !shape --
PhysicalResultSink
--hashJoin[INNER_JOIN] hashCondition=((pkt.pk = fkt_not_null.fk)) otherCondition=() build RFs:RF1 fk->[pk]
----filter((pkt.pk > 1))
------PhysicalOlapScan[pkt] apply RFs: RF1
----hashJoin[INNER_JOIN] hashCondition=((fkt_not_null1.fk = fkt_not_null2.fk)) otherCondition=() build RFs:RF0 fk->[fk]
------filter((fkt_not_null1.fk > 1))
--------PhysicalOlapScan[fkt_not_null] apply RFs: RF0
------filter((fkt_not_null2.fk > 1))
--------PhysicalOlapScan[fkt_not_null]

-- !res --

-- !name --
with_pk_col

-- !shape --
PhysicalResultSink
--hashJoin[INNER_JOIN] hashCondition=((pkt.pk = fkt_not_null.fk)) otherCondition=()
----PhysicalOlapScan[pkt]
----hashAgg[LOCAL]
------PhysicalOlapScan[fkt_not_null]

-- !res --

-- !name --
with_pk_col

-- !shape --
PhysicalResultSink
--hashJoin[INNER_JOIN] hashCondition=((pkt.pk = fkt_not_null.fk)) otherCondition=()
----PhysicalOlapScan[pkt]
----hashAgg[GLOBAL]
------hashAgg[LOCAL]
--------PhysicalUnion
----------PhysicalOlapScan[fkt_not_null]
----------PhysicalOlapScan[fkt_not_null]

-- !res --

-- !name --
fk with window

-- !shape --
PhysicalResultSink
--hashJoin[INNER_JOIN] hashCondition=((pkt.pk = fkt_not_null.fk)) otherCondition=()
----PhysicalOlapScan[pkt]
----PhysicalWindow
------PhysicalQuickSort[LOCAL_SORT]
--------PhysicalOlapScan[fkt_not_null]

-- !res --

-- !name --
fk with limit

-- !shape --
PhysicalResultSink
--hashJoin[INNER_JOIN] hashCondition=((pkt.pk = fkt_not_null.fk)) otherCondition=() build RFs:RF0 fk->[pk]
----PhysicalOlapScan[pkt] apply RFs: RF0
----PhysicalLimit[GLOBAL]
------PhysicalLimit[LOCAL]
--------PhysicalOlapScan[fkt_not_null]

-- !res --

-- !name --
pk with filter that same as fk

-- !shape --
PhysicalResultSink
--hashJoin[INNER_JOIN] hashCondition=((pkt.pk = fkt_not_null.fk)) otherCondition=() build RFs:RF0 fk->[pk]
----filter((pkt.pk = 1))
------PhysicalOlapScan[pkt] apply RFs: RF0
----filter((fkt_not_null.fk = 1))
------PhysicalOlapScan[fkt_not_null]

-- !res --

-- !name --
pk with filter that included same as fk

-- !shape --
PhysicalResultSink
--hashJoin[INNER_JOIN] hashCondition=((pkt.pk = fkt_not_null.fk)) otherCondition=() build RFs:RF0 fk->[pk]
----filter((pkt.pk = 1))
------PhysicalOlapScan[pkt] apply RFs: RF0
----filter((cast(f as DOUBLE) = 1) and (fkt_not_null.fk = 1))
------PhysicalOlapScan[fkt_not_null]

-- !res --

-- !name --
pk with filter that not same as fk

-- !shape --
PhysicalResultSink
--hashJoin[INNER_JOIN] hashCondition=((pkt.pk = fkt_not_null.fk)) otherCondition=() build RFs:RF0 fk->[pk]
----filter((cast(p as DOUBLE) = 1) and (pkt.pk = 1))
------PhysicalOlapScan[pkt] apply RFs: RF0
----filter((cast(f as DOUBLE) = 1) and (fkt_not_null.fk = 1))
------PhysicalOlapScan[fkt_not_null]

-- !res --

-- !name --
simple_case

-- !shape --
PhysicalResultSink
--filter(( not fk IS NULL))
----PhysicalOlapScan[fkt]

-- !res --
1	John
1	John
2	Alice
2	Alice
3	Bob

-- !name --
with_pk_col

-- !shape --
PhysicalResultSink
--filter(( not fk IS NULL))
----PhysicalOlapScan[fkt]

-- !res --
1	John	1
1	John	1
2	Alice	2
2	Alice	2
3	Bob	3

-- !name --
with_pk_col

-- !shape --
PhysicalResultSink
--hashJoin[INNER_JOIN] hashCondition=((pk = fkt2.fk)) otherCondition=()
----filter(( not fk IS NULL))
------PhysicalOlapScan[fkt]
----PhysicalOlapScan[fkt]

-- !res --
1	John	1
1	John	1
1	John	1
1	John	1
2	Alice	2
2	Alice	2
2	Alice	2
2	Alice	2
3	Bob	3

-- !name --
with_pk_col

-- !shape --
PhysicalResultSink
--hashJoin[INNER_JOIN] hashCondition=((pk = fkt2.fk)) otherCondition=() build RFs:RF0 fk->[fk]
----filter(( not fk IS NULL) and (fkt1.fk > 1))
------PhysicalOlapScan[fkt] apply RFs: RF0
----filter((fkt2.fk > 1))
------PhysicalOlapScan[fkt]

-- !res --
2	Alice	2
2	Alice	2
2	Alice	2
2	Alice	2
3	Bob	3

-- !name --
with_pk_col

-- !shape --
PhysicalResultSink
--hashAgg[LOCAL]
----filter(( not fk IS NULL))
------PhysicalOlapScan[fkt]

-- !res --
1	1
2	2
3	3

-- !name --
with_pk_col

-- !shape --
PhysicalResultSink
--hashJoin[INNER_JOIN] hashCondition=((pkt.pk = fkt.fk)) otherCondition=()
----PhysicalOlapScan[pkt]
----hashAgg[GLOBAL]
------hashAgg[LOCAL]
--------PhysicalUnion
----------PhysicalOlapScan[fkt]
----------PhysicalOlapScan[fkt]

-- !res --
1	John	1
2	Alice	2
3	Bob	3

-- !name --
fk with window

-- !shape --
PhysicalResultSink
--PhysicalWindow
----PhysicalQuickSort[LOCAL_SORT]
------filter(( not fk IS NULL))
--------PhysicalOlapScan[fkt]

-- !res --
1	1	1
1	2	1
2	1	2
2	2	2
3	1	3

-- !name --
fk with limit

-- !shape --
PhysicalResultSink
--filter(( not fk IS NULL))
----PhysicalLimit[GLOBAL]
------PhysicalLimit[LOCAL]
--------PhysicalOlapScan[fkt]

-- !res --

-- !name --
pk with filter that same as fk

-- !shape --
PhysicalResultSink
--filter(( not fk IS NULL) and (fkt.fk = 1))
----PhysicalOlapScan[fkt]

-- !res --
1	John	1
1	John	1

-- !name --
pk with filter that included same as fk

-- !shape --
PhysicalResultSink
--filter(( not fk IS NULL) and (cast(f as DOUBLE) = 1) and (fkt.fk = 1))
----PhysicalOlapScan[fkt]

-- !res --

-- !name --
pk with filter that not same as fk

-- !shape --
PhysicalResultSink
--hashJoin[INNER_JOIN] hashCondition=((pkt.pk = fkt.fk)) otherCondition=() build RFs:RF0 fk->[pk]
----filter((cast(p as DOUBLE) = 1) and (pkt.pk = 1))
------PhysicalOlapScan[pkt] apply RFs: RF0
----filter((cast(f as DOUBLE) = 1) and (fkt.fk = 1))
------PhysicalOlapScan[fkt]

-- !res --

