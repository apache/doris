-- This file is automatically generated. You should know what you did if you want to edit this
-- !name --
simple_case

-- !shape --
PhysicalResultSink
--PhysicalDistribute[DistributionSpecGather]
----hashJoin[INNER_JOIN] hashCondition=((pkt.pk = fkt_not_null.fk)) otherCondition=()
------PhysicalOlapScan[pkt]
------PhysicalDistribute[DistributionSpecHash]
--------PhysicalOlapScan[fkt_not_null]

-- !res --

-- !name --
with_pk_col

-- !shape --
PhysicalResultSink
--PhysicalDistribute[DistributionSpecGather]
----hashJoin[INNER_JOIN] hashCondition=((pkt.pk = fkt_not_null.fk)) otherCondition=()
------PhysicalOlapScan[pkt]
------PhysicalDistribute[DistributionSpecHash]
--------PhysicalOlapScan[fkt_not_null]

-- !res --

-- !name --
with_pk_col

-- !shape --
PhysicalResultSink
--PhysicalDistribute[DistributionSpecGather]
----hashJoin[INNER_JOIN] hashCondition=((pkt.pk = fkt_not_null.fk)) otherCondition=()
------PhysicalOlapScan[pkt]
------PhysicalDistribute[DistributionSpecHash]
--------hashJoin[INNER_JOIN] hashCondition=((fkt_not_null1.fk = fkt_not_null2.fk)) otherCondition=()
----------PhysicalOlapScan[fkt_not_null]
----------PhysicalOlapScan[fkt_not_null]

-- !res --

-- !name --
with_pk_col

-- !shape --
PhysicalResultSink
--PhysicalDistribute[DistributionSpecGather]
----hashJoin[INNER_JOIN] hashCondition=((pkt.pk = fkt_not_null.fk)) otherCondition=()
------filter((pkt.pk > 1))
--------PhysicalOlapScan[pkt]
------PhysicalDistribute[DistributionSpecHash]
--------hashJoin[INNER_JOIN] hashCondition=((fkt_not_null1.fk = fkt_not_null2.fk)) otherCondition=()
----------filter((fkt_not_null1.fk > 1))
------------PhysicalOlapScan[fkt_not_null]
----------filter((fkt_not_null2.fk > 1))
------------PhysicalOlapScan[fkt_not_null]

-- !res --

-- !name --
with_pk_col

-- !shape --
PhysicalResultSink
--PhysicalDistribute[DistributionSpecGather]
----hashJoin[INNER_JOIN] hashCondition=((pkt.pk = fkt_not_null.fk)) otherCondition=()
------PhysicalOlapScan[pkt]
------PhysicalDistribute[DistributionSpecHash]
--------hashAgg[LOCAL]
----------PhysicalOlapScan[fkt_not_null]

-- !res --

-- !name --
with_pk_col

-- !shape --
PhysicalResultSink
--PhysicalDistribute[DistributionSpecGather]
----hashJoin[INNER_JOIN] hashCondition=((pkt.pk = fkt_not_null.fk)) otherCondition=()
------PhysicalOlapScan[pkt]
------PhysicalDistribute[DistributionSpecHash]
--------hashAgg[GLOBAL]
----------PhysicalDistribute[DistributionSpecHash]
------------hashAgg[LOCAL]
--------------PhysicalUnion
----------------PhysicalDistribute[DistributionSpecExecutionAny]
------------------PhysicalOlapScan[fkt_not_null]
----------------PhysicalDistribute[DistributionSpecExecutionAny]
------------------PhysicalOlapScan[fkt_not_null]

-- !res --

-- !name --
fk with window

-- !shape --
PhysicalResultSink
--PhysicalDistribute[DistributionSpecGather]
----hashJoin[INNER_JOIN] hashCondition=((pkt.pk = fkt_not_null.fk)) otherCondition=()
------PhysicalOlapScan[pkt]
------PhysicalDistribute[DistributionSpecHash]
--------PhysicalWindow
----------PhysicalQuickSort[LOCAL_SORT]
------------PhysicalOlapScan[fkt_not_null]

-- !res --

-- !name --
fk with limit

-- !shape --
PhysicalResultSink
--PhysicalDistribute[DistributionSpecGather]
----hashJoin[INNER_JOIN] hashCondition=((pkt.pk = fkt_not_null.fk)) otherCondition=()
------PhysicalOlapScan[pkt]
------PhysicalDistribute[DistributionSpecHash]
--------PhysicalLimit[GLOBAL]
----------PhysicalDistribute[DistributionSpecGather]
------------PhysicalLimit[LOCAL]
--------------PhysicalOlapScan[fkt_not_null]

-- !res --

-- !name --
pk with filter that same as fk

-- !shape --
PhysicalResultSink
--PhysicalDistribute[DistributionSpecGather]
----hashJoin[INNER_JOIN] hashCondition=((pkt.pk = fkt_not_null.fk)) otherCondition=()
------filter((pkt.pk = 1))
--------PhysicalOlapScan[pkt]
------PhysicalDistribute[DistributionSpecHash]
--------filter((fkt_not_null.fk = 1))
----------PhysicalOlapScan[fkt_not_null]

-- !res --

-- !name --
pk with filter that included same as fk

-- !shape --
PhysicalResultSink
--PhysicalDistribute[DistributionSpecGather]
----hashJoin[INNER_JOIN] hashCondition=((pkt.pk = fkt_not_null.fk)) otherCondition=()
------filter((pkt.pk = 1))
--------PhysicalOlapScan[pkt]
------PhysicalDistribute[DistributionSpecHash]
--------filter((cast(f as DOUBLE) = 1.0) and (fkt_not_null.fk = 1))
----------PhysicalOlapScan[fkt_not_null]

-- !res --

-- !name --
pk with filter that not same as fk

-- !shape --
PhysicalResultSink
--PhysicalDistribute[DistributionSpecGather]
----hashJoin[INNER_JOIN] hashCondition=((pkt.pk = fkt_not_null.fk)) otherCondition=()
------filter((cast(p as DOUBLE) = 1.0) and (pkt.pk = 1))
--------PhysicalOlapScan[pkt]
------PhysicalDistribute[DistributionSpecHash]
--------filter((cast(f as DOUBLE) = 1.0) and (fkt_not_null.fk = 1))
----------PhysicalOlapScan[fkt_not_null]

-- !res --

-- !name --
simple_case

-- !shape --
PhysicalResultSink
--PhysicalDistribute[DistributionSpecGather]
----filter(( not fk IS NULL))
------PhysicalOlapScan[fkt]

-- !res --
1	John
1	John
2	Alice
2	Alice
3	Bob

-- !name --
with_pk_col

-- !shape --
PhysicalResultSink
--PhysicalDistribute[DistributionSpecGather]
----filter(( not fk IS NULL))
------PhysicalOlapScan[fkt]

-- !res --
1	John	1
1	John	1
2	Alice	2
2	Alice	2
3	Bob	3

-- !name --
with_pk_col

-- !shape --
PhysicalResultSink
--PhysicalDistribute[DistributionSpecGather]
----hashJoin[INNER_JOIN] hashCondition=((pk = fkt2.fk)) otherCondition=()
------filter(( not fk IS NULL))
--------PhysicalOlapScan[fkt]
------PhysicalOlapScan[fkt]

-- !res --
1	John	1
1	John	1
1	John	1
1	John	1
2	Alice	2
2	Alice	2
2	Alice	2
2	Alice	2
3	Bob	3

-- !name --
with_pk_col

-- !shape --
PhysicalResultSink
--PhysicalDistribute[DistributionSpecGather]
----hashJoin[INNER_JOIN] hashCondition=((pk = fkt2.fk)) otherCondition=()
------filter(( not fk IS NULL) and (fkt1.fk > 1))
--------PhysicalOlapScan[fkt]
------filter((fkt2.fk > 1))
--------PhysicalOlapScan[fkt]

-- !res --
2	Alice	2
2	Alice	2
2	Alice	2
2	Alice	2
3	Bob	3

-- !name --
with_pk_col

-- !shape --
PhysicalResultSink
--PhysicalDistribute[DistributionSpecGather]
----hashAgg[LOCAL]
------filter(( not fk IS NULL))
--------PhysicalOlapScan[fkt]

-- !res --
1	1
2	2
3	3

-- !name --
with_pk_col

-- !shape --
PhysicalResultSink
--PhysicalDistribute[DistributionSpecGather]
----hashJoin[INNER_JOIN] hashCondition=((pkt.pk = fkt.fk)) otherCondition=()
------PhysicalOlapScan[pkt]
------PhysicalDistribute[DistributionSpecHash]
--------hashAgg[GLOBAL]
----------PhysicalDistribute[DistributionSpecHash]
------------hashAgg[LOCAL]
--------------PhysicalUnion
----------------PhysicalDistribute[DistributionSpecExecutionAny]
------------------PhysicalOlapScan[fkt]
----------------PhysicalDistribute[DistributionSpecExecutionAny]
------------------PhysicalOlapScan[fkt]

-- !res --
1	John	1
2	Alice	2
3	Bob	3

-- !name --
fk with window

-- !shape --
PhysicalResultSink
--PhysicalDistribute[DistributionSpecGather]
----PhysicalWindow
------PhysicalQuickSort[LOCAL_SORT]
--------filter(( not fk IS NULL))
----------PhysicalOlapScan[fkt]

-- !res --
1	1	1
1	2	1
2	1	2
2	2	2
3	1	3

-- !name --
fk with limit

-- !shape --
PhysicalResultSink
--filter(( not fk IS NULL))
----PhysicalLimit[GLOBAL]
------PhysicalDistribute[DistributionSpecGather]
--------PhysicalLimit[LOCAL]
----------PhysicalOlapScan[fkt]

-- !res --
1	1

-- !name --
pk with filter that same as fk

-- !shape --
PhysicalResultSink
--PhysicalDistribute[DistributionSpecGather]
----filter(( not fk IS NULL) and (fkt.fk = 1))
------PhysicalOlapScan[fkt]

-- !res --
1	John	1
1	John	1

-- !name --
pk with filter that included same as fk

-- !shape --
PhysicalResultSink
--PhysicalDistribute[DistributionSpecGather]
----filter(( not fk IS NULL) and (cast(f as DOUBLE) = 1.0) and (fkt.fk = 1))
------PhysicalOlapScan[fkt]

-- !res --

-- !name --
pk with filter that not same as fk

-- !shape --
PhysicalResultSink
--PhysicalDistribute[DistributionSpecGather]
----hashJoin[INNER_JOIN] hashCondition=((pkt.pk = fkt.fk)) otherCondition=()
------filter((cast(p as DOUBLE) = 1.0) and (pkt.pk = 1))
--------PhysicalOlapScan[pkt]
------PhysicalDistribute[DistributionSpecHash]
--------filter((cast(f as DOUBLE) = 1.0) and (fkt.fk = 1))
----------PhysicalOlapScan[fkt]

-- !res --

