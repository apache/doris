-- This file is automatically generated. You should know what you did if you want to edit this
-- !push_down_topn_through_union --
PhysicalResultSink
--PhysicalTopN[MERGE_SORT]
----PhysicalTopN[LOCAL_SORT]
------PhysicalUnion
--------PhysicalTopN[MERGE_SORT]
----------PhysicalTopN[LOCAL_SORT]
------------PhysicalOlapScan[table1]
--------PhysicalTopN[MERGE_SORT]
----------PhysicalTopN[LOCAL_SORT]
------------PhysicalOlapScan[table1]

-- !push_down_topn_union_with_conditions --
PhysicalResultSink
--PhysicalTopN[MERGE_SORT]
----PhysicalTopN[LOCAL_SORT]
------PhysicalUnion
--------PhysicalTopN[MERGE_SORT]
----------PhysicalTopN[LOCAL_SORT]
------------filter((t1.score > 10))
--------------PhysicalOlapScan[table1]
--------PhysicalTopN[MERGE_SORT]
----------PhysicalTopN[LOCAL_SORT]
------------filter((t2.name = 'Test'))
--------------PhysicalOlapScan[table1]
--------PhysicalTopN[MERGE_SORT]
----------PhysicalTopN[LOCAL_SORT]
------------filter((t3.id < 5))
--------------PhysicalOlapScan[table1]

-- !push_down_topn_union_with_order_by --
PhysicalResultSink
--PhysicalTopN[MERGE_SORT]
----PhysicalTopN[LOCAL_SORT]
------PhysicalUnion
--------PhysicalTopN[MERGE_SORT]
----------PhysicalTopN[LOCAL_SORT]
------------PhysicalOlapScan[table1]
--------PhysicalTopN[MERGE_SORT]
----------PhysicalTopN[LOCAL_SORT]
------------PhysicalOlapScan[table1]
--------PhysicalTopN[MERGE_SORT]
----------PhysicalTopN[LOCAL_SORT]
------------PhysicalOlapScan[table1]

-- !push_down_topn_nested_union --
PhysicalResultSink
--PhysicalTopN[MERGE_SORT]
----PhysicalTopN[LOCAL_SORT]
------PhysicalUnion
--------PhysicalTopN[MERGE_SORT]
----------PhysicalTopN[LOCAL_SORT]
------------PhysicalOlapScan[table1]
--------PhysicalTopN[MERGE_SORT]
----------PhysicalTopN[LOCAL_SORT]
------------PhysicalOlapScan[table1]
--------PhysicalTopN[MERGE_SORT]
----------PhysicalTopN[LOCAL_SORT]
------------PhysicalOlapScan[table1]
--------PhysicalTopN[MERGE_SORT]
----------PhysicalTopN[LOCAL_SORT]
------------PhysicalOlapScan[table1]

-- !push_down_topn_union_after_join --
PhysicalResultSink
--PhysicalTopN[MERGE_SORT]
----PhysicalTopN[LOCAL_SORT]
------PhysicalUnion
--------PhysicalTopN[MERGE_SORT]
----------PhysicalTopN[LOCAL_SORT]
------------hashJoin[INNER_JOIN] hashCondition=((t1.id = t2.id)) otherCondition=()
--------------PhysicalOlapScan[table1]
--------------PhysicalOlapScan[table1]
--------PhysicalTopN[MERGE_SORT]
----------PhysicalTopN[LOCAL_SORT]
------------PhysicalOlapScan[table1]

-- !push_down_topn_union_different_projections --
PhysicalResultSink
--PhysicalTopN[MERGE_SORT]
----PhysicalTopN[LOCAL_SORT]
------PhysicalUnion
--------PhysicalTopN[MERGE_SORT]
----------PhysicalTopN[LOCAL_SORT]
------------PhysicalOlapScan[table1]
--------PhysicalTopN[MERGE_SORT]
----------PhysicalTopN[LOCAL_SORT]
------------PhysicalOlapScan[table1]

-- !push_down_topn_union_with_subquery --
PhysicalResultSink
--PhysicalTopN[MERGE_SORT]
----PhysicalTopN[LOCAL_SORT]
------PhysicalUnion
--------PhysicalTopN[MERGE_SORT]
----------PhysicalTopN[LOCAL_SORT]
------------filter((table1.score > 20))
--------------PhysicalOlapScan[table1]
--------PhysicalTopN[MERGE_SORT]
----------PhysicalTopN[LOCAL_SORT]
------------PhysicalOlapScan[table1]

-- !push_down_topn_union_with_limit --
PhysicalResultSink
--PhysicalTopN[MERGE_SORT]
----PhysicalTopN[LOCAL_SORT]
------PhysicalUnion
--------PhysicalTopN[GATHER_SORT]
----------PhysicalLimit[GLOBAL]
------------PhysicalLimit[LOCAL]
--------------PhysicalOlapScan[table1]
--------PhysicalTopN[GATHER_SORT]
----------PhysicalLimit[GLOBAL]
------------PhysicalLimit[LOCAL]
--------------PhysicalOlapScan[table1]

-- !push_down_topn_union_complex_conditions --
PhysicalResultSink
--PhysicalTopN[MERGE_SORT]
----PhysicalTopN[LOCAL_SORT]
------PhysicalUnion
--------PhysicalTopN[MERGE_SORT]
----------PhysicalTopN[LOCAL_SORT]
------------filter((t1.name = 'Test') and (t1.score > 10))
--------------PhysicalOlapScan[table1]
--------PhysicalTopN[MERGE_SORT]
----------PhysicalTopN[LOCAL_SORT]
------------filter((t2.id < 5) and (t2.score < 20))
--------------PhysicalOlapScan[table1]

-- !union_all_push_down_top_n --
error_code=500&message=Database+connection+failed	{"component":"database","severity":"critical"}	500	Database connection error	192.168.1.103	/api/v1/products	192.168.1.103	api.example.com	{"app":"api-gateway","dependencies":["mysql", "redis"],"env":"production"}	{"city":"Tokyo","coordinates":{"lat":35.6762,"lon":139.6503},"country":"JP"}	{"Content-Type":"application/json","X-Correlation-ID":"corr_456mno"}	{"region":"ap-northeast-1","server":"api-node-05"}	https://app.example.com/products	Mozilla/5.0 (Linux; Android 13; SM-S901B) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Mobile Safari/537.36	{"source":"mobile","tags":["error", "database"]}	{"context":{"attempts":3,"database":"products_db","duration_ms":5000,"error":"Connection timeout"},"level":"ERROR","message":"Failed to connect to database","timestamp":"2025-07-31T16:45:33Z"}	2025-07-31T16:45:33
error_code=500&message=Internal+Server+Error	{"severity":"high","type":"error"}	500	Internal server error occurred	192.168.1.104	/api/v1/users	192.168.1.104	api.example.com	{"app":"web","env":"production"}	{"city":"Berlin","country":"Germany"}	{"Content-Type":"application/json","X-Request-ID":"req123"}	{"hostname":"web-server-02"}	https://client.example.com	Mozilla/5.0 (Windows NT 10.0; Win64; x64)	{"input_type":"error","tags":["error", "prod"]}	{"level":"error","message":"server error","timestamp":"2025-07-31T18:15:55Z"}	2025-07-31T18:15:55
order_id=789&amount=99.99	{"method":"credit_card","type":"payment"}	201	Payment processed	192.168.1.102	/api/v1/payments	192.168.1.102	pay.example.com	{"app":"payment","env":"production"}	{"city":"London","country":"UK"}	{"Content-Type":"application/json","X-CSRF-Token":"xyz789"}	{"hostname":"payment-gateway-01"}	https://checkout.example.com	Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7)	{"input_type":"api","tags":["payment", "prod"]}	{"level":"info","message":"payment success","timestamp":"2025-07-31T14:45:20Z"}	2025-07-31T14:45:20
product_id=456&category=electronics	{"device":"mobile","type":"product_view"}	304	Product page viewed	192.168.1.101	/products/456	192.168.1.101	shop.example.com	{"app":"ecommerce","env":"staging"}	{"city":"New York","country":"USA"}	{"Cache-Control":"max-age=3600","Content-Type":"text/html"}	{"hostname":"shop-server-02"}	https://search.example.com	Mozilla/5.0 (iPhone; CPU iPhone OS 15_0 like Mac OS X)	{"input_type":"http","tags":["shop", "mobile"]}	{"level":"info","message":"product view","timestamp":"2025-07-31T11:30:45Z"}	2025-07-31T11:30:45
product_id=789&quantity=2&price=59.99	{"event":"purchase","payment_method":"credit_card"}	201	Order processed successfully	192.168.1.101	/api/v1/orders	192.168.1.101	shop.example.com	{"app":"ecommerce","env":"production","version":"3.2.1"}	{"city":"New York","coordinates":{"lat":40.7128,"lon":-74.006},"country":"US"}	{"Accept":"application/json","Content-Type":"application/json","X-CSRF-Token":"csrf_abc123"}	{"region":"us-east-1","server":"shop-node-03"}	https://shop.example.com/product/789	Mozilla/5.0 (iPhone; CPU iPhone OS 16_5 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.5 Mobile/15E148 Safari/604.1	{"source":"mobile","tags":["transaction", "order"]}	{"context":{"amount":119.98,"currency":"USD","customer_id":"cust_123abc","order_id":"ord_789xyz"},"level":"INFO","message":"New order created","timestamp":"2025-07-31T11:30:45Z"}	2025-07-31T11:30:45
query=smartphone&page=1&sort=price_asc	{"filters":["in_stock", "free_shipping"],"search_type":"product"}	200	Search results returned	192.168.1.104	/api/v1/search	192.168.1.104	search.example.com	{"app":"search","env":"production","features":["autocomplete", "faceted_search"]}	{"city":"Berlin","coordinates":{"lat":52.52,"lon":13.405},"country":"DE"}	{"Content-Type":"application/json","X-Forwarded-For":"192.168.1.104, 203.0.113.5"}	{"region":"eu-central-1","server":"search-node-01"}	https://www.example.com/search	Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/125.0	{"source":"web","tags":["search", "query"]}	{"context":{"filters_applied":2,"query":"smartphone","response_time_ms":125,"results_count":42},"level":"INFO","message":"Search query processed","timestamp":"2025-07-31T19:05:07Z"}	2025-07-31T19:05:07
search_term=laptop&page=2	{"results_count":25,"type":"search"}	200	Search results returned	192.168.1.103	/search	192.168.1.103	search.example.com	{"app":"search","env":"production"}	{"city":"Tokyo","country":"Japan"}	{"Accept-Language":"en-US","Content-Type":"application/json"}	{"hostname":"search-server-03"}	https://www.example.com	Mozilla/5.0 (Linux; Android 11; SM-G991B)	{"input_type":"search","tags":["search", "prod"]}	{"level":"info","message":"search query","timestamp":"2025-07-31T16:30:10Z"}	2025-07-31T16:30:10
transaction_id=txn_987654&amount=199.99	{"currency":"USD","gateway":"stripe","type":"payment"}	202	Payment processing started	192.168.1.102	/api/v1/payments	192.168.1.102	pay.example.com	{"app":"payment","env":"production","features":["3d_secure", "refunds"]}	{"city":"London","coordinates":{"lat":51.5074,"lon":-0.1278},"country":"GB"}	{"Content-Type":"application/json","Idempotency-Key":"idemp_123","X-Request-ID":"req_987xyz"}	{"region":"eu-west-2","server":"payment-gw-02"}	https://checkout.example.com/payment	Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36	{"source":"web","tags":["finance", "payment"]}	{"context":{"amount":199.99,"currency":"USD","customer":"cust_456def","transaction_id":"txn_987654"},"level":"INFO","message":"Payment initiated","timestamp":"2025-07-31T14:20:18Z"}	2025-07-31T14:20:18

-- !union_all_push_down_top_n_shape --
------------PhysicalOlapScan[t1]
------------PhysicalOlapScan[t2]
----------PhysicalTopN[LOCAL_SORT]
----------PhysicalTopN[LOCAL_SORT]
--------PhysicalTopN[MERGE_SORT]
--------PhysicalTopN[MERGE_SORT]
------PhysicalUnion
----PhysicalTopN[LOCAL_SORT]
--PhysicalTopN[MERGE_SORT]
PhysicalResultSink

