-- This file is automatically generated. You should know what you did if you want to edit this
-- !sql --
PhysicalResultSink
--PhysicalDistribute[DistributionSpecGather]
----PhysicalProject
------NestedLoopJoin[CROSS_JOIN]
--------PhysicalProject
----------PhysicalOlapScan[t1]
--------PhysicalDistribute[DistributionSpecReplicated]
----------PhysicalOlapScan[t1]

-- !sql --
PhysicalCteAnchor ( cteId=CTEId#0 )
--PhysicalCteProducer ( cteId=CTEId#0 )
----PhysicalProject
------PhysicalOlapScan[t1]
--PhysicalResultSink
----PhysicalDistribute[DistributionSpecGather]
------PhysicalProject
--------NestedLoopJoin[CROSS_JOIN]
----------PhysicalDistribute[DistributionSpecExecutionAny]
------------PhysicalCteConsumer ( cteId=CTEId#0 )
----------PhysicalDistribute[DistributionSpecReplicated]
------------PhysicalCteConsumer ( cteId=CTEId#0 )

-- !sql --
PhysicalCteAnchor ( cteId=CTEId#0 )
--PhysicalCteProducer ( cteId=CTEId#0 )
----PhysicalProject
------PhysicalOlapScan[t1]
--PhysicalResultSink
----PhysicalDistribute[DistributionSpecGather]
------PhysicalProject
--------NestedLoopJoin[INNER_JOIN](cast(sum(col2) as DOUBLE) > (cast(0.05 as DOUBLE) * avg(col2)))
----------hashAgg[GLOBAL]
------------PhysicalDistribute[DistributionSpecHash]
--------------hashAgg[LOCAL]
----------------PhysicalDistribute[DistributionSpecExecutionAny]
------------------PhysicalCteConsumer ( cteId=CTEId#0 )
----------PhysicalDistribute[DistributionSpecReplicated]
------------PhysicalProject
--------------hashAgg[GLOBAL]
----------------PhysicalDistribute[DistributionSpecGather]
------------------hashAgg[LOCAL]
--------------------PhysicalDistribute[DistributionSpecExecutionAny]
----------------------PhysicalProject
------------------------PhysicalCteConsumer ( cteId=CTEId#0 )

-- !sql --
PhysicalCteAnchor ( cteId=CTEId#0 )
--PhysicalCteProducer ( cteId=CTEId#0 )
----PhysicalProject
------PhysicalOlapScan[t1]
--PhysicalResultSink
----PhysicalDistribute[DistributionSpecGather]
------PhysicalProject
--------NestedLoopJoin[CROSS_JOIN]
----------PhysicalDistribute[DistributionSpecExecutionAny]
------------filter((t1.col2 = 3))
--------------PhysicalCteConsumer ( cteId=CTEId#0 )
----------PhysicalDistribute[DistributionSpecReplicated]
------------filter((cast(col1 as DOUBLE) = 2.0))
--------------PhysicalCteConsumer ( cteId=CTEId#0 )

-- !sql --
PhysicalCteAnchor ( cteId=CTEId#0 )
--PhysicalCteProducer ( cteId=CTEId#0 )
----PhysicalProject
------filter(col2 IN (3, 4))
--------PhysicalOlapScan[t1]
--PhysicalResultSink
----PhysicalDistribute[DistributionSpecGather]
------PhysicalProject
--------NestedLoopJoin[CROSS_JOIN]
----------PhysicalDistribute[DistributionSpecExecutionAny]
------------filter((cte1.col2 = 3))
--------------PhysicalCteConsumer ( cteId=CTEId#0 )
----------PhysicalDistribute[DistributionSpecReplicated]
------------filter((cte1.col2 = 4))
--------------PhysicalCteConsumer ( cteId=CTEId#0 )

-- !sql --
PhysicalCteAnchor ( cteId=CTEId#0 )
--PhysicalCteProducer ( cteId=CTEId#0 )
----PhysicalProject
------PhysicalOlapScan[t1]
--PhysicalResultSink
----PhysicalDistribute[DistributionSpecGather]
------PhysicalProject
--------NestedLoopJoin[INNER_JOIN](cast(sum(col2) as DOUBLE) > (cast(0.05 as DOUBLE) * avg(col2)))
----------hashAgg[GLOBAL]
------------PhysicalDistribute[DistributionSpecHash]
--------------hashAgg[LOCAL]
----------------PhysicalDistribute[DistributionSpecExecutionAny]
------------------PhysicalCteConsumer ( cteId=CTEId#0 )
----------PhysicalDistribute[DistributionSpecReplicated]
------------PhysicalProject
--------------hashAgg[GLOBAL]
----------------PhysicalDistribute[DistributionSpecGather]
------------------hashAgg[LOCAL]
--------------------PhysicalDistribute[DistributionSpecExecutionAny]
----------------------PhysicalProject
------------------------filter((cte.col2 > 1))
--------------------------PhysicalCteConsumer ( cteId=CTEId#0 )

-- !sql --
PhysicalCteAnchor ( cteId=CTEId#0 )
--PhysicalCteProducer ( cteId=CTEId#0 )
----PhysicalProject
------PhysicalOlapScan[t1]
--PhysicalResultSink
----PhysicalDistribute[DistributionSpecGather]
------PhysicalProject
--------NestedLoopJoin[INNER_JOIN](cast(sum(col2) as DOUBLE) > (cast(0.05 as DOUBLE) * avg(col4)))
----------hashAgg[GLOBAL]
------------PhysicalDistribute[DistributionSpecHash]
--------------hashAgg[LOCAL]
----------------PhysicalDistribute[DistributionSpecExecutionAny]
------------------PhysicalProject
--------------------PhysicalCteConsumer ( cteId=CTEId#0 )
----------PhysicalDistribute[DistributionSpecReplicated]
------------PhysicalProject
--------------hashAgg[GLOBAL]
----------------PhysicalDistribute[DistributionSpecGather]
------------------hashAgg[LOCAL]
--------------------PhysicalDistribute[DistributionSpecExecutionAny]
----------------------PhysicalProject
------------------------filter((cte.col2 > 1))
--------------------------PhysicalCteConsumer ( cteId=CTEId#0 )

-- !sql --
PhysicalCteAnchor ( cteId=CTEId#0 )
--PhysicalCteProducer ( cteId=CTEId#0 )
----PhysicalProject
------PhysicalOlapScan[t1]
--PhysicalResultSink
----PhysicalDistribute[DistributionSpecGather]
------PhysicalProject
--------NestedLoopJoin[CROSS_JOIN]
----------PhysicalDistribute[DistributionSpecExecutionAny]
------------PhysicalProject
--------------PhysicalCteConsumer ( cteId=CTEId#0 )
----------PhysicalDistribute[DistributionSpecReplicated]
------------PhysicalProject
--------------PhysicalCteConsumer ( cteId=CTEId#0 )

-- !sql --
LogicalCteAnchor[457] ( cteId=CTEId#0 )
|--LogicalCteProducer[441] ( cteId=CTEId#0 )
|  +--LogicalOlapScan ( qualified=regression_test_nereids_rules_p0_cte.t1, indexName=t1, selectedIndexId=47224, preAgg=ON )
+--LogicalResultSink[455] ( outputExprs=[col1#24, col2#25, col3#26] )
   +--LogicalAggregate[453] ( groupByExpr=[col1#24, col2#25, col3#26], outputExpr=[col1#24, col2#25, col3#26], hasRepeat=false )
      +--LogicalUnion ( qualifier=ALL, outputs=[col1#24, col2#25, col3#26], regularChildrenOutputs=[[col1#42, col2#43, col3#44], [col1#45, col2#46, col3#47]], constantExprsList=[], hasPushedFilter=false )
         |--LogicalProject[444] ( distinct=false, projects=[cast(col1#27 as VARCHAR(65533)) AS `col1`#42, cast(col2#28 as BIGINT) AS `col2`#43, col3#29 AS `col3`#44], excepts=[] )
         |  +--LogicalCteConsumer[442] ( cteId=CTEId#0, relationId=RelationId#5, name=cte1 )
         +--LogicalProject[447] ( distinct=false, projects=[cast((col2#34 + 1) as VARCHAR(65533)) AS `col1`#45, (col3#35 + 2) AS `col2`#46, col4#36 AS `col3`#47], excepts=[] )
            +--LogicalCteConsumer[445] ( cteId=CTEId#0, relationId=RelationId#6, name=cte1 )

-- !sql --
PhysicalCteAnchor ( cteId=CTEId#0 )
--PhysicalCteProducer ( cteId=CTEId#0 )
----PhysicalOlapScan[t1]
--PhysicalResultSink
----PhysicalDistribute[DistributionSpecGather]
------PhysicalProject
--------hashJoin[INNER_JOIN] hashCondition=((t1.col2 = t2.col2)) otherCondition=()
----------PhysicalDistribute[DistributionSpecExecutionAny]
------------PhysicalProject
--------------PhysicalCteConsumer ( cteId=CTEId#0 )
----------PhysicalDistribute[DistributionSpecReplicated]
------------filter((v.col3 = 2))
--------------PhysicalCteConsumer ( cteId=CTEId#0 )

-- !sql --
PhysicalCteAnchor ( cteId=CTEId#0 )
--PhysicalCteProducer ( cteId=CTEId#0 )
----PhysicalOlapScan[t1]
--PhysicalResultSink
----PhysicalDistribute[DistributionSpecGather]
------hashAgg[GLOBAL]
--------PhysicalDistribute[DistributionSpecHash]
----------hashAgg[LOCAL]
------------PhysicalUnion
--------------PhysicalDistribute[DistributionSpecExecutionAny]
----------------PhysicalProject
------------------PhysicalCteConsumer ( cteId=CTEId#0 )
--------------PhysicalDistribute[DistributionSpecExecutionAny]
----------------PhysicalProject
------------------PhysicalCteConsumer ( cteId=CTEId#0 )

-- !sql --
PhysicalCteAnchor ( cteId=CTEId#0 )
--PhysicalCteProducer ( cteId=CTEId#0 )
----PhysicalOlapScan[t1]
--PhysicalResultSink
----PhysicalDistribute[DistributionSpecGather]
------hashAgg[GLOBAL]
--------PhysicalDistribute[DistributionSpecHash]
----------hashAgg[LOCAL]
------------PhysicalUnion
--------------PhysicalDistribute[DistributionSpecExecutionAny]
----------------PhysicalProject
------------------PhysicalCteConsumer ( cteId=CTEId#0 )
--------------PhysicalDistribute[DistributionSpecExecutionAny]
----------------PhysicalProject
------------------PhysicalCteConsumer ( cteId=CTEId#0 )

-- !sql --
PhysicalResultSink
--PhysicalDistribute[DistributionSpecGather]
----PhysicalOlapScan[t1]

-- !sql --
PhysicalResultSink
--PhysicalDistribute[DistributionSpecGather]
----PhysicalUnion
------PhysicalDistribute[DistributionSpecExecutionAny]
--------PhysicalProject
----------PhysicalOlapScan[t1]
------PhysicalDistribute[DistributionSpecExecutionAny]
--------PhysicalProject
----------PhysicalOlapScan[t1]

-- !sql --
PhysicalCteAnchor ( cteId=CTEId#0 )
--PhysicalCteProducer ( cteId=CTEId#0 )
----PhysicalUnion
------PhysicalDistribute[DistributionSpecExecutionAny]
--------PhysicalProject
----------PhysicalOlapScan[t1]
------PhysicalDistribute[DistributionSpecExecutionAny]
--------PhysicalProject
----------PhysicalOlapScan[t1]
--PhysicalResultSink
----PhysicalDistribute[DistributionSpecGather]
------PhysicalProject
--------PhysicalCteConsumer ( cteId=CTEId#0 )

-- !sql --
PhysicalCteAnchor ( cteId=CTEId#3 )
--PhysicalCteProducer ( cteId=CTEId#3 )
----PhysicalUnion
------PhysicalDistribute[DistributionSpecExecutionAny]
--------PhysicalProject
----------PhysicalOlapScan[t1]
------PhysicalDistribute[DistributionSpecExecutionAny]
--------PhysicalProject
----------PhysicalOlapScan[t1]
--PhysicalResultSink
----PhysicalDistribute[DistributionSpecGather]
------hashAgg[GLOBAL]
--------PhysicalDistribute[DistributionSpecHash]
----------hashAgg[LOCAL]
------------PhysicalUnion
--------------PhysicalDistribute[DistributionSpecExecutionAny]
----------------PhysicalProject
------------------PhysicalCteConsumer ( cteId=CTEId#3 )
--------------PhysicalDistribute[DistributionSpecExecutionAny]
----------------PhysicalProject
------------------PhysicalCteConsumer ( cteId=CTEId#3 )

-- !sql --
PhysicalCteAnchor ( cteId=CTEId#0 )
--PhysicalCteProducer ( cteId=CTEId#0 )
----PhysicalOlapScan[t1]
--PhysicalResultSink
----PhysicalDistribute[DistributionSpecGather]
------PhysicalUnion
--------PhysicalDistribute[DistributionSpecExecutionAny]
----------PhysicalProject
------------filter((cte0.col3 < 5))
--------------PhysicalCteConsumer ( cteId=CTEId#0 )
--------PhysicalDistribute[DistributionSpecExecutionAny]
----------PhysicalProject
------------filter((cte0.col2 > 1))
--------------PhysicalCteConsumer ( cteId=CTEId#0 )

-- !sql --
PhysicalCteAnchor ( cteId=CTEId#0 )
--PhysicalCteProducer ( cteId=CTEId#0 )
----PhysicalProject
------PhysicalOlapScan[t1]
--PhysicalResultSink
----PhysicalDistribute[DistributionSpecGather]
------PhysicalUnion
--------PhysicalDistribute[DistributionSpecExecutionAny]
----------PhysicalProject
------------PhysicalCteConsumer ( cteId=CTEId#0 )
--------PhysicalDistribute[DistributionSpecExecutionAny]
----------PhysicalProject
------------PhysicalCteConsumer ( cteId=CTEId#0 )

-- !sql --
PhysicalCteAnchor ( cteId=CTEId#0 )
--PhysicalCteProducer ( cteId=CTEId#0 )
----PhysicalProject
------PhysicalOlapScan[t1]
--PhysicalResultSink
----PhysicalDistribute[DistributionSpecGather]
------PhysicalProject
--------hashJoin[INNER_JOIN] hashCondition=((c1.col3 = c2.col3)) otherCondition=()
----------PhysicalDistribute[DistributionSpecExecutionAny]
------------PhysicalProject
--------------PhysicalCteConsumer ( cteId=CTEId#0 )
----------PhysicalDistribute[DistributionSpecReplicated]
------------PhysicalProject
--------------PhysicalCteConsumer ( cteId=CTEId#0 )

-- !sql --
PhysicalCteAnchor ( cteId=CTEId#0 )
--PhysicalCteProducer ( cteId=CTEId#0 )
----PhysicalProject
------PhysicalOlapScan[t1]
--PhysicalCteAnchor ( cteId=CTEId#1 )
----PhysicalCteProducer ( cteId=CTEId#1 )
------PhysicalDistribute[DistributionSpecExecutionAny]
--------PhysicalProject
----------PhysicalCteConsumer ( cteId=CTEId#0 )
----PhysicalCteAnchor ( cteId=CTEId#2 )
------PhysicalCteProducer ( cteId=CTEId#2 )
--------PhysicalLimit[GLOBAL]
----------PhysicalLimit[LOCAL]
------------PhysicalProject
--------------NestedLoopJoin[INNER_JOIN](cast(col1 as DOUBLE) > cast(sum(col2) as DOUBLE))
----------------hashAgg[GLOBAL]
------------------PhysicalDistribute[DistributionSpecGather]
--------------------hashAgg[LOCAL]
----------------------PhysicalProject
------------------------NestedLoopJoin[CROSS_JOIN]
--------------------------PhysicalDistribute[DistributionSpecExecutionAny]
----------------------------PhysicalProject
------------------------------PhysicalCteConsumer ( cteId=CTEId#1 )
--------------------------PhysicalDistribute[DistributionSpecReplicated]
----------------------------PhysicalProject
------------------------------PhysicalCteConsumer ( cteId=CTEId#1 )
----------------PhysicalDistribute[DistributionSpecReplicated]
------------------PhysicalCteConsumer ( cteId=CTEId#0 )
------PhysicalResultSink
--------PhysicalDistribute[DistributionSpecGather]
----------PhysicalProject
------------NestedLoopJoin[CROSS_JOIN]
--------------PhysicalDistribute[DistributionSpecExecutionAny]
----------------PhysicalCteConsumer ( cteId=CTEId#2 )
--------------PhysicalDistribute[DistributionSpecReplicated]
----------------PhysicalProject
------------------PhysicalCteConsumer ( cteId=CTEId#2 )

