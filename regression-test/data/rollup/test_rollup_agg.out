-- This file is automatically generated. You should know what you did if you want to edit this
-- !sql --
test_rollup_agg	AGG_KEYS	siteid	INT	No	true	\N		true
		citycode	SMALLINT	No	true	\N		true
		username	VARCHAR(32)	No	true	\N		true
		pv	BIGINT	No	false	0	SUM	true
		uv	BIGINT	No	false	0	SUM	true
								
rollup_city	AGG_KEYS	citycode	SMALLINT	No	true	\N		true
		pv	BIGINT	No	false	0	SUM	true

-- !sql --
PLAN FRAGMENT 0
 OUTPUT EXPRS:<slot 2> `citycode` | <slot 3> sum(`pv`)
  PARTITION: UNPARTITIONED

  RESULT SINK

  4:EXCHANGE

PLAN FRAGMENT 1
 OUTPUT EXPRS:
  PARTITION: HASH_PARTITIONED: <slot 2> `citycode`

  STREAM DATA SINK
    EXCHANGE ID: 04
    UNPARTITIONED

  3:AGGREGATE (merge finalize)
  |  output: sum(<slot 3> sum(`pv`))
  |  group by: <slot 2> `citycode`
  |  cardinality=-1
  |  
  2:EXCHANGE

PLAN FRAGMENT 2
 OUTPUT EXPRS:
  PARTITION: HASH_PARTITIONED: `default_cluster:regression_test`.`test_rollup_agg`.`siteid`

  STREAM DATA SINK
    EXCHANGE ID: 02
    HASH_PARTITIONED: <slot 2> `citycode`

  1:AGGREGATE (update serialize)
  |  STREAMING
  |  output: sum(`pv`)
  |  group by: `citycode`
  |  cardinality=-1
  |  
  0:OlapScanNode
     TABLE: test_rollup_agg
     PREAGGREGATION: ON
     partitions=1/1
     rollup: rollup_city
     tabletRatio=5/5
     tabletList=15690,15692,15694,15696,15698
     cardinality=0
     avgRowSize=10.0
     numNodes=1

