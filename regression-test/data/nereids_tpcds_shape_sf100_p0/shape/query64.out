-- This file is automatically generated. You should know what you did if you want to edit this
-- !ds_shape_64 --
CteAnchor[cteId= ( CTEId#14=] )
--CteProducer[cteId= ( CTEId#14=] )
----PhysicalProject
------hashAgg[GLOBAL]
--------PhysicalDistribute
----------hashAgg[LOCAL]
------------PhysicalProject
--------------hashJoin[INNER_JOIN](customer.c_first_shipto_date_sk = d3.d_date_sk)
----------------PhysicalProject
------------------PhysicalOlapScan[date_dim]
----------------PhysicalDistribute
------------------PhysicalProject
--------------------hashJoin[INNER_JOIN](customer.c_current_addr_sk = ad2.ca_address_sk)
----------------------PhysicalProject
------------------------PhysicalOlapScan[customer_address]
----------------------PhysicalDistribute
------------------------PhysicalProject
--------------------------hashJoin[INNER_JOIN](store_sales.ss_item_sk = cs_ui.cs_item_sk)
----------------------------PhysicalProject
------------------------------filter((sale > (2 * refund)))
--------------------------------hashAgg[GLOBAL]
----------------------------------PhysicalDistribute
------------------------------------hashAgg[LOCAL]
--------------------------------------PhysicalProject
----------------------------------------hashJoin[INNER_JOIN](catalog_sales.cs_item_sk = catalog_returns.cr_item_sk)(catalog_sales.cs_order_number = catalog_returns.cr_order_number)
------------------------------------------PhysicalProject
--------------------------------------------PhysicalOlapScan[catalog_sales]
------------------------------------------PhysicalProject
--------------------------------------------PhysicalOlapScan[catalog_returns]
----------------------------PhysicalDistribute
------------------------------PhysicalProject
--------------------------------hashJoin[INNER_JOIN](hd2.hd_income_band_sk = ib2.ib_income_band_sk)
----------------------------------PhysicalProject
------------------------------------PhysicalOlapScan[income_band]
----------------------------------PhysicalDistribute
------------------------------------PhysicalProject
--------------------------------------hashJoin[INNER_JOIN](customer.c_first_sales_date_sk = d2.d_date_sk)
----------------------------------------PhysicalProject
------------------------------------------PhysicalOlapScan[date_dim]
----------------------------------------PhysicalDistribute
------------------------------------------PhysicalProject
--------------------------------------------hashJoin[INNER_JOIN](customer.c_current_hdemo_sk = hd2.hd_demo_sk)
----------------------------------------------PhysicalProject
------------------------------------------------PhysicalOlapScan[household_demographics]
----------------------------------------------PhysicalDistribute
------------------------------------------------PhysicalProject
--------------------------------------------------hashJoin[INNER_JOIN](store_sales.ss_promo_sk = promotion.p_promo_sk)
----------------------------------------------------PhysicalProject
------------------------------------------------------PhysicalOlapScan[promotion]
----------------------------------------------------PhysicalDistribute
------------------------------------------------------PhysicalProject
--------------------------------------------------------hashJoin[INNER_JOIN](hd1.hd_income_band_sk = ib1.ib_income_band_sk)
----------------------------------------------------------PhysicalProject
------------------------------------------------------------PhysicalOlapScan[income_band]
----------------------------------------------------------PhysicalDistribute
------------------------------------------------------------PhysicalProject
--------------------------------------------------------------hashJoin[INNER_JOIN](store_sales.ss_item_sk = store_returns.sr_item_sk)(store_sales.ss_ticket_number = store_returns.sr_ticket_number)
----------------------------------------------------------------PhysicalProject
------------------------------------------------------------------PhysicalOlapScan[store_returns]
----------------------------------------------------------------PhysicalDistribute
------------------------------------------------------------------PhysicalProject
--------------------------------------------------------------------hashJoin[INNER_JOIN](customer.c_current_cdemo_sk = cd2.cd_demo_sk)( not (cd_marital_status = cd_marital_status))
----------------------------------------------------------------------PhysicalDistribute
------------------------------------------------------------------------PhysicalProject
--------------------------------------------------------------------------PhysicalOlapScan[customer_demographics]
----------------------------------------------------------------------PhysicalDistribute
------------------------------------------------------------------------PhysicalProject
--------------------------------------------------------------------------hashJoin[INNER_JOIN](store_sales.ss_cdemo_sk = cd1.cd_demo_sk)
----------------------------------------------------------------------------PhysicalDistribute
------------------------------------------------------------------------------PhysicalProject
--------------------------------------------------------------------------------PhysicalOlapScan[customer_demographics]
----------------------------------------------------------------------------PhysicalDistribute
------------------------------------------------------------------------------PhysicalProject
--------------------------------------------------------------------------------hashJoin[INNER_JOIN](store_sales.ss_sold_date_sk = d1.d_date_sk)
----------------------------------------------------------------------------------PhysicalProject
------------------------------------------------------------------------------------hashJoin[INNER_JOIN](store_sales.ss_hdemo_sk = hd1.hd_demo_sk)
--------------------------------------------------------------------------------------PhysicalProject
----------------------------------------------------------------------------------------hashJoin[INNER_JOIN](store_sales.ss_customer_sk = customer.c_customer_sk)
------------------------------------------------------------------------------------------PhysicalDistribute
--------------------------------------------------------------------------------------------PhysicalProject
----------------------------------------------------------------------------------------------PhysicalOlapScan[customer]
------------------------------------------------------------------------------------------PhysicalDistribute
--------------------------------------------------------------------------------------------PhysicalProject
----------------------------------------------------------------------------------------------hashJoin[INNER_JOIN](store_sales.ss_store_sk = store.s_store_sk)
------------------------------------------------------------------------------------------------PhysicalProject
--------------------------------------------------------------------------------------------------hashJoin[INNER_JOIN](store_sales.ss_addr_sk = ad1.ca_address_sk)
----------------------------------------------------------------------------------------------------PhysicalDistribute
------------------------------------------------------------------------------------------------------hashJoin[INNER_JOIN](store_sales.ss_item_sk = item_sk)
--------------------------------------------------------------------------------------------------------PhysicalProject
----------------------------------------------------------------------------------------------------------PhysicalOlapScan[store_sales]
--------------------------------------------------------------------------------------------------------PhysicalDistribute
----------------------------------------------------------------------------------------------------------PhysicalProject
------------------------------------------------------------------------------------------------------------filter((item.i_current_price >= 24.00)(item.i_current_price <= 33.00)i_color IN ('blanched', 'medium', 'brown', 'chocolate', 'burlywood', 'drab'))
--------------------------------------------------------------------------------------------------------------PhysicalOlapScan[item]
----------------------------------------------------------------------------------------------------PhysicalDistribute
------------------------------------------------------------------------------------------------------PhysicalProject
--------------------------------------------------------------------------------------------------------PhysicalOlapScan[customer_address]
------------------------------------------------------------------------------------------------PhysicalDistribute
--------------------------------------------------------------------------------------------------PhysicalProject
----------------------------------------------------------------------------------------------------PhysicalOlapScan[store]
--------------------------------------------------------------------------------------PhysicalDistribute
----------------------------------------------------------------------------------------PhysicalProject
------------------------------------------------------------------------------------------PhysicalOlapScan[household_demographics]
----------------------------------------------------------------------------------PhysicalDistribute
------------------------------------------------------------------------------------PhysicalProject
--------------------------------------------------------------------------------------filter(((d1.d_year = 2001) OR (d1.d_year = 2002)))
----------------------------------------------------------------------------------------PhysicalOlapScan[date_dim]
--PhysicalQuickSort
----PhysicalDistribute
------PhysicalQuickSort
--------PhysicalProject
----------hashJoin[INNER_JOIN](cs1.item_sk = cs2.item_sk)(cs1.store_name = cs2.store_name)(cs1.store_zip = cs2.store_zip)(cs2.cnt <= cs1.cnt)
------------PhysicalDistribute
--------------PhysicalProject
----------------filter((cs2.syear = 2002))
------------------CteConsumer[cteId= ( CTEId#14=] )
------------PhysicalDistribute
--------------PhysicalProject
----------------filter((cs1.syear = 2001))
------------------CteConsumer[cteId= ( CTEId#14=] )

