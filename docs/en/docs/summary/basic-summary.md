---
{
    "title": "Apache Doris Introduction",
    "language": "en"
}
---

<!-- 
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License.
-->

# Apache Doris Introduction

Apache Doris is a modern MPP analytical database product. Query results can be obtained with sub-second response time, effectively supporting real-time data analysis. The distributed architecture of Apache Doris is very simple, easy to operate and maintain, and can support large data sets of more than 10PB.

Apache Doris can meet a variety of data analysis needs, such as fixed historical reports, real-time data analysis, interactive data analysis, and exploratory data analysis. Make your data analysis work easier and more efficient!

Apache Doris has a very simple architecture, adopts a full vectorization engine, and provides a new CBO query optimizer to provide users with the ultimate data query performance experience.

Apache Doris supports real-time data analysis well and enables efficient querying of real-time updated data. At the same time, Doris also supports materialized views to provide further acceleration for user query analysis.

Apache Doris is compatible with the MySQL protocol, supports standard SQL syntax, is easy to connect and use, has no external dependencies in the whole system, is highly available, and is easy to operate and manage.

## 1. Architecture

The architecture of Doris is very simple. It only has two roles and two processes, FE (Frontend) and BE (Backend). It does not depend on external components, which is convenient for deployment and operation and maintenance.

- From the perspective of data storage, FE stores and maintains cluster metadata; BE stores physical data.
- From the perspective of query processing, FE nodes receive and parse query requests, plan query plans, schedule query execution, and return query results; BE nodes execute queries in a distributed manner according to the physical plan generated by FE.

Both FE and BE are linearly scalable.

FE mainly has three roles, one is leader, one is follower, and one is observer. Leader and follower are mainly used to achieve high availability of metadata, ensuring that in the case of a single node downtime, metadata can be restored online in real time without affecting the entire service.

Observer is only used to expand query nodes, that is, if you need to expand the ability of the entire query when the cluster pressure is found to be very high, you can add observer nodes. The observer does not participate in any writes, only reads.

The reliability of the data is guaranteed by BE, which stores multiple copies or three copies of the entire data. The number of copies can be dynamically adjusted according to demand.

## 2. Metadata management

Apache Doris uses the Paxos protocol and the mechanism of Memory + Checkpoint + Journal to ensure high performance and reliability of metadata. Each update of metadata is first written to the log file on the disk, then written to the memory, and finally periodically checkpointed to the local disk. We are equivalent to a pure memory structure, which means that all metadata will be cached in memory, so as to ensure that FE can quickly restore metadata after downtime without losing metadata. Leader, follower, and observer constitute a reliable service, so that if a node goes down, inside Baidu, we generally deploy one leader and two followers, and external companies are basically deploying them in this way. That is to say, three nodes to achieve a high availability service. In our experience, basically three nodes are enough when a single node fails, because after all, the FE node only stores one metadata, and its pressure is not large, so if there are too many FEs, it will To consume machine resources, so in most cases three is enough to achieve a highly available metadata service

Doris FE high availability solution:

1. If you are an offline business and the high availability requirements are not so high, you can use 1 FE (Follower leader) + 1 FE (Observer)
2. If you are a real-time online business and have high requirements for high availability, it is recommended to use 3 FE (Follower), which will automatically elect a leader

## 3. Data distribution and reliability

Apache Doris data is mainly stored in BE. The reliability of physical data on BE nodes is achieved through multiple copies. The default is 3 copies. The number of copies is configurable and can be dynamically adjusted at any time to meet the business needs of different availability levels. FE schedules the distribution and completion of replicas on BE.

If the user does not have high requirements for availability and is more sensitive to resource consumption, we can choose to create two copies or one copy when building the table. For example, when we build tables for users on Baidu Cloud, some users are more sensitive to its entire resource consumption. Because he has to pay, he may build two copies. However, we generally do not recommend users to create a copy, because in the case of a copy, once the machine fails, the data will be lost directly, and it is difficult to restore it. If we are inside the company, we generally build three copies by default, which basically ensures that the normal operation of the entire service will not be affected if a single machine node is down.

## 4. Apache Doris Components

### 4.1 Frontend (FE)

Java language development, metadata management and node scheduling of Doris system. In the import process, it is mainly responsible for import plan generation and import task scheduling, requesting access, etc.

### 4.2 Backend (BE)

C++ language development, computing and storage nodes of the Doris system, executing SQL plans, etc. In the import process, it is mainly responsible for the ETL and storage of the data.

### 4.3 Broker

Broker is an independent stateless process. It encapsulates the file system interface and provides Doris with the ability to read files in remote storage systems, including HDFS, S3, BOS, etc.

### 4.4 Mysql Client

With the help of the MySQL protocol, users can directly access Doris using any MySQL ODBC/JDBC and MySQL clients.

### 4.5 Doris on ES

Doris-On-ES combines the distributed query planning capabilities of Doris with the full-text retrieval capabilities of ES (Elasticsearch) to provide a more complete solution for OLAP analysis scenarios:

1. Multi-index distributed join query in ES
2. Combined query of tables in Doris and ES, more complex full-text search filtering

### 4.6 External Table Of Doris

#### 4.6.1 ODBC External Table Of Doris

ODBC External Table Of Doris provides Doris to access external tables through the standard interface (ODBC) for database access. External tables save the tedious data import work, allowing Doris to have the ability to access various databases, and with the help of Doris's own OLAP capabilities to solve data analysis problems with external tables:

1. Support various data sources to access Doris
2. Support Doris and table joint query in various data sources for more complex analysis operations
3. Write the query results executed by Doris to an external data source through insert into

#### 4.6.2 Hive, Iceberg, Hudi External Table Of Doris

 Hive, Iceberg, Hudi External Table of Doris provides Doris with the ability to directly access Hive, Iceberg, Hudi external tables, the external table saves tedious data import work, and uses Doris's own OLAP capabilities to solve Iceberg table data analysis question:

1. Support Hive, Iceberg, Hudi data sources to access Doris
2. Support Doris and Hive, Iceberg, Hudi data source table joint query for more complex analysis operations

### 4.7 Spark Doris Connector

Spark Doris Connector can support reading data stored in Doris through Spark.

- The current version only supports reading data from Doris.
- Doris tables can be mapped to DataFrame or RDD, DataFrame is recommended.
- Support data filtering on the Doris side to reduce the amount of data transmission.

### 4.8 Flink Doris Connector

Flink Doris Connector can support reading data stored in Doris through Flink.

- Doris table can be mapped to DataStream or Table
- Support use of doris data through Flink table
- The data can be easily inserted into the doris table through the insert into select method through the Flink table method
- Provide Exactly-once semantic support to ensure data consistency at both ends.

### 4.9 DataX doriswriter

DataX doriswriter plugin for synchronizing data from other data sources to Doris through DataX.

This plugin uses Doris' Stream Load feature for data import. Need to be used with DataX service.

This extension makes it easy to quickly extract and import data from the business database into the doris data warehouse

### 4.10 Doris output plugin

This plugin is used for logstash to output data to Doris, use HTTP protocol to interact with Doris FE Http interface, and import data through Doris's stream load method.

### 4.11 Audit log extension

Doris's audit log plugin is developed on the basis of FE's plugin framework. is an optional plugin. Users can install or uninstall this plugin at runtime.

This plugin can periodically import the audit logs of FE into the specified Doris cluster, so that users can view and analyze the audit logs through SQL.

## 5. Applicable scenarios

### 5.1 Data warehouse query acceleration

Doris is used to solve the problem of low query efficiency in traditional data warehouses. PB level data is as low as millisecond/second query time, and massive data is seamlessly applied, greatly accelerating the efficiency of data decision-making.

### 5.2 Real-time data warehouse construction

Doris supports efficient import of streaming data and real-time aggregation of business indicators, ensuring real-time insight into business data, reducing data processing links, unifying data flow, and simplifying the architecture of the big data platform.

### 5.3 Multi-source federated query

Doris builds a unified query portal across multiple data sources, realizes federated analysis of real-time data and offline data, and meets the more diversified query needs of data analysts.

### 4.4 Interactive Data Analysis

Build interactive data analysis applications based on Doris and BI visualization tools, perform self-service exploration and multi-dimensional analysis on massive data, and realize in-depth business exploration and rapid decision-making